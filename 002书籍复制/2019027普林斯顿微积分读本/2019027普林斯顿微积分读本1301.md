# 
> 2018000模板



第 13 章　最优化和线性化


现在, 我将要介绍微积分的两个重要应用：最优化和线性化. 信不信由你,这些技术的应用很广泛,比如工程师们、经济学家们及医生们每天都在使用着它们. 基本上来说,最优化是寻找可能存在的最佳情况的问题,比如修建一座桥梁的最省钱的却不会倒塌的方式或到达某个目的地的最快行驶路径.另一方面, 线性化则是一个对估算很难计算的数值非常有用的技术.这种技术常被使用去估算使函数为零的点的数值, 这种方法叫牛顿法.总的来说, 我们要介绍以下知识点：

怎样解决最优化问题, 我们要给出三个例子解释这个问题;



使用线性化和微分估算某些数值;



我们的估算有多好;



估算使函数为零的点的数值的牛顿方法.





13.1　最优化问题


“最优化”指的是要使某事足够好. 这是数学问题,所以我们要同数字打交道. 假设我们目前有一些要处理的数据,这些数据可能是数字、长度、角度、面积、成本、某人的收入或某些其他的问题.如果是一些好的事情, 比如收入, 我们当然希望越多越好;但如果是一些坏的事情, 比如花费, 我们就希望使其越低越好. 简而言之,我们就是要让数据最大化或最小化. 所以, 在下文中,“最优化”仅仅指的是在某些情况下的适当的最大或最小.





13.1.1　一个简单的最优化例子


在以前的几个章节中,我们已经花了大量的时间学习如何求函数的最大值和最小值.在这个章节中, 我们讨论最优化问题, 很正常,我们关心的是全局最大值和最小值. 在11.1.3节中,我们给出了一个解决最值问题的很好的方法.所以我强烈建议你重新看看该节以便加强记忆.

　在任何情况下,只要使用我们的方法,我们都需要把一个变量用另一个变量的函数的形式来表示. 例如,假设两个实数的和为10, 并且这两个数都不大于8. 那么,这两个数的乘积最大可能是多大？最小可能是多小？

在开始使用我们的方法之前, 首先分析一下情况.如果其中的一个数足够大, 那么只能是8, 另一个数则为2,这时的乘积为16. 另一个极限的情况是, 两个数都为5, 那么乘积为25,这个数明显比16要大.我们能使乘积比25还大或比16还小吗？如果这两个数为和,那么情况又是怎样呢？试试看.

现在, 让我们认真地用正式的数学方法去解答这个问题.我们需要设置一些变量, 假设这两个数分别为x和y, 它们的乘积为P.现在我们知道P=xy. 我们想要最优化的数值是P,它是两个变量x和y的乘积. 但这并不是我们想要的,我们要把P表示为一个变量的函数, 无论哪个变量都可以.幸运的是我们还有另一个已知的信息：x+y=10.这说明我们可以通过y=10-x把y削掉. 这样, 我们有P=x(10-x),这时P就是对于一个变量x的函数了.

现在有个非常重要的问题：P函数的定义域是什么？你当然可能随便代入一个x值,得到一个对应的函数值, 但请注意, x的值不可能比8大.实际上它也不可能比2小, 如果那样y就比8大了.所以我们知道x必然位于区间[2, 8]中, 这就是这个函数的定义域.

这样我们可以把我们的问题总结为求函数P=x(10-x)在区间[2,8]的最大值. 情况并不是很糟糕. 我们可以写P = 10x - x2,求导得导数为. 当x=5时, 导数为零,这是唯一的临界点.在两个端点x=2和x=8我们也可能有极大值和极小值.所以可能出现极值点的位置是x=2, x=5和x=8. 当x=2或x=8时,P=16; 当x=5时P=25. 这样我们有结论：乘积的最大值的确为25,出现在两个数都为5的时候; 乘积的最小值的确为16,出现在一个为8另一个为2的时候. 注意：当我做总结的时候,我并没有提到P, x, y, 因为这些变量是我引入的.问题中并没有给出这些变量, 你并不需要去定义它们或给它们起名字.你需要做的仅仅是在不提及它们的情况下写出结果.

通过该函数的一次导函数的图表1并没有否定我们刚才的结论,更加肯定了x=5为该函数最大值的结论. 使用P'(x) = 10 - 2x,如图13-1所示.

1请参阅12.1.1节.

x

4

5

6



P'(x)

+

0

-





/

￣

\



图　13-1

是的,它是最大值. 你也可以通过二次导数再次证明x=5的确为最大值.这个方法我们在11.5.2节中介绍过. 因为P''(x) = - 2, 所以P''(5) =- 2. 因为这是负的,所以再次证明了x=5这点为局部最大值的结论(也可以说是全局最大值).但这些方法不适用于端点, 因为它们仅仅适用于临界点.





13.1.2　最优化问题：通常的方法


　下边是解决最优化问题的常用方法：

1. 定义你可能需要的所有变量.它们中的一个量可能就是你想要最大化或最小化的那个,确信你知道是哪一个. 现在让我们把它设为Q,尽管它当然可能为其他字母, 比如P, m或α.

2. 要分析极值的情况, 看你的变量最大和最小都可能为多少.(比如上一道例题中x只能在2和8之间.)

3. 根据已知条件写下关于变量的所有方程,其中应该有一个关于Q的方程.

4. 用这些方程去化简变量, 尽量用只有一个变量的方程去表示Q.

5. 对于得到的方程, 两边关于那个变量对Q求导, 寻找临界点.一定要记住, 临界点出现在导数为零或不存在的位置.

6. 求出Q在临界点及端点所对应的函数值, 从中选出最大值和最小值.但也要校验一下,可以用一次导数测试法也可以用二次导数测试法来验证临界点.

7. 对刚才的分析和计算总结一下,用语言文字来表示这些变量而不是用字母.实际上, 第四步有时可能会很难的,有时为了解决问题我们可能要用到隐函数从而能够避免它.我们将在13.1.5节中讲解怎样用隐函数.





13.1.3　一个最优化的例子


　现在,让我们看看如何应用这个方法. 假设有这样一个农场,它的一边是长长直直的篱笆. 这个农场主想要圈一块地去喂马.这个农场主有些古怪,想以这个现存的篱笆为一边(但不是斜边)再用一些篱笆去圈一个直角三角形的栅栏,如图13-2左图所示.

假设只有300长的篱笆可以使用,农场主想使这块面积在现有条件下达到最大.那么这块地的周长和面积分别为多少？

首先让我们设置一些变量, 设三角形的底为b, 高为h,斜边为H(所以都是以英尺为单位), 并且面积为A(以平方英尺为单位),像图13-2右图这样.



图　13-2

请注意, 篱笆的长度为h+H, 我们想要最大化A.这样我们完成了第一步. 接下来进入第二步,考虑一些我们可以用300英尺的篱笆做成的特殊形状, 如图13-3所示.



图　13-3

在第一个图中, h接近于0, 而b和H都接近于300,但此时的面积却很小. 在第二个图中, b接近于0,而h和H都接近于150, 这时的面积依然非常小. 所以, 当处于中间值时,情况应该会变得更好.目前我们至少应该可以知道b和H都是在0和300之间,而h是在0和150之间.

下面进入第三步,根据三角形的面积公式我们可知A=bh/2并且也知道h+H=300.但这两个方程式是不够的, 我们还需要另外一个方程,因为我要用一个方程来表示b, h和H. 实际上, 这很简单,根据直角三角形的特点, 可以使用勾股定理, 则我们有b2 + h2 = H2.

现在, 我们想要削去一些变量. 对刚才的等式两边开平方可得(因为我们知道H>0); 把h+H=300代入, 可得. 接下来, 让我们把b削去,两边减h然后再平方可得：b2 + h2 = (300 - h)2 =90 000 - 600h + h2. 这样我们得到用h来表达b的表达式为, 同样的原因,由于b为正的, 所以我们忽略开根号为负值的情况. 最后,根据方程A=bh/2, 我们有：



h的定义域为[0, 150]. 这样我们完成了第四步. 至于第五步,我们要用到乘法规则和链式求导法则去对刚才的表达式求导：



当100-h=0时, 该导数为零, 也就是h=100. 进入第六步,把h=100代入原方程求出函数值, 我们得到：



另一方面, 对于端点值, 当h=0时, 我们可以看出A=0; 类似地,当h=150时, 表达式900-6h也趋于0, 所以A又为0. 这样,我们得出结论：当h=100时, A有最大值.我们可以用符号表格来校验一下. 情况不是很坏, 计算量并不是很大,因为导数的分子是45(100-h), 而分母一直为正. 于是, 我们有图13-4.

h

99

100

101



dA/dh

+

0

-





/

￣

\



图　13-4

所以,正如表格所示, 就像我们预测的那样, h=100的确为局部最大值.

我们完成了这道例题的讲解. 等等, 还有一个小问题,我们还需要求出这个三角形的边长. 我们已经知道了h=100,我们最好还要求出b和H. 让我们重新看看最开始列出的方程,知道h+H=300, 我们立刻可以算出H=200. 并且通过把h=100,H=200代入b2 + h2 = H2, 可得. 最后,我们已经计算出了面积的最大值A为.下面我们开始总结, 该圈地的最大面积为平方英尺,此时底边为英尺, 高为100英尺, 斜边为200英尺.





13.1.4　另一个最优化的例子


　这里有一个很好的例子.假设你要生产封闭的、空的金属圆柱体罐子.你可以随意选择这些罐子的边长, 但它们的体积是固定的, 为16π立方英寸. 由于每平方英寸的金属成本为2美分,所以我们要尽量减少金属的使用. 怎样选择罐子的边长才能使成本最低,此时每个罐子的成本为多少？

接下来还有个问题, 如果我们把罐子的盖和底都焊接到它的上面,焊接成本是每英寸14美分, 那么这时的情况又会是怎样？

让我们从第一个问题开始, 下图是这个罐子的一个草图,如图13-5所示.



图　13-5

为了描述该圆柱体, 我们只需要知道它的高度和半径分别为多少,所以我们设置它的半径为r高度为h(单位为英寸).问题中也提到了体积, 所以我们设置体积为V(单位为立方英寸).成本主要是根据我们使用了多少金属, 也就是该圆柱体的表面积来计算的.我们设置表面积为A(单位为平方英寸), 成本为C(单位为美分).成本价C是我们要最小化的, 很显然,通过最小化表面积A就可以得到C的最小值.(但对于问题二这个结论就不是对的了！)

现在, 我们开始第二步的分析. 当半径r足够小的时候,情况会是怎样的？这时高度h一定会非常大才会满足我们体积为16π立方英寸的要求. 这样, 我们会得到一个像下图一样很高很细的圆柱体.另一方面, 如果r很大, 那么h将会很小,于是我们会得到一个又宽又扁的圆柱体, 见图13-6.



图　13-6

虽然这两个例子看起来很极端, 甚至有些古怪.但事实上r可以是任意正实数, 所以它没有端点值,但r和h都要在开区间(0, ∞ )内, 这是我们要注意的.在上边的两个情况中, 每个看上去都要用很多金属原料.所以在要求低成本的情况下,很有可能的这个圆柱体的比例需要是很适当的,不会是我们上述的极端情况.

接下来, 我们开始第三步的计算了, 首先我们必须要找到一些方程.我们知道V = 16π, 同时也知道圆柱体的体积V = π r2h,这样就有等式16π = π r2h. 化简这个算式得16= r2h或. 另外,这个圆柱体的表面积为A = 2π rh + 2π r2,第一项为曲面面积, 第二项为盖和底的面积(如果没有盖,第二项则为π r2, 没有倍数2.).最后再用成本两美分与总面积相乘, 于是我们有C = 2A = 4π rh +4π r2. 找到了方程后我们开始第四步的计算,由于这两个都有r, 而只有一个才有h,所以我们把h削掉, 得到,将其代入得：



很好！我们的确用一个变量r来表示C了.现在的问题是当r在区间(0, ∞)上时最小化C.下面我们求导：



此导函数对于在(0, ∞)内的所有r均成立. 当时, 导数为零. 这样我们有2r3= 16, r = 2为这个导函数的唯一的临界点.那么端点值的情况又是怎样呢？我们无法把r=0代入C的表达式,但我们可以求此时的极限：



极限为无穷大, 因为当r → 0+时,趋于无穷大.这也就是说当半径趋于0的时候, 我们的成本价将是越来越大的.这与我们想要的恰恰相反！所以这个端点值就不考虑了. 那么在区间(0,∞)内的另一个端点的情况又是怎样呢？我们再一次求当r → ∞时的极限.



这次是r2趋于无穷大. 则这两个端点值都可以不考虑了.所以我们的结论是在r=2点有局部最小值和全局最大值.我们既可以通过一次导函数的符号表格来校验这个结果,也可以通过二次导数测试法来判断.让我们使用二次导数的方法：



当r在区间(0, ∞)时, 该二次导数一直为正; 尤其当r=2时,它也为正, 所以在这个点一定有局部最小值点.

接下来, 我们需要做的是求当r=2时其他变量的值来得到我们想要的结果.实际上, 当r=2时, 可以得到h = 16 / r2 = 4, C = 4π rh +4π r2 = 48π. 这说明当成本价最低的时候半径为2英寸,高度为4英寸, 并且每个圆柱体的成本价为48π美分,大约是1.50美元. (对这样一个破罐子来说有点贵了！)请注意,在这种情况下, 罐子的直径和高度都是相同的.

下面我们来解答第二个问题. 除了要考虑每英寸14美分的焊接成本之外,其他的情况都不变, 但对于成本的表达式C就发生了变化.焊接每个罐子要花多少钱呢？我们需要做的是焊接盖和底,也就是说是底面(或顶面)周长的2倍. 也就是说,对于每个罐子都有2个2π r英寸, 也就是4π r英寸.于是成本价就又多了一部分：每个罐子14 × 4π r美分.这个新的表达式C为：



(提出4π的确是个好主意.) 不管怎样,现在我们两边求导得到：



可以看出当时,导函数为零. 解此方程, 两边同时乘以r2再除以2, 我们得到r3 +7r2 - 8 = 0.(你一定要校验一下这个结果！)很好！我们又要解三次方程了.首先试试r=1, 很幸运, 正好合适.再做过多项式除法后我们知道另一个因式为(r2 + 8r +8)(检查一下！). 于是我们有(r - 1)(r2 + 8r + 8) = 0, 所以r = 1或r2 + 8r+ 8 = 0. 这个二次函数的解为, 由于的值约为6, 所以这个解永远为负.因为r为正的, 所以r=1是唯一的临界点. 再一次地,因为端点值依然为无穷大, 所以这点为最小值.(原因同方法一相同——焊接当然不会使其更便宜.).我们再用二次导数测试的方法校验一下：



这个同之前的结果是一样的. 该导函数为正, 图像是开口向上,说明了在r=1这点的确为最小值点.

现在, 我们要求对应的函数值. 通过代入, 计算得出h = 16 / r2 = 16,C=4π (16/1 + 12 + 14 × 1)=124π美分,实际上是约为4美元.看起来我们需要在某些地方降低成本了！所以最完美的情况是当半径为1英寸,高度为16英寸时, 此时的花费为124π美分. 注意：这次的半径比我们第一次计算出来的要小, 这是有意义的,因为这样能减少昂贵的焊接成本.





13.1.5　在最优化问题中使用隐函数的求导方法


　在我讲解最后一个例子之前,让我们重新看一下刚才例题的第一问. 我们已经知道C = 4π rh +4π r2和16 = r2h, 我们是通过削去h而求C的最小值的.但还有另一个方法, 我们可以用两边同时对r求导的隐函数求导方法,这是我们一直没有使用的方法. (请参考8.1节.)求导后我们有：

　和

　校验一下以确保计算的正确性. 如果我们解第二个关于的方程, 因为r ≠ 0, 所以我们有：



再把这个结果代入第一个方程：



因此, 当2r=h时, ,这就是我们以前的计算结果！为了证明这个临界点就是极小值点,我们继续对该函数的两边关于r求导, 这样又得到：



　(现在我们用了刚才的计算结果.)我们需要注意的关键点是以上等式的右端一直为正,所以这个图像是开口向上的, 我们在这点的确有极小值. 当然,我们知道当2r=h时有最小值,但并不能告诉我们这些变量的值到底是多少. 我们需要把2r=h代入16 =r2h中得2r3 = 16, 这样有r=2, h=4, 这同我们的结果是一样的.

现在, 你能否能够自己用隐函数的方法去求解第二问,且确定可以得到与我们相同的结果.





13.1.6　一个较难的最优化例题


　假设距离岸边灯塔东部8英里处的大海里有一处石油钻井平台.备用的发电机在该灯塔北部2英里的地方.在发电机和平台之间需要有电缆连接.在灯塔东部一英里处以内的海水会比较浅, 但其他处会很深.在浅海处安装每英里电缆需要花工作人员1天的时间,但在深海处却需要5天的时间. 找出一种最快的安装电缆的方式,见图13-7(所有测量数据都以英里为单位),计算出在那种情况下共需要多长的电缆？



图　13-7

这个问题看起来很难. 首先, 我们观察一下图13-8,这个图至少在一定程度上还真实一些.把电缆弯弯曲曲地放入水下这个想法不可行, 因为这只会增加它的长度.但另一方面, 我们应该认真考虑哪里应该是浅海处和深海处的分界点.因为一旦分界点确定,这就意味着我们从发电机到分界点要连接一条直直的缆线,从分界点到平台也要连接一条直直的缆线.如果让分界点在发电机的北面或平台的南面这种想法也是很疯狂的,因为这将意味着花更多的时间. 下图是一些合理的方案.



图　13-8

第一个图中有太多的缆线在深海区域, 所以这个想法不是很好.让我们再看看第二个图, 这个图展示了使用缆线的最少情况,但它并不意味着花的时间是最少的, 因为在深海区仍有很多缆线.图三则展示了一种深海区用缆线最少的情况,但这次浅海区的缆线又太多了. 通过对这三个图的分析,由问题本身可以看出, 最佳方案应该是介于图13-8的图二和图三之间.

现在到时候引入一些变量了, 像图13-9展示的那样我们引入变量y, z,s和t.



图　13-9

因此, s是缆线在浅海区的长度;t则是在深海区的长度2; 同样,y是分界点与灯塔和平台的水平连线之间的距离(以英里为单位);z是分界点与发电机的水平连线之间的距离. 所以我们有y+z=2.我们想要找最快的安装缆线的方式, 其实当y和z相等都为1时,是最快的, 那么怎样去证明呢？很显然,我们知道y和z的定义域都为[0, 2], 这就不需要证明了.

2我想深海处缆绳的长度应该称为d, 但是看起来太奇怪了.所以在微积分中不要把d作为一个变量来使用！

接下来我们需要做的是计算所需要的总时间.因为对于浅海区是每英里一天, 一共有s英里, 这样共需1 × s =s天去完成浅海部分的工程. 类似地, 对于深海部分, 需要5天每英里,所以共需5t天. 让T代表总天数, 这样, 我们有：T = s + 5t.这是我们要最小化的数量. 接下来, 我要去寻找关于s和t的方程.为了实现这一目的, 根据图像, 我们可以两次使用勾股定理得到两个方程,得到：



两个方程两边同时开根号, 并把这个结果代入T的等式,我们有：



又因为y+z=2, 我们用2-y来替代z, 可得：



　我把对该函数求导的任务留给你, 可得：



我们想要证明的是所用时间最短是在y=1时.让我们把这个值代入上式中试试, 我们得到：



是的,y=1的确是临界点！至少目前我们有了一点希望去证明它是全局最小值点.不幸的是, 我们仍然需要对此进行证明. 一个证明方法是求二次导数,经过大量运算后, 你可以证明：



由上边的结果可以看出, 二次导数一直为正,所以该图像一直都是开口向上, 则y=1的确为局部最小值点.事实上它一定是仅有的最小值点. 的确, 如果还有其他的临界点,那一定都是最小值点, 因为二次导数永远为正.如果没有任何极大值点不可能会有这么多极小值点,所以不可能再有更多的最小值点了. 这就是说y=1是全局最小值点,就是我们想要的.

我们就快完成求解了, 接下来仅仅需要把y=1代入T的方程中.可以看到：



　所以一共需要天, 即大约为36.75天.在我们进入下一个知识点之前,让我们再用其他的方法去证明y=1是极小值.技巧是用一次导数的表达式：



把这个表达式换一个巧妙的写法.对于右边的分式我们分子分母同时除以y,而对于第一个分式我们同时除以(2-y). 做一个合理的假设,即y和2-y都是正的, 这时我们有：



当y逐渐增大时, 情况会怎样呢？(2- y)逐渐减小, 所以(2 -y)2也逐渐减小, 这样1 / (2 - y)2就逐渐增大.这说明分式一的分母逐渐增大, 则它的倒数会越来越小,但前面又多一个负号, 所以还是越来越大. 那么,我们可以得出这样的结论：当y逐渐增大时, 分式一也是越来越大的.以同样的方式去分析分式二, 当y增大时, 49 / y2是越来越小的,这样分母减小, 所以分式本身还是增大的.

从我们上述的分析看得出来, 是增函数, 至少在(0,2)区间内是增函数. 因为它为增函数, 所以它的导数,也就是原函数的二次导数为正！这样,我们没有经过大量的计算就证明了二次导数为正,并再一次得出结论y=1为极小值点.





13.2　线性化


　现在我们使用导数去估算一些数值. 例如,假设你要不使用计算器去估算的恰当的值. 我们知道比略大, 所以我们当然可以说大约是3点多. 这个结论很好,但实际上我们可以在不做太多工作的情况下做出更准确的估算.下面我将演示怎样做.

我们从设置开始. 因为我们不知道的准确值, 所以我们想去估算它. 另一方面, 我们知道是多少, 是. 这激发了我们的灵感, 让我们画y =f(x)的函数图像, 再画一条通过点(9, 3)的切线,如图13-10所示.



图　13-10

我把切线标记为y = L(x), 这条线非常接近于y =f(x)当x接近于9的时候. 但当x接近于0的时候, 这两条线就不接近了.但这并不影响我们的计算, 因为我们要估算f(11), 11同9是非常接近的.在上图中, 在x=11这点直线和曲线是非常接近的.所以可以说L(11)的值非常接近于.的确是这样的, 请看上图,这两条线所对应的y值在x=11这点是多么接近.

如果我们不能计算出L(11), 那么刚才所做的分析都是空话. 那么,让我们开始计算L(11). 因为线性方程通过点(9, 3)并且与y =f(x)在x=9点相切, 所以该线性方程的斜率为f'(9). 我们对y =f(x)求导得, 所以. 因此可以说直线L(x)斜率为1/6, 并通过点(9, 3),方程为：,化简可得y = x / 6 + 3 / 2. 也就是说.现在我们需要做的仅仅是计算L(11)的值,通过把x=11代入这个方程, 可得. 于是,我们可以说.这个结论比3点多要好得多！ 事实上, 你可以使用计算器去校验一下,由计算器求得的结果是3.317(精确到小数点后第3位),所以我们的计算结果是非常不错的.





13.2.1　线性化的归纳


让我们概括上述的例子. 如果你想要估算一个数值,那么尽量用一个函数去表示这个数. 比如在上述的例子里,我们要估算, 所以我们设函数,这样我们所要做的是计算f(11)的值.

接下来, 我们选一个同x很接近的数a, 但f(a)一定要容易计算.在我们的例子中, 我们无法计算f(11), 但我们能计算f(9),很显然, 根号9很容易计算. 我们也可以选择a=25,因为25开根号也很容易计算, 但这并不合理, 因为25和11相差太远了.

所以, 根据我们所设的函数和我们选的特殊值 a,我们需要求函数y=f(x)在点(a, f(a))上的切线.这个切线有斜率f'(a), 所以该切线方程为y - f(a) = f'(a)(x - a).如果设切线方程为y = L(x), 方程两边同时加f(a),这时我们得到L(x) = f(a) + f'(a)(x - a).这个线性方程L叫函数f在点x=a的 线性化. 记住,此时的L(x)大约等于f(x). 所以我们有：



当x很接近于a时, 这个近似值几乎是准确的！事实上,当x真正等于a的时候, 近似值就完美了！可以看出,此时这个方程的两边都为f(a). 我们已经理解了f(a),所以这个结果就不是很重要了.这个方程的好处是我们可以估算当x接近于a时f(x)的函数值.

让我们用刚刚得到的这个公式去校验一下刚才的例题. 我们设. 很显然f(a) = f(9) = 3. 因为, 我们有. 根据上述公式,该函数的线性方程为：



　这同我们的公式相吻合, 我们正是用去求得的. 现在,你知道怎样估算吗？8同9也是很接近的,所以我们还可以使用同样的线性方程：



所以公式给出了所有接近于9的的一个估算,不仅仅是11.

　另一方面,假设我们要估算. 如果直接使用L(62),这不是很明智的. 首先让我们看看这个不明智的结果是多少：



等一下, 让我们观察一下这个数, 我们会发现很接近于(比它略小).那么我们得到的结果要远远大于8,这偏离得太远了. 问题出在哪儿呢？我们的线性接近是在x=9这点做的,62离9太远了, 所以这个线性方程就不好用了. 为了估算, 我们最好计算在x=64的线性接近. 因此, 设定a=64,那么我们有.这样我们新的线性方程为：



当x=62时, 我们有：



这个估算结果要比我们刚才得到的接近得多了.





13.2.2　微分


让我们再看看线性表达式的通式：



如果我们定义Δ x为x - a, 那么则有x = a + Δx.这样上述公式变为：





见图13-11：



图　13-11

该图像显示了y = f(x)的函数图像以及线性方程y=L(x),即通过这个函数上x=a 点的切线的方程. 我们要估算f(a + Δ x)的值. 点F是该函数在a + Δ x点所对应的函数值;点P是这个线性方程在点a + Δ x所对应的函数值, 实际上是L(a+ Δ x). 这两个数值的差实际上就是我们的计算误差,在13.2.4节中我们要仔细讨论这个问题.

在上图中, 有个数值被标记了出来, 那就是, 是点P和f(a)的差. 这也是为了完成我们的估算要加到f(a)上的数值.因为L(a + Δ x) = f(a) + f'(a)Δ x, 我们可以说：





叫做函数在x=a点的 微分.当自变量x从数值a变化到a + Δ x时, 表示了因变量函数f的变化量.

实际上我们以前接触过这种思考问题的方式. 在5.2.7节中,我们说如果y = f(x), 那么.这说明当自变量x发生微小变化时,它所对应的因变量发生的变化量是它的f'(x)倍. 这就是告诉我们的, 只是这个算式是从x=a开始的.

　例如, 假设我们要估算(6.01)2. 首先设函数f(x) =x2并且a = 6; 这时, 很容易求出f'(x) = 2x, 所以f(6) = 12.我们想知道当x从6开始增加了0.01时,它所对应的函数值发生了怎样的变化. 所以我们设置Δ x = 0.01,我们得到：



因此, 如果我们把0.12加到f(a)的函数值上,我们就有了一个不错的估算的值. 因为f(a) = f(6) = 62 = 36,这说明.现在让我们再回过头来看看5.2.7节：我们解答了同样的例题,基本使用的是同样的方法, 但现在我们有更好的公式了.

　这儿还有个展示怎样使用微分的例子.假设你用尺子测量了一个圆球的半径, 结果为6英寸,但是这个测量结果有正负0.5%的误差.如果使用我们的测量结果去计算该球的体积,那么我们的计算结果的准确率有多高呢？让我们用微分的方法来解决这个问题,至少是估算. 假设球的半径为r, 直径为D, 体积为V,那么它的半径为r = D / 2, 所以我们有：



当D=6时, 我们有V = π (6)3 / 6 = 36π. 这样,我们已经计算出该球体的体积为36π立方英寸,但是真实的情况要比这个值略大或略小. 为了知道多多少或少多少,我们可以使用上边加框的公式.在这个例题中f需要用V来代替, a用6来代替, x用D来替代,这样公式变为.把上一个关于V的公式两边同时对D求导, 可得：



这说明V'(6) = 18π, 所以.这个方程说明如果你将D的值从6改变到6 + Δ D,那么V的值改变了18π Δ D.在我们的例子中直径可能比6多0.5%或少0.5%, 也就是0.005 ×6 = 0.03英寸. 所以Δ D可能是比真实的情况多0.03或少0.03英寸.在最糟糕的情况下, 我们有. 这个误差是个很好的估算,所以我们可以说该球体的体积为36π立方英寸,上下最多有0.54π立方英寸的偏差.由于在直径中最初的偏差是用百分比来表示的,所以我们也应该这样来表示体积的误差. 用百分比来表示,一个大约的误差占V = 36π的百分比为：



换句话说, 在体积中的误差是直径中的3倍.这就是你把一次方的误差代入三次方计算后所得的结果.





13.2.3　线性化的总结和例子


以下是估算或近似计算一个复杂的数的基本策略：

1. 写出主要的公式：.

2. 选择一个函数f, 用x来替代我们要计算的数,从而可以用我们选择的这个函数f(x)去表示要计算的这个数.再选一个a, 并且a和x非常接近, f(a)又很容易计算.

3. 对该函数求导.

4. 在上述的公式中, 用实际的函数及其导函数来替代f和f',用我们已选定的实际数值去替代a.

5. 最后, 把第二步中的x值再代入公式, 这样就有.

　下面,再让我们看几个例子. 首先, 你怎样估算sin (11π /30)？我们使用刚才总结的方法. 首先我们从基本公式开始. 我们需要去求某数的sine值,所以让我们假设f(x) = sin x. 我们对当x = 11π /30的函数值感兴趣. 接下来我们需要选择一个数a,使得a很接近于11π / 30, 并且f(a)很容易计算. 当然,f(a)就是sin (a). 那么一个什么样的数既接近于11π / 30,它的sine值又很容易计算呢？10π / 30怎样呢？其实它就是π /3, 我们很清楚sin (π / 3)的值. 所以设a = π / 3.

这样, 我们完成了前两步, 下面让我们进入第三步. 求导得f'(x) = cos x, 所以线性表达式变为：



因为f(x) = sin x, 化简该公式得：



最后代入x = 11π / 30得：



这看起来可能仍然很糟糕, 但至少这个估算没有涉及三角函数,仅仅涉及了π和, 这两个数并不是很难计算.

　现在,考虑一下这个例子：用线性逼近找到ln (0.99)的估算值.这次我们设置f(x) = ln (x),而且发现我们对x=0.99时f(x)的值很感兴趣， 就取对数而言，接近于0.99的数字1很适合, 所以我们设a=1.很容易计算得f(x)=ln(x)且f'(x) = 1 / x. 这样公式变为：



因为ln (1) = 0, 我们有：



用0.99来替代x, 可得：



这样, 我们就完成这个计算了.

　一个更普遍一点的例子,怎样估算ln (1 + h)的值(h是任意很小的数)？事实上,你可以使用我们刚才已经找到的线性表达式去估算ln (1 + h). 如果用1+h来替代x, 可得. 也就是说(h是个很小的数). 实际上, 这并不是个让人吃惊的结果, 在9.4.3节中,我们已经看到：



所以, 我们已经知道当h是一个很小的数的时候, ln (1 +h)很接近于h.

　最后, ln(e +h)的估算结果又是多少呢(h是个很小的数)？我们现在需要一个不同的线性表达式,因为 (e+h)很接近于e而不是1. 所以让我们设a = e, f(x) = ln (x), 于是有f'(x) = 1 / x.这样新的公式为：



因为ln(e)=1, 所以我们有：



当x=e+h时, 我们得到：



也就是说, (如果h为一个非常小的数). 这同我们上一例题的结果是不同的,在上一例题中, 我们看到(h是个很小的数).这两个结果的不同原因是a值的不同.





13.2.4　在我们估算过程中的误差


尽管L(x)和f(x)是不同的,但我们已经展示了怎样用L(x)来做f(x)的近似计算.问题是：我们用f(x)近似计算L(x)的误差有多大？找到答案的方法是考虑这两个函数的差.它们的差越小, 我们的估算就越精确. 所以, 我们设r(x) = f(x) -L(x),r(x)表示我们在对函数在x=a点使用线性估算时的误差3.我们可以看出如果函数f的二次导数存在,至少在x和a点之间是存在的,那么对于r(x)我们有一个很好的公式4：

3r(x)中的字母r代表“余数”.

4证明请参见附录A中的A.6.9.

　对于在x和a点之间的任意数c.

但问题是, 我们不知道c的值, 只知道它是介于x和a之间的数.上边的公式要用到中值定理, 我们在11.3节中介绍过. 定理中提及了数c,尽管没有告诉我们更多的信息, 但我们不应该吃惊在这里遇到这个数.

上述公诉告诉了我们两件事情. 首先是(x - a)2项恒为正,这说明r(x)的符号是与f''(c)的符号相同. 所以,如果我们知道该函数图像是开口向上的, 至少在x和a点之间是这样的,那么我们就可以说r(x)是正的. 又因为r(x) = f(x) - L(x),所以有f(x) > L(x). 这说明我们的估算值偏低,可以参考13.2.2节中的图像. 另一方面, 如果该函数的图像是开口向下的,那么f''(c)肯定是负的. 这样我们可得f(x) < L(x),这说明我们的估算值比实际值略大.

例如, 当我们在13.2节开始的时候, 估算过的值,我们使用函数. 分别求该函数的一次导和二次导,可得和.我们可以看出该函数一直都是开口向下的,通过函数的图像也看得出来.无论通过计算还是图像都看得出,我们估算的结果比实际值略大.

　总的来说,我们有下述结论：

如果在a和x之间函数二次导数为 正, 即f'' > 0,那么我们用线性逼近估算出来的结果要偏小.



如果在a和x之间函数二次导数为 负, 即f'' < 0,那么我们用线性逼近估算出来的结果要偏大.





现在让我们再看看刚才的偏差方程. 如果我们对上述方程的两边取绝对值,得：

|误差|

假设我们知道当t在x和a点之间变化时, |f''(t)|的最大值可能是某数M. 这时尽管我们不知道c的值,但我们知道|f''(c)| ≤ M,这样我们有下述公式：

|误差|

M仍然是当t在x和a点之间变化时|f''(t)|的最大值.实际上, 在上述等式中的重要的因子不是M, 而是|x - a|2这个因子. 可以看出, 当x 接近于a时, |x - a|这个值是很小的, 所以平方后那就更小了(例如当你对0.01求平方时,你将得到一个更小的数0.0001. ). 这说明误差是很小的,我们的估算是很精确的.

　让我们看看这个结论怎样应用到刚才的例题中来估算. 我们设. 我们还选择a=9, x=11.问题是当t在9和11之间时, |f''(t)|的值会是多少呢？很显然：



等式的右边是个关于t的减函数, 所以t越小, 该函数值越大,也就是说当t=9时, 有最大值. 所以M = |f''(9)|,结果为1/108. 我们有这样的结论：

|误差|

所以当我们以前说,现在我们是非常自信的, 我们的结果很接近真实值. 事实上,我们的误差是在± 1 / 54之内. 更准确地说,实际上我们知道：



事实上,我们已经知道刚才计算的结果比的实际值略大, 我们可以有更接近的结论：



　现在我们再看看13.2.3节中的估算ln(0.99)的例题, 通过估算, 我们知道. 这个估算到底有多接近呢？设f(x) = ln (x), 则有f'(x) = 1/ x, f''(x) = - 1 / x2. 因为二次导数为负,所以我们的估算结果又偏大了. 现在当t的范围在a=1和x=0.99之间时, |f''(t)| = 1 /t2的值会是多大呢？因为t为减函数,所以最大值出现在t=0.99的位置上. 所以最大值为M = 1 / (0.99)2,这样我们的误差是：

|误差|

化简后得到的结果大约是0.000051, 是非常小的.也就是说-0.01是非常接近于ln (0.99)的真实值的. 更准确地说,我们已经证明了这个不等式：



事实上, 因为我们知道-0.01是略大的估算, 这样,上述不等式的右侧可以再次简化, 于是有：



这样我们把ln (0.99)的值缩小到了一个很小的范围.

在我们以后的学习中,第24章的泰勒级数中我们将要再次研究估算以及误差问题. 那时,我们不仅要使用一次导数, 也要使用二次导数去得到更精确的估算.





13.3　牛顿方法


下面我将要介绍线性逼近的另一个有用的应用. 假设现在你要解一个f(x)= 0这样形式的方程, 但你却不能找到这个方程的解.所以你做出了下一步的决定：你要猜测该方程的解, 你假设解为a,这时方程的情况可能如图13-12所示.



图　13-12

从图像中可以看出, f(a)实际上并不等于零,所以a实际上并不是该方程的解, 它仅仅是个近似解,或者可以说是个对解的估算. 我们把它考虑为求解的第一步,这就是为什么在上边的图像中把这点标记为“近似解的开始”.牛顿方法的基本思想是通过使用函数f在a点的线性逼近使估算的结果越来越接近于真实结果(当然,这意味着该函数在a点是可导的). 不管怎样, 让我们看看它的图像,如图13-13所示.



图　13-13

这个线性方程在 x轴的截距是b, 这实际上是个比a点更好的近似值.通过开始的猜测, 我们已经得到了一个更好的结果.但b的值是多少呢？很好, 它是该线性方程L在x轴的截距,该方程为：



同13.2.1节中给出的公式是一样的. 求x轴的截距, 我们设L(x)=0;这时, 我们有f(a) + f'(a)(x - a) = 0. 求x的解,我们得到：



因为我们把x 轴的截距称为b, 这样我们有下述公式：

牛顿方法　假设a是对方程f(x) = 0的一个估算解.如果你有：



这时通过许多次计算得到的b是个比a更好的近似解.



　有时这个方法不是很灵, 所以我在上述方法中加了一句“许多次”.一会儿, 我们再仔细讨论这个. 现在让我们先看一些例题. 假设：



我们要求这个方程f(x) = 0的解.该方程有解吗？让我们分析一下：f是连续的, f(0)=-1(为负值),f(1)=2(为正值),根据介值定理(参照5.1.4节)我们可以说该方程至少有一个解. 另一方面,f'(x) = 5x4 + 2, 一直为正; 所以f一直为增函数,这说明该方程最多有一个解(参照10.1.1节). 这样,我们已经证明了该方程有唯一的解. 让我们估算这个解为0.我们知道f(0)=-1, 这并不是很接近于0. 没有问题,让我们用牛顿方法从a=0开始：



所以b=1/2是个比0更好的估算. 的确, 通过计算可知f(1 / 2) = 1 /32, 这个结果很接近于0. 什么能使我们停止重复使用这个方法,得到一个更好的解呢？没有什么能使我们停下来！这次让我们说a=1/2重复使用这个公式得：



(注意, 这里我们使用f'(1 / 2) = 5 ×(1 / 2)4 + 2 = 37 /16这个计算. )无论如何, 这说明18/37是个更接近于真实结果的估算.通过计算f(18 / 37), 你会得到结果为0.0002, 已经是个很小的数了.所以我们说18/37是个对该方程解的一个很好的估算.

像这样重复使用a和b可能有些乱. 为了避免这种混乱的方法,我们可以用x0作为首先的猜测, 接下来用x1来做进一步的估算;再用x2来做下一步的估算, 以此类推.这样公式现在可以为：

　等等.

这儿有另一个例子. 求方程x = cos x的近似解, 首先设f(x) = x -cos x. 如果我们能估算出函数为0时的x的值, 那么这个值就是x =cos x的解. (我们在5.1.4节中已经使用过这个技巧了.)首先让我们假设x0 = π / 2; 这时f(π / 2) = π / 2 -cos (π / 2) = π / 2. 这是个极其不好的估计. 不过不要担心,因为f'(x) = 1 + sin (x), 我们有f'(π / 2) = 1 + sin (π/ 2) = 2. 这可以说明：



所以x1 = π / 4是个更好的估算; 的确, , 大约为0.08. 现在让我们重复使用这个方法,得到：



因为,这样上述的计算可以化简为：



实际上这是个比π / 4更小的数. f(x2)的计算结果为0.0008.这说明x - cos (x2)的值大约为0.0008, 所以x2是对上述方程x = cos (x)的解的一个很好的估算. 当然,我们能重复使用这个方法去得到一个更好的近似值x3,但这要涉及更复杂的计算. 尽管牛顿方法已经给出了一个很好的估算,但计算机或计算器的估算会更精确. (请不要忘记, 计算器给出的也仅仅是估算的值！即使保留到小数点后10或12位仍然为估算的结果,尽管在大多数情况下这已经很接近真实结果了. )

　像我们以前提及的那样,但是没有解释过, 有时牛顿方法也解决不了问题.有四种不同的情况会导致结果是错误的：

1. f'(a)的值接近于0　显然, 如果：



那么f'(a)不可能为0, 否则b是没有意义的. 在这种情况下, 在x=a点的切线不可能与x轴相交,因为它是水平的！即使f'(a)很接近但是不等于0,牛顿方法都将给出一个很糟糕的结果; 例如, 见图13-14.



图　13-14

即使我们开始对a点的估算很接近真实值r, 牛顿方法的结果 (b)远远偏离真实结果r. 所以最终我们并没有得到一个更好的估算.为了避免这种情况, 确保你的最初的猜测要远离函数f的临界点.

2. 如果f(x) = 0有不止一个解,这时你可能得不到你想要的结果　例如, 在图13-15中,如果你想去估算使函数为0的左边的根r, 你会猜测从a点开始,但却以s点结束估算：



图　13-15

所以除非你确定只有一个解,否则你开始的猜测点a应该很接近你想要的根.

　3. 估算值可能变得越来越糟　例如, 如果,那么对方程f(x) = 0的仅有的解是x=0.如果你想使用牛顿方法(我猜想这是你能想到的方法中最好的),那么奇怪的结果会出现. 除非你从a=0开始,否则就会有下述结果：



所以下一个估算值一直是你开始值的-2倍. 例如, 如果你从a=1开始,那么下一个估算值将要是-2, 如果你重复使用这个方法, 你将要得到4,-8, 16等等. 这离正确值0越 来越远. 如果这种情况出现了,那么牛顿方法就解决不了问题了.

4. 你可能在一个循环中出不来了　有时这种情况也可能出现,你通过估算值a计算出另一个近似值b,这时通过计算发现b的下一个近似值为a.这说明在这个重复计算过程中, 没有其他的点了, 你进入了一个循环.图13-16是这种情况的可能图像.



图　13-16

　在x=a点的线性逼近在x轴的截距为b,在x=b点的线性逼近在x轴的截距为a,所以牛顿方法在这里并不适用了.一个具体(但很复杂)的例子是：



　如果你从a=1开始,通过计算可知b=-1. 因为f为奇函数,很显然再从-1开始的计算结果为1. 这很不幸我们遇到了一个循环.选其他的开始点试试. (顺便说一下,这种类型的循环的研究导致了我们对不规则分形几何图形的研究,这种几何图像是现在很流行的一款计算机屏保……)





