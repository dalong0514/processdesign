# 
> 2018000模板



第 18 章　积分的方法：第一部分


让我们开始研究求反导数的方法, 开始建立一套求反导数的技巧.在这个章节中, 我们将要学习以下方法：

替代法(也可以叫换元法);



分部积分法;



使用部分分式对有理函数求积分.





在下一章的学习中, 我们将会看到关于使用三角函数的更多技巧.





18.1　替代法


使用链式求导法则, 我们可以很容易的求出关于x的导数, 请看



因子2x是出现在指数位置的x2的导数.现在, 像我们在上一章中的17.4节中见过的, 我们可以得到



对于任意常数C成立.所以我们求得了关于x的积分. 那么的积分为多少呢？你可能认为求解该积分是很容易的：



这个积分好像并不难求——但这是不可能的！虽然不是完全不可能的,但事实是的反导数表达式是很复杂的.(要计算这个积分你需要求助无穷级数、定积分或一些其他的方法.)你会不会认为为这个函数的反导数呢？不是——你可以使用除法规则对这个函数求导(关于x),求导后的结果和有天壤之别.

　能让我们解出的原因是2x这个因子的存在,该因子恰恰就是链式求导法则之后的x2的导数.现在考虑从这个不定积分开始：



我们要求这个带着x3的cos函数的反导数,但是我们还有一线希望：里面的x3的导数是3x2.这几乎和被积函数里的一个因子x2相匹配——这里仅仅是常数3使得问题看起来有些难了.仍然是这样的, 常数可以被移到积分符号的外边去,所以这并不是一个问题.

让我们从设置t = x3开始, 所以cos (x3)变为cos (t).我们的目的是：要用t去替代表达式中的每一个x.你可能会说上述的积分是变量x统治的领地, 但我们要把它变成t领地.我们已经把cos (x3)替换掉, 但我们还需要考虑替换x2和dx.

事实上dx是很重要的. 你不能随便的把它改为dt！因为t = x3,所以有dt / dx = 3x2. 我们可以把dx移到等式的右侧,这样有dt = 3x2dx. 我们先不要考虑这意味着什么;我们将会在18.1.3节中讨论. 好,现在让我们把等式的两端同时除以3得. 这样对于原积分函数我们可以去掉x2和dx,而用去替代, 像这样：



中间的过程不是很必要的,但把x2和dx放到一起可以帮助我们更清楚的看到它们被dt/3代替.无论如何, 现在我们都可以把1/3移除积分符号的外边, 然后再求积分;所以我们有



如果仅仅把答案写为,这样做有些懒. 我们从变量x开始, 后变为变量t;现在让我们再变回x. 这样做并不难：仅仅用x3替代t即可.所以最后的答案为：



我们可以通过求对x的导数来校验这个结果是否正确.

　让我们再来看些例子. 首先, 考虑



因为sec2里面的变量是讨厌的, 让我们用t去替代它.所以假设. 求导可得. 现在把dx移到右边可得.这几乎是我们在积分符号里面看到的——我们仅仅需要的是去掉因子2.所以两端同时被2除可得. 把刚才的积分变为以t为变量, 我们有



现在把因子1/2 移出积分符号然后积分可得tan (t) + C.最后再回到以x为变量的状态, 只要用替代t.这样我们证明了



　再一次提醒,你可以通过对右边求导来校验这个结果是否正确.

来看另一个例子：



这个例子看起来很难. 幸运的是, 如果我们对分母x3 + 7x -9求导可得3x2 + 7. 因此我们可以通过设置t = x3 + 7x -9来求解. 因为, 我们可以写为. 用t做变量, 我们积分的结果为



现在用x3 + 7x - 9来替代t, 可以回到以x为变量的状态.这样结果为



实际上,这是一种特殊情况：如果f是可导函数, 那么





所以如果分子为分母的导数,这时的积分结果恰恰是底的log(底要取绝对值并加C).我们可以通过设置t = f(x)来证明. 这时,所以我们能有d.如果我们能用链式法则把由x为变量变为由t为变量的状态, 这时回到：



这事实上就是说在上述的例子



　中,你可以把答案写为ln |x3 + 7x - 9| + C,因为分子恰恰为分母的导数. 有时分子是分母导数的倍数, 像这样：



分母的导数是2x,但在分子的位置我们仅仅有x. 没问题——乘以一个2再除以一个2,像这样：



　现在你可以把答案写为了, 因为分子(2x)恰恰是分母(x2 + 8)的导数. 最后考虑



做这道题的最好方法是把这个积分重写为



请注意分母ln(x)的导数就是分子1/x. 根据刚才盒子里的公式,这个积分的结果为ln |ln (x)| + C, 这样有





18.1.1　换元法和定积分


　在定积分中你也可以使用换元法.解决这样的问题有两种方法. 例如, 计算



你可以先计算 这个不定积分, 然后把积分上下限写上.在上一节中我们已经计算过这个不定积分了; 为了简便,我们用t = x3去做换元, 注意,所以, 这时为



事实上最后一步换回到x很重要.无论如何关键的是我们已经找到了它的导数为x2cos (x3),并且我们可以使用17.3节中微积分的第二基本定理去解决问题：



通过计算可得结果为1/3.所以使用换元法计算定积分的一个方法是先求不定积分,然后把积分上下限分别代入去求定积分.

　但这儿还有一个方法！在整个计算过程中你都一直计算定积分,但一定要记住把积分的上下限也用变量t来表示.在我们的例子中, 我们用t = x3去换元,然后使用x帮助我们换到以变量为t的积分. 现在当x=0时, 我们有t = 03 =0, 所以积分下限为0. 但对于积分上限, 当时,我们有.这也就是说我们必须把积分上限换为π / 2. 综上所述,这道题换元后的结果为：



我们很快就会完成这道题目,但请注意如果把积分上限写成这样那就大错特错了：



因为我们现在正在对t求积分而不是对x,因此积分上下限也是以t为变量.事实上我们可以以被积函数的变量为积分上下限的变量,从而使该积分更容易去求解, 像这样：



这真的强调了我们正在做的事：当x=0时, t也为0; 但当时, t = π / 2. 所以让我们总结一下,实际上有三次替代：

1. dx——我们要用dt来表示它,我们可以借用被积函数里的其他带有x的项来帮助我们做相应的变化;

2. 把被积函数里所有带有x的项都用t来表示;

3. 积分上下限也用t来表示.

让我们来完成这道题目. 最好的方法是我们把计算过程写在左边,像这样：



注意, 在我们开始右边的计算之前要先把左边的准备工作做完,因为我们要使用左边所有的信息帮助完成以t为变量的转换.

　这儿有一个看起来更复杂的例子：



先问问你自己：在这个被积函数中,有哪一项是另一项的导数吗？我们很幸运, 是这样的：sin - 1(x)的导数为. 所以试着用这个替换t = sin - 1(x). 的确是这样的, ,所以我们有



我们还需要把积分上下限用t来替代, 把和分别代入t = sin - 1(x). 你会分别得到t = π /4和t = π / 3,只要你还记得反三角函数的基本知识！(参照第10章复习这方面的知识.)我们把这些东西综合在一起,可得：



为得到这个最后的化简结果,我们需要知道基本的对数运算法则(参照9.1.4节). 最好你能记住这些.

顺便说一下, 如果你目光锐利,你会注意到上述的替代实际上是上一节的最后一个例子的特例.这给了我们一个方法去求解这个积分



让我们从不定积分开始, 把它重写为：



注意分子正好是分母的导数,所以我们要取分母的绝对值的对数, 得到最后的答案为



　现在为了计算这个定积分, 可以替代原始的积分上下限和, 一次一个代入ln |sin - 1(x)|这个表达式, 然后再求差. 我把计算的细节留给你去做.

　这儿有一个关于替代法的不同的问题. 在16.1.1节中, 我们说过

如果f 是一个奇函数,这时对于任何a都有

你怎样证明这是正确的呢？我们从在x=0点把这个积分分成两部分开始：



对于等式右边的第一个积分, 让我们用t=-x去替代.这时; 并且当t=-a时, 我们看到x=a, 当t=0时,x=0. 所以我们有



在最后一步我们用负号切换积分上下限. 现在因为函数f为奇函数,所以f( - t) = - f(t). 这表明了



现在, 如果我们把虚假变量变回x,那我们就证明了随后的这个结果：



这个等式只有在函数f为奇函数时才成立！总之,我们可以回到最初的方程并使用刚才的这个结果：



我们的任务完成了！





18.1.2　怎样决定替代公式


你怎样选择被替代的函数呢？这是个很好的问题.基本思想是寻找被积函数中的一些部分, 其导数也出现在这个被积函数中.在下面这个积分中.



　我们选择t = sin - 1(x)换元, 因为它的导数也恰恰在被积函数中. 在下列积分中这个替代法也是适用的.

　和

在以t为变量的情况下, 这些积分分别变为

　和

前两个积分很容易观察出来;但对于第三个可不是那么容易了,需要把平方根拆开观察换元法怎样帮助我们计算.



　现在确定你能准确的计算出上述以t为变量的积分,然后可以再把它们替换回以x为变量的积分. (对于第三个积分,如果我们把写为会方便我们计算.)无论怎样算你都会分别得到

　和

把得到的每一个结果求导校验看我们的计算是否正确.

　有时怎样去换元不是很明显. 例如, 你怎样计算这个积分



可能想象出来的替代为t = ex,t = e2x,t = e2x + 1. 这后两个替代并不能解决问题, 因为在这两种情况中, 但在被积函数的分子中没有e2x这项. 所以让我们设t = ex, 这时我们有, 该项正好出现在分子. 至于分母, 我们可以把e2x改写为(ex)2, 这就是t2. 所以



这个积分的结果为tan - 1(t) + C.再把它换回以x为变量的积分, 我们有



对于任何常数C都成立.我们可以通过把等式的右端求导来校验这个结果是否正确.

　让我们再看一个例子：



关于计算这种类型的积分我们有一个非常好的方法.可以简单的设,在求dt之前要先两边同时n次方. 所以：

在换掉之前,设并对等式两端求导.}



所以在我们的例子中设. 为找到dt,把等式的两端5次方得t5 = 3x + 2.现在把这个新的等式两端同时对合适的变量(由链式法则决定)求导得. 5t4是t5关于t的导数,3是3x+2关于x的导数. 所以我们找到了可以用t去表示3dx的表达式, 等式两端同时除以3我们就得到了dx的表达式.在本例中我们有



(通过写出关于x的表达式再两边同时对t求导也可得上式.)现在让我们回过去重新看这个积分.该积分表达式有三项：x、和dx. 第二项就是t,我们已经找到了用t表示第三项的表达式.那么第一项x该怎么处理呢？我们知道t5 = 3x + 2,所以可以重新整理这个等式可得. 这样这个积分表达式为



现在我们先做乘法然后再积分可得



再回到以x为变量的积分：用再替换得



　你应该试着自己解决这个问题, 把你的解题思路写在计算过程的左边,我们在从前的例子中演示过. 并且你也应该把所得的积分结果求导,校验你是否会得到. 顺便说一下,你是否注意到这道题用的换元法同我们以前的换元有何不同？确实有一点点不同,在其他的例子中我们用的方程是dt=(关于x的函数)dx,然而在这个例子中我们写为.这种写法对于我们的计算很有帮助, 因为我们可以直接替代dx.在所有的其他的例子中,我们不得不找到一个已经存在的x的表达式的常数倍这样才有机会化简.在19.3节中, 我们将要看到能直接替代dx的其他的例子.

总的来说, 对于怎样换元没有硬性规定. 你需要跟着直觉走,只有在做了大量的习题之后你的直觉才会越来越正确.可以尝试任何你想到的替代. 如果替代后的积分比原始的积分更糟糕,或者你找不到任何方法把每一个变量都化成t变量,这时不要着急：你仅仅需要做的是再回到原始积分, 然后尝试其他的替代.

　现在,在介绍分部积分法之前我需要再阐述两点. 第一点是换元方法的识别;在下一节中我将要介绍这点. 第二点是对换元法的总结,如下所示.

对于不定积分, 用t和dt分别去表示带有x的表达式和dx,然后再求这个新的用t表达的积分, 最后再换回到x.



对于定积分, 用t和dt分别去表示带有x的表达式和dx,并且也要把积分上下限换为与t相关的,这时计算这个新的积分(没有必要再回到以x为变量的状态).当然也可以用另一个方法, 那就是先把它看成不定积分计算结果,然后再把积分上下限分别代入求最后的结果.





18.1.3　换元法的理论解释


　假设你想在某些积分中做这样的替代t = x2. 这样你得到, 改写为. 在某种意义下,这是一种没有意义的陈述——毕竟dt和dx没什么实际意义.我们知道dt/dx是一种导数的表现形式,但在第13章中dt和dx仅仅被定义为微分. 所以究竟意味着什么？一个好的解释是当t发生微小变化时,它的变化量是它所对应的x的微小变化量的2x倍.实际上在5.2.7节中有过这种类型的表达式. 你可以采用这种方式去观察它,看怎样用黎曼和解释它, 但这儿有一个更好的方式：仅仅使用链式法则.

这是怎样去解释这个积分的细节. 设想你已经做了一个替代 t=g(x),我们用以t为变量的结束,该积分的结果为F(t)+C(C为常数). 所以这个积分以t为变量可写为：



因为t=g(x), 所以我们可得, 这样上述方程可以转化为以x为变量的式子：



我所做的就是分别用g(x)替代t,用去替代dt. 所以如果你想证明这个替代是有效的,我们需要证明上述方程是正确的. 设h(x) = F(g(x));根据链式法则(参见6.2.5节第一部分), 这种表示形式是正确的.我们可以以不定积分的形式来表达：



因为h(x)= F(g(x)), 我们有



现在,因为, 所以F'(t) = f(t);因为t = g(x), 我们有F'(g(x)) = f(g(x)). 这样上述方程变为



这正是我们要证明的方程！

顺便说一下, 这个漂亮的方程可以帮助我们证明一种换元法,这种方法恰恰就是我们在上一节的最后一个例子之后讨论过的.(当我们学习19.3节的三角替代法时, 将会一次又一次的见到这个方法).第二种换元法是, 不是设t=g(x)而是对于一些函数g设x=g(t),这样我们用替代dx. 在这种情况下,最初的积分函数现在变为



现在我们可以计算出这个积分了, 然后再回到以x为变量的积分上.根据我们刚才证明的漂亮的方程, 其中用t替代了x,我们看到上述积分等于F(g(t)) + C, 其中F是f的反导数.这时的结果恰恰就是F(x) + C, 这正是我们想要的.所以这个方法很管用, 这样我们就证明了此换元法.





18.2　分部积分法


我们已经看到怎样通过使用换元法来找链式求导法则的逆运算.这有还一种方法可以找到乘积法则的逆运算——我们称之为分部积分法.让我们回忆一下6.2.3节的乘积法则：如果u和v是关于x的函数, 则有



让我们重新写一下这个方程,等式两边同时再对x求积分. 我们得到



等式右侧的第一项是函数uv导数的反导数, 所以它等于uv+C. 其实+C是不必要的,因为等式右侧的第二项已然是个不定积分：它自动包含一个+C.所以我们已经证明了



这就是分部积分的公式, 这种形式是非常实用的,但我们还有这种形式的简单写法, 这种写法更方便.如果我们用dv替代, 用du替代,会得到以下公式





　再一次提醒, 这仅仅是公式的简写形式, 但这种写法确实很实用.让我们看看它怎样帮助我们解决问题. 假设我们想求解



换元法看起来不管用了(试试看看是否能解决问题),所以让我们尝试着使用分部积分法. 我们首先要得到这种形式的积分, 这样才能应用分部积分法.有很多种方法可以化成这种形式, 但有一种很管用的方法：设置u=x并且. 这时我们有.

现在, 让我们使用分部积分法, 我们需要找到du和v.du很容易找到：我们知道u=x, 所以du=dx.那么v怎样去找呢？我们有,所以v究竟是多少呢？仅仅对这个等式两侧同时求积分：. 这也就是说v = ex + C.实际上我们并不需要这样的v——我们仅仅需要能给出我们这种形式的v. 所以我们可以忽略+C仅仅设置v = ex.

我们现在要开始应用分部积分法的公式了, 其中u = x、du = dx、v = ex,并且.使用这个公式的最简单的方式是有一定间隔的写下这个公式,这时如下这样进行替代：



现在我们仍然有一个积分被剩下了, 唯一被剩下的的结果为ex + C. 把这个加进去,我们得到. (从技术的角度来说应该是-C, 而不是+C;但减一个常数也就是加这个常数的相反数, 区分这个是很没有必要的.)

为了能计算出du和v, 我建议你这样来写：



这时我们通过对u求导和对dv求积分来填写空白处：



这时你能很容易的用分部表达式来替代这个积分,因为我们已经做好了所有的准备工作.

你究竟为什么决定选择u=x和呢？为什么我们不设置和呢？我们可以这样做的. 在这种情况下, 我们会有



注意我们通过对求积分得到(记住我们不需要+C).这时通过分部积分法我们有



整个解题过程没有任何错误, 但它却很不实用. 你看,最后这个积分是个比原始积分更复杂的积分！所以我们最好使用第一种假设方法.通常来说, 如果你在表达式里面见到ex,好好待它——它是你的朋友, 因为它的积分是它自己.这里的规则是如果ex存在, 我们通常让, 因为这样可以很简单的得到v即为ex.

一些细节

　这里面有很多复杂的情况. 有时你需要计算多次分部积分. 例如,你怎样计算



很好, 它是一个乘积的形式, 所以换元法不适用,让我们试着用分部积分法. 这里没有ex, 但是有sin(x),这也非常好. 让我们设置u = x2, 并且.我们得到



这里我们通过对求积分可得(记住没有必要写 +C). 所以我们有



现在我们把2从最后的积分中拖拽出来,我们将要完成这个积分, 只要我们知道的积分结果. 这比我们的原始积分表达式要简单,原始表达式里是x2而现在仅仅为x了,毕竟余弦和正弦函数是非常相似的. 所以再一次用分部积分法.让我们假设U=x并且;这次我使用大写字母是因为第一次我已使用了小写字母.现在我们有



这样通过替代,我们有



我们已经知道, 所以有



我们几乎快完成了. 我们仅仅需要做的是把这些代入最开始的表达式里：



(再一次强调, 我不写+2C因为它就是一个常数. )

　有时在两次分部积分之后情况并未好转. 在这种情况下如果你运气好,那么将会得到原始积分的倍数. 如果你很不走运,那你只有把刚才的计算扔到一边, 重新再来了. (如果你很不走运,那么原始积分就可能会被正好约掉, 要是这样就一点忙也帮不上了！)这种情况到底是什么样的, 这儿有一个例子：



对于这个被积函数,它即包含余弦函数又包含对数函数, 但我更倾向于用对数函数,所以让我们设置.我们得到



(当你对求积分以求v时, 别忘记要除以2.)这样我们有



现在等式右侧的新积分同我们最开始计算的积分表达式的难度是等同的,所以对于我们选择的这种计算方法是否合适现在还不是很清楚.无论如何我们先保留这种方法, 再次用分部积分法, 这次我们设.让我们看得到什么：



通过分部积分法, 我们有



把这两次的计算合并到一起, 我们有



这能帮助我们计算吗？是的——如果我们注意到在等式的两端出现同样的积分,这时再把这两个积分都移到等式的左边. 事实上,我们可以在等式两侧同时加上原始积分的1/4,这样可以把等式右边的积分消掉, 再加上一个常数C得到



现在我们在等式两侧同时乘以4/5得到



(再一次提醒, 我们不写; 我们仅仅写+C来表示常数.)

　这里有另一种类型的积分也需要用到分部积分法, 但是它的计算更复杂.在这种情况下, 这种类型的积分没有乘积的形式. 一些这种类型的积分有；



　这也就是说, 如果积分是反三角函数或ln(x)的幂的形式,可以用分部积分法. 在这种情况下, 你应该设置u为这个函数本身,并让dv=dx. 例如, 计算



我们设置. 这时我们有



并且所以有(我们暂时忽略积分上下限)



　使用18.1节最后的方法,右侧的积分等于(确信你同意这点！), 所以我们有



　　你怎么得到这个最后的答案呢？我们知道对数和反三角函数！确保你相信上述答案是正确的.同时, 注意我们先计算不定积分以便计算定积分(我们要先把积分变量转移到以u和v为变量上来！). 这通常是一个很好的方法.也就是说, 当用分部积分法求解一个定积分的表达式时,先寻找它的不定积分, 最后再把积分上下限代入.





18.3　部分分式


让我们研究怎样对一个有理函数求积分. 我们将要计算的积分如下所示：



其中p和q为多项式.这种类型在积分中所占的比例也很大, 例如

　或

这些题目看起来有些复杂.这儿也有一些简单的例子：

　和

　最后这四个积分也是有理函数的积分但相对简单一些.我们可以尽量使用换元法求解这些积分. (对这四道题目的换元分别是t =x - 3,t = x + 5,t = x / 3和t = x2 + 9.)前面的两个积分的分母是线性方程的幂,而后两个是二次函数且不能被因式分解.

基本方法：首先我们将要看到怎样处理有理函数,我们要通过一些代数运算把它分解成几个更简单的有理函数的和的形式;然后将看到如何对这些简单的有理函数求积分.我们提到的这些更简单的有理函数就像刚才最后那四个一样：它们要么看起来像一个常数比上一个线性函数的幂,或者像一个线性函数比上一个二次函数. 我们将要首先研究这些代数运算,然后再用微积分的方法. 最后我将会给出这种方法的总结,并且给出一个完整的例子.





18.3.1　部分分式的代数运算


我们的目的是把一个有理函数分成许多更简单的部分.第一步是确保这个函数的分子的次数小于分母. 如果不是这样,我们需要先做一个多项式的除法. 所以在下面这些例子中：

　和

第一例很容易, 因为很显然分子的次数小于分母的.但第二个例子不是那么容易了, 因为分子的次数同分母的是一样的(都是2).如果分子是三次或更高次, 那我们会有同样的麻烦.那样的话我们要做一个多项式的除法. 为此将其写为



　来看我们的例子



对于这道题的除法算式如下：



这个除法告诉我们商为5, 余数为x+2. 所以我们有



如果等式两边同时对x求积分, 我们有



现在我们能把这个积分分成两部分,并且对第一部分求积分, 我们看到原始的积分变为



这个新的积分的分子次数为1, 分母次数为2,这正是我们想要的结果. 现在我们准备好, 可以继续后续计算了.

接下来, 我们将要分解分母因式. 如果分母是一个二次函数,请检验它的判别式：像我们在1.6节中见过的那样, 如果判别式为负,你不能对它进行因式分解. 否则,你可以手动进行因式分解或使用二次公式. 如果分母是很复杂的,你不得不猜想一个根, 然后再用多项式的除法.

　在因式分解分母之后,下一步我们要写下的一些东西叫做“分部”.这是通过把分母的一个或更多的因式加到一起构成的, 它依据如下的规则：

1. 如果分母是线性因子(x+a), 那么这个分部有如下的形式：



2. 如果有一个线性因子的平方形式(x + a)2,那么我们的分部如下所示：



3. 如果有一个二项式的形式(x2 + ax + b),这时分部的形式如下所示：



这些都是很常见的例子. 这儿也有一些不常见的例子.

4. 如果有一个线性的三次方的形式(x+a)3, 那么这时分部类似于：



5. 如果得到的是一个线性的四次方, 那么分部有如下的形式：



　注意：分部仅仅是由分母决定的,这同分子是没有关系的！并且当我们使用常数A、B、C、D时,记住你不能在不同的表达式里重复使用这些字母.所以你需要使用字母表中后续的字母. 在我们刚才的例子



中, 分母是(x + 1)(x - 1);所以我们有两个线性因子, 分部为：



我们不能使用A两次, 所以我们在第二项使用B. 顺便说一下,如果你使用字母C1、C2、C3或其他字母,而不是使用A、B、C等字母, 那么你在玩火自焚.如果这样做你经常会犯一些不经意的错误,除非你能注意到这些字母下脚标的不同.

这里还有另一个例子. 下面这种形式会是怎样呢？



答案是



你可能会以不同的顺序写下这些项,或交换从A到H这些字母的顺序; 这都可以.

　一旦你写下这种形式, 你也应该写下被积函数等于这种形式,然后再使用等式两端同时乘以分母的方法. 例如, 我们发现这种形式的积分



可以写为



所以我们有



实际上你最好把等式左侧的分式写为：



现在等式两侧同时乘以分母可得



注意对于等式右侧的第一项我们消掉了(x-1)因子,对于第二项我们削掉了(x+1)因子. 无论如何,现在我们有两个方法可以继续. 第一个方法是替代x. 如果你设置x=1,这时B(x-1)这项就消失了, 这时我们有



也就是说.现在如果你把x=-1代入原始方程, 那么A(x+1)这项将会消失：



所以. 另一个求解A和B的方法,是提取我们的原始方程, 并把它重写为



现在通过x的系数相等可得1=A+B.通过常数项相等可得2=A-B. 同时解这两个方程, 我们可得,同刚才的答案是一样的.

你可能已经注意到, 我们计算A和B的这两个方法都需要两个条件.对于替代法我们把x=1和x=-1分别代入; 然而对于系数相等的方法,我们让x的系数相等, 也让常数项相等.我们可以选择其中的任意一种方法. 例如,如果代入x=1你会发现;如果取x的系数相等, 你会发现1=A+B, 所以.在通常情况下, 有多少个常数需要求出,就有多少次需要应用刚才的某种方法, 或者你也可以两个方法混着使用.

我们剩下的工作是重写积分表达式(用分部的形式),但这次需要把常数项加进去. 所以我们的例子为



现在对等式两端同时积分, 并把常数项移到等式的外边可得



我们已经成功的把原始的复杂的积分化成了两个很简单的积分.我们会很快求解这两个积分的.

到目前为止, 我们看到除非分子的次数小于分母的次数,否则我们都要做一个多项式的除法; 然后对分母进行因式分解;再写下它的每一个分部;这时再使用上述两个方法中的一个计算这些未知的常数.最后我们写下这些积分的各个部分.我们将在18.3.3节中看到另一个解决这类问题的例子. 与此同时,让我们做一些积分.





18.3.2　对每一部分积分


我们需要知道在把原始积分分成小部分后怎样求解每一部分的积分.简单的积分形式是



　为此,我们可以设置t=ax+b. 例如, 在上一节的最后, 我们看到



对于第一个积分表达式可以通过设置t=x-1求解,而第二个可设置t=x+1. 在这两种情况下dt=dx, 所以很容易得到



　还有另一个例子：求解



我们设置t=4x+5所以有dt=4dx;这时我们的积分转移到了以t为变量的状态,这个积分变为,它的结果为. 最后再用x替代t,上述的积分结果为.

　对于分母是线性因子的幂的形式, 这种方法也是适用的; 例如, 计算



我们可以再一次的用t=4x+5换元.这样这个积分变为, 它的积分结果为;再换回到以x为变量的状态, 这样我们就证明了



当分母是一个二次函数时, 情况就会变得很复杂, 像这样：



请注意！如果分母可以被因式分解,那么就转化为第一种情况. 下面是我们从前的一个例子：



我们把分母因式分解为(x-1)(x+1);这样我们可得两个被积函数的分母为线性的积分.所以如果是这种情况我们就没有必要对分母为二次函数的被积函数求积分.即使是上一个例子, 它的分母为(4x + 5)2,我们也没有必要对二次函数求积分, 因为它是线性函数的平方.

　还有什么情况没有考虑到？可能情况是分母的二次函数不能被因式分解.也就是说它的判别式b2 - 4ac为负. 这类积分的一个例子是



它的分母是二次函数并且它的判别式为62 -4×(13), 它的结果为负. 因为这个分母不能被因式分解,所以对于这道题我们不能使用刚才的代数运算方法.我们没有必要去使用任何分部; 我们所要计算的就是求这个积分.这是做法：把分母写成平方的形式, 然后再换元.(参照1.6节对于配方的讲解.) 在这个例子中让我们完成配方：



所以我们有



现在换元t=x+3,所以我们有x=t-3并且dx=dt：



第二步是把这个积分分成两个积分,并把常数5移到积分符号的外边, 所以上述积分变为



第一个积分就像18.1节末尾的那个例子. 分母分子同时乘以2,我们可以发现分母的导数恰恰为分子,所以我们得到了一个以分母为对数的结果：



实际上,因为t2 + 4一直为正, 我们可以把绝对值符号去掉.现在开始计算第二个积分, 它是



仅仅需要记住这个有用的公式：



　(你应该通过对等式的右侧求导证明这个结果,或对等式左边进行换元t=au.)无论如何, 当a=2时, 这个公式为



所以, 我们的积分结果为



现在用x+3替代t, 得到最后的结果为



(x + 3)2 +4这个表达式可以被化简为x2 + 6x + 13, 这正是我们最初的分母.实际上没有必要展开它——仅仅回到我们配方的地方你就会发现需要的方程了.所以, 我们最终证明了：



　如果分母的二次函数最高项的系数不是1,我建议你在配方之前把这个系数提出去. 所以, 计算



我们把2提出来, 可以把这个积分表达式写为



这同我们以前的积分是一样的,只是在积分符号外边放置1/2, 所以它的结果为



现在, 让我们总结部分分式法, 然后看一个更完整的例子.





18.3.3　方法和一个完整的例子


这是一个关于有理函数积分的完整方法.

第一步——先看分子分母最高项的次数, 如果必要请做除法.查看分子的次数是否小于分母次数. 如果是,这时你很运气——直接进入第二步; 如果不是,就要做一个多项式的除法了, 然后再进入第二步.

第二步——对分母进行因式分解. 使用二次公式,或猜想一个根然后再做除法, 以便因式分解被积函数的分母.

第三步——分部. 像之前描述的那样,分别写出带有未知常数的“分部”. 写下一个像这样的等式：

被积函数=分部

第四步——计算常数的值. 把方程的两边同时乘以分母,这时通过任一方法计算常数的值：(a) 换掉x的值; (b)系数相等法;或者(a)和(b)两个方法结合使用.现在你能用几个有理函数的和去表达这个被积函数,这些有理函数可能是分子为常数分母为线性函数的幂的形式,或分子为线性函数分母为一个二次函数.

第五步——对分母的线性项次幂求积分.求解分母是线性函数次幂的积分;答案将会是对数形式或该线性项的负次幂.

第六步——对分母是二次函数的项求积分.对于分母是二次函数的不能因式分解的被积函数求积分, 先配方,然后换元, 这时再把它尽可能分解为两个积分.前者将会是关于对数的积分, 而第二个是关于正切函数的反函数.如果仅仅有一个积分, 它可能是对数形式又可能是正切函数的反函数形式.这个公式通常是非常实用的：





记住你不需要使用完全的六步. 有时你能直接跳到最后一步,来看我们上一节的例子：



　在此还有一个很复杂的例子, 它用到了这六步的所有步骤：



下面详细介绍怎样应用上述方法解决这个问题.

第一步——检查最高项的次数, 必要时要做除法.在上面的积分表达式中分子最高次数为5, 但分母最高次数为4.很讨厌——我们要做多项式的除法了：



检查细节！无论如何, 我们已经看到



现在对两边同时求积分可得



等式右侧前两项的积分很容易求：它们的积分结果分别为(我们将在最后的结果中+C). 所以现在我们要求解这个积分：



现在分子的次数仅仅为2, 这个数低于分母的次数4.我们准备好进入下一步了.

第二步——对分母进行因式分解. 在分母中我们有一个四次项,但很显然我们可以把x2提出来. 所以我们把分母因式分解为



这个二次项x2 - 5x + 9的判别式为( - 5)2 - 4×(9)= - 11; 因为它是负的, 所以这个二项式不能被因式分解.我们已经完成了第二步.

第三步——分部. 我们已经有两个因子x2和x2 - 5x + 9.不要把第一个因子x2看做二次函数; 相反把它看作一个线性函数的平方.为了证明这个观点它可以被写为(x - 0)2. 所以x2该因子可以被写为



另外, x2 - 5x + 9这个因子可以被写为



放在一起, 我们有



第四步——计算出常数的值.现在我们不得不求常数A、B、C、D的值.首先我们把上述等式的两边同时乘以分母x2(x2 - 5x + 9)得到



注意,出现在等式右边每一项的分母部分恰恰没有出现在该项所对应的分部里.例如, 当你用x2(x2 - 5x + 9)乘以B/x时,约掉了一个x得到Bx(x2 - 5x + 9).

让我们用一个值替代上述等式的x. 要消除这个方程,唯一的x值是x=0. 如果我们把x=0代入上述等式, 则



所以马上我们就知道A=2.我们仍然需要求解另外三个常数的值,所以我们最好找到这些x幂项所对应的系数. 让我们从扩展上述方程开始,再把x的不同次幂合并可得：



现在我们能把x3、x2、x的系数分别写出：

x3的系数：0 = B + C

　 　 x2的系数：8 = A - 5B + D

　 　 　x1的系数：- 19 = - 5A + 9B.

注意x3的系数在等式的左侧为0, 因为等式左边的8x2 -19x + 18并没有x3项. (顺便说一下, 如果你用系数的方法,可得到18=9A, 这同我们把x=0代入得到的结果是一样的.你能说出为什么这样吗？)

无论怎样, 我们得到一些方程去求解;从最后一个开始然后把A=2从后向前代入, 很容易就可得到B = - 1,D =1,C = 1. 把这些值代入第三步的最后一个表达式中有



这也就是说



这样我们把一个很复杂的积分化简成了三个简单的积分.让我们分别对它们求积分.

第五步——对分母的线性次幂求积分. 前两个积分是很容易求的：



所以这道题的第五步真的不是很麻烦. 很不走运,第六步却很繁琐……

第六步——对于分母是二次函数的被积函数求积分.我们需要计算第三个积分, 它是



通过配方可得：



现在让我们重写积分表达式, 使用配方的劳动果实可得：



我们能用做换元. 的确,这时且, 所以这个积分变为



这里以t为变量. 现在把它分成两个积分：

　和

先计算这两个积分中的第一个, 分子分母同时乘以2可得



再一次提醒, 这个绝对值符号不是必要的, 因为一定为正. 为把它换回以x为变量的状态,我们需要用替代t：



不要把这个乘法算式展开——仅仅看看上一页我们标记为(**)的方程,当时我们正在配方,我们可知这个结果可以化简为. 这样我们完成了这个积分的第一部分.

我们仍然需要考虑第二部分, 即



让我们使用公式



其中, 事实上等于：



现在把再次代入可得



最后两个积分给出了我们第六步的最终答案：



猜想我们将要做什么？我们正准备把得到的所有结果放到一起！前4步中我们得到



这是完全的分式分解形式.现在再用第五步和第六步计算这个积分, 上述的积分结果为



　我们终于完成了这个复杂的例子. 它确实是很复杂的,但是如果你能解答这么难的问题, 那么对于简单的问题你就迎刃而解了.作为一个练习, 看你明天是否能独立做出这道题目.





