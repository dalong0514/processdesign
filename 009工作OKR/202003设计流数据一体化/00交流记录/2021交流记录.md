## 20210423方全利交流

1、工艺专业提的条件也变成一个 excel 表，把以前设备条件里需要的数据都放进去。

2、储罐加一个设备类型属性。容器类：1）平底平盖。2）立式平盖椭封，圆钢支腿。3）立式双椭封，角钢支腿或圆钢支腿。4）带搅拌器的立式双椭封，角钢支腿或圆钢支腿。5）带夹套的立式双椭封，角钢支腿或圆钢支腿。6）立式双椭封，挂耳。7）卧式双椭封，鞍座。8）大型储罐，有加热器和无加热器。

### 记录

1、不能从上游专业的直接提取的数据，给一个默认值，并且用橙色高亮显示。

还是空着比较好，直接给个默认值弄着弄着可能会弄混淆掉，工程图的问题倒不大，毕竟工程图跟施工图还是有一定差距的。或者给个默认值也行，不过要用另外一个颜色标记区分出来（比如橙色）。上游过来的也有一个颜色高亮，比如绿色。这样工程图，我要审核的数据也就那些橙色的数据。

其实我们有一个 BGCAD 的，我们一直没用它，其实它的成图是很快的，不过它里面的图形不咋样。

2、工艺过来的数据是需要核的（比如法兰）。

因为我们之前模式，即使你们工艺专业校审核之后给了我们，我们也是需要去核的。比如说你这个法兰等级的问题，有些人可能会填错的。比如是 PN16 的法兰，它是一个公称压力，如果材料是不锈钢的，其实其实际使用温度是比较低的，有时这里工艺人员会错的（核的时候根据工作温度来核对）。比如现在 200℃ 的温度，它的最大允许使用压力随着温度的升高降的很快的，比如不锈钢的 200 ℃ 只有 10.2 公斤，现在它的设计压力可能有 12 公斤，已经超过 10.2 了，那么你工艺提过来的「条件」就是错的了。

我们设备专业是拿着条件去核这种问题的。实际上也是可以简单去判断的，你看看温度比较高的，已经接近了的，就要注意了，错的地方容易在这里。我们可以根据一些限制条件，进行一个初步的筛选，把有可能错的数据用一种颜色表示出来。那么可以把绿皮书法兰的数据（最大允许工作压力）、材料的数据都做进数据库里。

刚刚演示的是规范「HGT20592」的法兰数据，那么把 615 的数据也做进去。

3、其他类型的要复杂很多。

目前这个只是最简单的立式支腿储罐，其他类型的设备要复杂很多，规则也更多。

4、需要在用的过程中不断提问题，很多东西现在考虑不好的。

5、筒体壁厚和封头壁厚的计算。

之前自动画图时，多次出现的数值 25，是封头的直边高度。设备专业的计算软件是针对施工图的，里面可以算的东西很多。但其实对于工程图，我要的就是壁厚，筒体和封头的壁厚计算，也就 2 个公式。这两个公式可以当算法做进去，只能算内压容器。

2 个壁厚有可能会一样的，但常规封头的壁厚比筒体的壁厚更厚一点。举例：`EHA 700x8(7.1)`，这里的 7.1 是成型后的厚度，8mm 的钢板，是要去冲压的，冲压后它是要变薄的，冲压后最小的厚度是 7.1。

计算公式最后再嵌入，作为改进项，目前先自己填。

6、介质密度是绝的密度而非相对密度。

7、材料表格也拎出来。

按设备类型来划分，储罐一个材料数据表、换热器一个、塔器一个等等。

8、管口定位。

那么管口应该要加几个属性（工艺条件 excel 表）。1）顶部、底部、筒体侧。2）侧面定位，离上面焊缝线或切线的距离。

储罐顶部管口的位置最好做在 0.8D 之内。管口的定位数据，也要做成人工干预的数据，橙色高亮。有时不能简单的用 0.8D 来套，比如 DN700 的储罐，有 3 个比较大的管口放在上面，你罐顶中间一般放一个手孔的，这种放置，你管子做的做不了的。

管口的定位规则需要好好商量。一般情况下：1）直径大的，我会稍微往中间靠一些。直径小的（比如 DN500-600），上面管子多的话，我管口肯定尽量往边缘排，小的往中间靠管子一多肯定会碰到。

9、支撑的数据。

支撑的数据单独一个数据表，数据按类比去划分。

图形数据可以直接用 HGCAD 里的图形。

NB/T 47065.1 - 2018 鞍式支座

NB/T 47065.2 - 2018 腿式支座

NB/T 47065.3 - 2018 耳式支座

NB/T 47065.4 - 2018 支撑式支座

10、设备重量数据。

重量也单独拉一张数据表出来。重量（净重量）这一块的工作量蛮大的。重量主要是筒体和封头，还有支座、法兰接管，一项一项把它提取出来。封头有标准的，把直径、厚度、直边高度、材质密度输进去后，封头的重量就出来了。筒体一个公式马上也出来了。另外就是接管法兰，也串进去，多少的接管多少的法兰。还是就是支座。所有的组件，重量全部加起来。

1『封头的标准，HGCAD 里可以看到，比如 EHA、EHB、THA、THB 等，而且它已经做好了自动计算内表面、外表面积、容积和重量。（2021-04-28）』

做重量的时候，把不锈钢的单独拎出来。这样可以统计出不锈钢部件的重量了。比如不锈钢设备，其他都是不锈钢的，支座除了垫板以外其他都是碳钢的。那么这个设备总重是多少、不锈钢的是多少、碳钢的是多少，全部可以出来了。

净重量出来以后，操作重量和充水重量也就出来了。净重是纯粹钢的重量，操作重量是正常操作时的重量，包括物料（充装系数 x 容积 x 密度）、保温材料。充水重量，也可以把保温给放进去。

11、全容积数据。

计算公式很简单的。封头是有标准的，多少直径，标准封头容积是多少的。2 个封头的容积加一个筒体的容积，全容积就出来了。算重量的时候这个全容积要用到的。

12、试验、检测、热处理数据。

试验数据放到前面的「主要数据表」里，顺便按我们的习惯调一下我们数据的顺序。

位号、直径、高度、全容积、筒体壁厚、封头壁厚、设计使用年限、工作压力、设计压力、工作温度、设计温度、工作介质、介质特性、介质密码、腐蚀裕量、焊缝接头系数、装量系数、安全阀整定压力、最高允许工作压力、水试验压力、气密性试验压力、筒体检测率、封头检测率、CD 类焊缝、热处理、保温材料、设备净重、其中不锈钢重量、设备操作重量、设备充水重。

无损检测数据，比如筒体，只要填一个检测率，其他数据（等级技术、检测标准、合格级别）都可以匹配出来。

## 20210501与谢雨东交流洁净空调

1、散热散湿计算，增加了「人」的散热散湿。

原来做全面通风的时候只考虑设备，这里给我的感觉，「人」反而是散热散湿的大头。

2、压入压出目前的算法是直接给定的。

压入压出跟建筑有关系的。门的大小，有个数据。比如一更和二更之间有 5Pa/10Pa 的压力，单扇门。单扇门在 5Pa 压差的情况下，门缝里会压入压出一定风量的，这就这里的压入压出风量。只要给压出、门的个数、门的大小，是可以获取压入压出风量这个数据的。

目前的做法是偷懒不算的，反正整个系统是平衡的，无非是从这个房间到那个房间。以后是要算的。先打通逻辑的时候接口预留，都按压入压出风量都按 0 考虑。差异体现在单个房间的补风量，比如本来这个房间的压出风量大一些，那么补风就稍微多补一些，但总的「量」是不变的。对流程图来说，单个房间就少了这块内容，压入压出的风量。

3、正压风量只能室压、房间体积有关系。

正压风量是保证这个房间的正压，是把「风」压到吊顶里去的风量，一个小的风量，是压到外面去的。

4、冬天的风量是反算的，只要是算夏天的风量。

先给定一个夏季的温差，比如 4℃。相对来说，冷负荷比热负荷要大，一般情况都是这样的，所以可以用反算的方式。

首先，先算夏季负荷风量。先通过夏季余热、夏季送风温差（4℃）算出夏季负荷风量。

夏季负荷风量（计算输入参数：夏季余热、夏季送风温差，冬季负荷风量同夏季相同）

接着按换气次数算出一个风量。比如这个房间，要求最低换气次数是 20 次，按这个算出一个风量。夏季负荷风量和换气次数风量会有一个对比，先按整个系统的，这两个风量数据来对比，越接近越好。如果误差在 10% 以内，那么不用调送风温差这个数据（4℃），如果误差超了，调到 3.5 或 4.5，如果达标了算是系统复核好了。接着去核对单个房间的 2 个风量，两个风量系统控在 20% 以内，以内的话达标，超了的话通过调整换气次数来使之达标。

谢：有个毛病。所有送风温差是一样的，因为风是从一个地方来的，所以要先根据所有房间是一样的来算负荷的量，比如开始都按 4℃。有些房间按 4 来算多了，有些房间按 4 来算不够，这里就有一个偏差。偏差不大无所谓，偏差很多的话就需要干预了。干预的方式比较多了，第一个是调换气次数，第二个是调送风温差，但掉送风温差的话我的整个系统就变了，我可能末端要加「标准器」了，这是比较大的改动（不推荐）。所以我们都是调换气次数的。因为换气次数本来就是可以调的。但是送风温差也要保持到可修改的状态，因为有可能换气次数调不过来。

最后再反算冬季送风温差。只要看一下结果，但有可能会有很「夸张」的情况，这时候就要干预了。换气量有了（冬季负荷风量同夏季相同），热量有了，反过来算温差即可。为啥冬季负荷风量同夏季相同？整个系统的风量一年四季肯定是一样的，因为夏天需要的风量肯定比冬天大，我们以大的为准。

夏季送风温差（可干预；夏季负荷风量、与最小换气次数的风量对比，先系统对比，10% 以内达标（不达标调送风温差）。每个房间 20% 误差达标，不达标调换气次数）

5、送风风量的确定。

实际送风风量，取夏季负荷风量和最小换气次数的风量的较大值。实际送风量出来后，实际换气次数也就出来了。

备注：夏季送风温差 4℃ 是一个经验数据，我们这么多年算下来比较考虑的一个初始值。注意，算出来的夏季负荷风量要要永远比最小换气次数算出来的小，大的话也要把换气次数调大。

1『待确认：既然算出来的夏季负荷风量要要永远比最小换气次数算出来的小，那为啥 Excel 表里，算实际送风量要用 if 语句，直接取最小换气次数的风量不就行了。回复：有些明白了，Excel 里的最小换气次数只是个初始值 20 次，有可能有些房间的散热量比较，算出来的夏季负荷风量比较大，那么就得调大换气次数。原来自己的想法换个说法就正确了，「直接取调整后的换气次数的风量不就行了」。此时又引发一个疑惑，复核单个房间的时候，算出来的夏季负荷风量如果比最小换气次数小 20% 以上，咋调？换气次数又不能改小。』

送风量（计算输入参数：房间体积、最小换气次数、夏季负荷风量）

6、排风量和回风量的确定。

送风量有了。如果房间是防爆区的，全排，排风量等于送风量。

```
回风量 = 送风量 - 正压风量 - (压出风量 - 压入风量)
```

目前粗糙算法，压出风量 - 压入风量 = 0，只需要管正压风量即可。

有些房间，项目里要统一的（比如专业负责人定掉），比如清洗间、洗涤间，有粉尘要排的，工艺专业要专门提的。所以是否要全排的逻辑：防爆、专业负责人定的项目统一要排（暖通专业负责人）、工艺专业提的条件里要排，只要命中一个即全排。

对于非防爆区的排风，大部分情况下是百分百全排掉的。也有特殊情况，可能只排 50%，这就是要靠工艺条件或暖通专业负责人数据的输入了。

1『上面的信息跟之前做叶酸车间提暖通排风条件关联上了，非防爆区域的的房间，哪些要做排风的，需要在条件里单独提出来的。（2021-05-11）』

排了多少，剩下的就是回风量了。

回风量（计算输入参数：压入风量、压出风量、正压风量）

7、送风口的数量确定。

可以给一个数据，跟房间面积相关，比如 10 平方的房间，先默认一个。Excel 的风口编号即对应于风口的大小，一个编号一个尺寸风口，跟图纸上是对应上的。对所有房间，所有送风口的规格是一样的。400 风量之下的用 S-1 的送风口，400-800 风量之间的用 S-2。

送风口所有厂家是一样的，但回风口、排风口是跟厂家有关系的，目前做了 3-4 种规格的，以后可能会更多。

8、下面的计算书。

是算制冷量的，跟前面所有说计算过程的没关系的。输入数据是上面算出的送风量、排风量、回风量。

一个是数据库里气象参数数据、一个是室内的实际的需求，一个是室内和室外混合后的数据（根据新风比例，新风比例即上面 3 个风量得到的，送风减掉回风就新风）。算完混合数据即可得到焓值数据，那么就可以算出冷量。从风量算制冷量就差一个焓值，所以前面要算焓值。冷量出来后，水管多大的、冷冻系统多大的、设备多大的就有了。

最终要算的就两个数据，一个是风量一个是冷量，这两个数据就是公用工程量。冷量的数据会体现在 PID 里的，水管、阀门那块，还有一个设备表。

混合点算完后，我们是有个露点的，露点目前是给定的。再热一个量，再热就浪费了（如何理解？以后可以咨询下谢）。下面这个计算书要的是 4 个结果。

## 20210519与李奕峥交流泄爆和安全疏散

### 后续要求

1、砖墙和泄爆墙分层来画。

2、确认一下可以泄压的地方：泄压墙、轻质墙、窗户、门。扣掉：柱子宽度、普通砖墙、防火墙、防爆墙。

3、画几个封闭的区域，高度塞到属性里去。看看 PL 线的哪个属性可以塞。

4、为啥是去距离最大的 5 条疏散线画出来，这里的个数 5 是建筑专业规范要求的么？

### 泄压面积计算

有个泄压公式。

A = 10CV^$2/3$

A —— 泄压面积

V ——厂房容积

C —— 泄压表，详见《建规》的表 3.6.4，常规取 0.11（一般）和 0.25（氢气），取其他值的时候会特别注意。

首先要进行一个「长径比」判断，即「平面的最长边和横截面积周长的积 / 4 倍横截面积」。以 3.0 为分界。

如果小于等于 3.0，可以直接开始进行泄压面积的计算。如果大于 3.0，需要继续分割。常规情况的话会先考虑对半切。

算出来的「泄压面积」是我们所需要的泄压面积，实际的泄压面积要比这个大。

实际泄压面积的算法：建筑里，砖墙是单独画的，泄压墙比砖墙更「细」，目前我们是放在一个图层的。我们建筑的可以分层来画。哪些可以算泄压的呢？1）柱子的整个「面」不算，是实心的。2）泄压墙、轻质墙、窗户、门，算的。所有的长度加起来后，再乘以高度就获得了泄压面积。

现在回过头来看分割成 2 个区的计算方法：比如分成了 A 区、B 区，还是套上面的泄压公式来来算，算出来 2 个值，比如 a 和 b，只要 a+b 小于算出来的实际泄压面积即可。

自动分割算法：一跨一跨的来试着算，一跨一跨的移，循环的终止条件，割出来的两个区只要「长径比」同时小于 3.0 即退出循环。

基本割 2 个分区是可以满足：2 个长径比都小于 3.0 的。因为工艺布方案的时候，我们会提前打招呼，不要弄的「径深」特别大的才会分割成 3 个区。

层高要把梁扣掉。框防爆区域的时候直接把高度填到「框」的属性里去，看看 PL 线的哪个属性可以塞。

成果：建筑底部下面的「泄爆分区泄压面积计算」，包括图、轴线号、以及文字。

弄泄压面积对我们建筑来说很费时间的。

### 疏散距离自动计算

疏散距离常规来说分为工业和民用两种。工业的是到室内任意一点，民用的话是从疏散门开始算距离。

先说民用：是从疏散门开始算距离，但是，它从里面到疏散门也有个最远距离，它是分两段的。里面的，室内最远点离门的距离，它是有个要求的。然后，门到楼梯有个距离。加起来才是真正的疏散距离。

按矩形区域框考虑，先定位到「门」，看这个「门」在矩形的哪一条「边」上，那么室内最远距离势必在此「矩形」另外一条边的「角点」处。

改进算法：1）先把所有的门筛选出来。2）接着识别离楼梯那边的最近的一个「门」，几个楼梯几个「门」，此门为「疏散门」。接着看剔除掉「疏散门」剩余的那些门。3）现在要的是这些「普通门」到「疏散门」的「避开墙距离」。

两个门之前的直线，如果不与墙相交，那么满足条件。如果相交，那么定位到与之相交的「墙」。「墙」两端的「端点」，如果是水平方向的墙，取里离「疏散门」距离最近的端点，如果是垂直方向的墙，取离「普通门」距离最近的点。确定端点后，「画」端点到「疏散门」的「距离直线」，按上面同样的逻辑走。直到避开所有的「墙」。

改进的算法：

两个门之前的直线，如果不与墙相交，那么满足条件。如果相交，那么定位到与之相交的「墙」。墙」两端的「端点」，沿着墙延伸各「移」10 公分作为 2 个虚拟的点，这两个点跟起点「普通门」的连线，只要与墙相交的「个数」比上一次的少，那么此方向的「端点」即为想要的。

工业的是算到室内最远点。先把一楼对外的门筛出来，建筑画个外框，在外框上的门的即为「疏散门」。

常规自己人工的做法：感觉哪几个点可能是离这个门最远，那么先把这个距离标出来，可能有 4-5 个点。先找到点再把距离先标出来。

1、先把所有的房间识别出来。

2、每个房间里有个门的，房间里离房间这个门的最远距离是可以判断出来的。

比如有 4 个「疏散门」，那么最终要找 4 个离这 4 个疏散门最远的「点」。现在有 20 个房间，每个房间里有离本房间门最远的点，那么有 20 个点。最终要的 4 个点肯定是在这 20 个之中。一个房间一个房间的来看，房间里最远的点 A 找到了，A 到 4 个疏散口的距离分别量出来，取最近的那个疏散口（疏散距离肯定是走最近的），画出一个「虚拟的疏散路线」。第二个房间同理，画出第二条虚拟的疏散路线，同理最终可得到 20 条虚拟的疏散路线。20 条疏散线，取距离最大的 5 条疏散线，真实的画出来。