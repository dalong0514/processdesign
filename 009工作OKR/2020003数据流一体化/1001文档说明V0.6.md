## 01. 使用说明
<hr>

192.168.1.38:8081/Images

### 1.1 cad 操作相关

1、存放插件。将压缩包「dataflowcad.rar」解压到 D 盘，解压后的文件夹一定要放在 D 盘下，因为有些文件路径在插件里是写死的。

2、加载插件。输入命令「menuload」，点击「浏览」按钮，选中插件文件夹中的文件「dataflow.cuix」，接着点击「加载」按钮。

![](http://qgdaqmbg0.hd-bkt.clouddn.com/V0.6-1.png)

![](http://qgdaqmbg0.hd-bkt.clouddn.com/V0.6-2.png)

3、设置插件。1）输入命令「cui」，点击左上角的「所有自定义文件」，选中刚刚加载的文件「dataflow.cuix」。2）右键「LISP 文件」，点击「加载 LISP」，加载插件文件夹下的最新 LISP 文件，比如本次更新的 V0.6 版 lisp 插件为「20200921dataflow-v0.6.lsp」。备注：以后更新新插件时，只需在这里将老版 lisp 插件卸载，重新加载新版插件即可。

![](http://qgdaqmbg0.hd-bkt.clouddn.com/V0.6-3.png)

![](http://qgdaqmbg0.hd-bkt.clouddn.com/V0.6-4.png)

4、使用插件。1）加载插件后，CAD 顶部菜单栏会出现「数据流」菜单，点开即可使用各个模块的提取数据功能。2）点击各提取功能后会弹出输入文件名的弹窗，命令数据文件的名称后点击「导出数据」即可。导出的数据文件自动保存在 CAD 图纸所在的文件夹下。

![](http://qgdaqmbg0.hd-bkt.clouddn.com/V0.6-5.png)

![](http://qgdaqmbg0.hd-bkt.clouddn.com/V0.6-6.png)

### 1.2 网页软件相关

内网地址：192.168.1.38；外网地址：wukong.hg101.vip。

登录后，进入各模块，上传从 CAD 导出的 txt 文件，看到「上传成功」弹窗后点击各个「导出」按钮。

## 02. 注意事项
<hr>

1、管道数据表、外管条件必须配套相应的材料等级表。

管道数据表只有使用配套的等级号，压力等级、吹洗介质、无损检测比例、检测合格等级、泄露性试验介质、压力，这几个数据后台可以自动根据相关逻辑判断填充，否则只能在导出的数据表内自行修改。做外管条件表时同理。

配套的材料等级表详见之前发给大家的邮件，或者直接从我这边获取。

## 03. 技巧汇总
<hr>
 
1、保留老版流程图数据的前提下，使用新版的属性块。

目前验证过最保险的办法：1）将老版图纸整体拷进新版属性块模板（附件）里。2）命令「BATTMAN」进入块属性管理器。2）选中新版更新后的块，点击右上角的「同步」按钮。完成上面 3 步后你流程图里的老块会自动更新为新版块，同时老版里的数据都在。最后用新版插件自动提取相关数据即可。
 
2、管道号的箭头翻转。（贡献者徐骋、蔡翠平）
 
管道块的箭头，已经做成了可翻转块，单击一下小箭头可翻转。
 
3、批量增加图号。（贡献者徐骋）
 
仪表块和管道块是可以批量增加图号的。以仪表块为例，在 CAD 图层里关闭除了「仪表编号」的其他图层，选中该张图纸的所有仪表块，进入「特性面板」后把图号填进去。
 
4、批量修改块内的属性值。（贡献者徐骋）
 
批量选中自己想要修改的块后，find 快捷键进入查找替换面板，勾选「取消隐藏」属性后，可以批量修改替换块属性的值。

## 04. 更新内容记录
<hr>

### V0.5 版更新内容

**总体相关：**

1、新增用户系统。

每个人的账号为自己公司的邮箱名，密码默认为：tz123。账户密码修改系统下一个版本会更新。

2、各模块界面更新。

3、新增文档说明页面。

软件的使用说明、各个版本的更新内容、bug 修复情况等信息都会放在这个页面里。

**管道数据表相关：**

1、保温材料空值关联已有数据（贡献者徐骋）。

有保温符号的管道，保温材料信息，后台可以自动关联已填有的数据。比如 200℃ 以下的保温（符号 H、岩棉制品），200℃ 以上的（符号 H、硅酸铝），保冷（符号 C、聚氨酯），防烫（符号 P、岩棉制品）等。每个类型的，图纸里只要有一个数据填好了，其他的可以不填。

**仪表条件相关：**

1、新增控制阀条件表。开关阀和控制阀的信息放在控制阀条件表内。

2、仪表属性块增加「备注」字段。（贡献者张堃、孙伟昌、徐骋）

备注信息如：保温厚度、开关阀的气开气关、联锁逻辑等，这个属性字段的信息会自动填充到条件表里的备注栏中。

**设备一览表相关：**

1、自定义设备块的参数，如果为空值就不填充。

之前自定义块中，4 个自定义参数默认写的是「xx」，空值的话设备一览表的那一栏不会再填充，省得导出的表里要自己手动删除。

### V0.4 版更新内容
 
**管道数据表相关：**
 
1、新增管道数据表模块。
 
抽出来的管道数据，在设计流数据一体化平台上可以导出 2 个文件，一个是我们的成品管道数据表，一个是做管段表用的数据源（可导入公司做管段表的软件里用于统计材料）。
 
特别强调的是：管道等级号必须使用配套的材料等级表（附件）。只有使用配套的等级号，压力等级、吹洗介质、无损检测比例、检测合格等级、泄露性试验介质、压力，这几个数据后台可以自动根据相关逻辑判断填充，否则只能在导出的数据表内自行修改。
 
另：如果你项目里用到的物质在配套等级表里找不到相应的等级号，请与我联系。
 
**仪表条件相关：**
 
1、仪表数据与管道块、设备块数据关联。（贡献者冯大龙、顾川川、徐骋、蒋万忠）
 
仪表块、管道块和设备块内有相同的数据可以共用，减少重复输入。这个想法包括我自己在内，有多位同事想到并给我提了建议，目前已实现。
 
仪表块的中工作介质、温度、压力、所在位置的材质、所在位置的规格尺寸，这 5 个属性数据的提取逻辑如下：1）先判断仪表块里该属性有没有填，填了的话直接提取该数值。2）没填的话，后台会根据仪表块里的管道编号或设备位号，自动关联到对应的管道块或设备块，提取相应的数据。
 
简单说，如果管道块和设备块那边已经有了这 5 个属性数据，仪表块里只要在「LOCATION」这个属性里填上管道编号或设备位号，那 5 个数据可以不填了。
 
2、仪表属性块增加型号字段（贡献者张堃）
 
远传仪表，例如液位计，有雷达，磁翻板，液位开关等多种类型，但是在流程图里只有 LI 一种表示方法。而实际过程中，有些位置是需要判断液位计类型的。流量计同理，楔形、质量、旋涡等，也都有特定使用工艺。仪表属性块增加种类这一项，既可以方便业主审核，也可方便工艺自查。
 
3、仪表属性块增加图号字段。
 
4、集中仪表块新增区域覆盖。（贡献者徐骋）
 
流量计放在管道多段线上可直接覆盖底部管道，方便位置拖拽。
 
**设备一览表相关：**
 
1、新增了一个「自定义」设备块。（贡献者张坤）
 
如果设备不属于反应釜、储罐、换热器、输送泵、真空泵、离心机，可以使用这个块。
 
2、定型设备新增工作介质、温度、压力。输送泵、真空泵、离心机也新增这些属性，便于与仪表块数据关联用。

### V0.3 版更新内容

1、新增外管条件（贡献者郑重、沈琦）。

已跟外管对接，接受附件里自动生成的 Excel 版的外管条件。有点着重说明，外管去向里必须包含「去」或者「自」这 2 个字符，后台是根据这 2 个字符判断起点或终点的。

使用数据流提外管条件，目前可以为你节省时间的地方：1）设计温度、设计压力自动计算；2）管道直径根据管道号信息自动提取。3）流速，根据流量及提取出的管径自动计算；4）管道材质根据管道编号信息自动填充；5）管道保温代号、厚度信息，根据管道编号自动提取。

### V0.2 版更新内容

1、上线电气条件。

CAD 里用命令 gselectric 提取数据，进入网页端工艺模块中的「To电气专业」。

2、设备块的备注信息缩小（贡献者陈李荔），这样信息多的时候不会显得太挤。

3、所有属性做成了移动（贡献者林俊），目前块里的属性都是可拖动的，比如集中仪表里，高低报警符号可以根据使用情况拖动到合适的位置。

4、非标设备块增加添加工作介质信息（贡献者顾川川），总师办之前发了文，目前因多数项目的非标设备不是本公司设计，制造图纸为甲供，因此技术规格不完整会造成实际加工的差错，甚至引起事故。故要求非标设备的技术规格栏中还应填写操作条件，即操作温度、操作压力、处理能力、介质名称等。

5、增加了离心机设备块、真空泵设备块（贡献者李恒）。

6、各个设备块根据常规经验新增了一些必要的关键参数信息。

## 05. bug 修复记录
<hr>

### V0.5 版 bug 修复
 
1、设备表的数据中工作介质字段 string 长度设置过小导致无法写入数据。（bug贡献者李恒）

### V0.4 版 bug 修复
 
1、储罐块的基点偏移问题。（bug贡献者张堃）
 
上一版本V0.3 中，储罐设备块的基点位置有误，已修复。
 
2、cad 内特殊字符 \U+00B 等，导致数据读取失败。（bug贡献者牟苏嫣、张坤）

<hr>

最后，使用过程中有任何问题可随时与我联系（手机号：15857183324，短号：663324。）


页边距的修改：
 
```css
/* 全局属性
 * 页边距 padding: 30px;
 * 全文字体 font-family: ptima-Regular;
 * 英文换行 word-break: break-all;
 */
#nice {
  letter-spacing: 0.05em;
  color:#595959;
  padding: 50px;
}
```
