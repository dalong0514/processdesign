# 化工工艺流程设计智能化出图系统软件 V1.0

概要设计说明书

## 目录

1.1	编写目的	3

1.2	背景	3

1.3	缩写、术语与解释	3

1.4	开发优先级定义	3

2	总体设计	4

2.1	系统描述	4

2.2	软件体系结构	4

2.3	功能模块描述	5

2.4	内部接口设计	6

2.5	外部接口设计	6

3	系统主体流程	6

4	各模块界面与实现	8

4.1	系统管理	8

4.2	权限管理	9

4.3	监控规则	9

4.4	日志管理	10

4.5	数据共享	10

4.6	用户登录	10

5	数据库结构设计	11

5.1	表汇总	11

5.2	功能表	11

6	系统错误处理设计	12

## 01 引言

### 1.1 编写目的

本文档是在软件系统需求规格说明书的基础上，对化工工艺流程设计智能化出图系统软件进行的概要设计，采用了「领域驱动设计」的方法论，对实现需求进行了各子域的设计。包括如何把该系统划分成若干个模块、决定各个模块之间的接口、模块之间传递的数据等。

软件工程师参考本文档进行详细设计。

系统测试工程师依据本文档进行系统集成测试和验收测试。

## 1.2 背景

系统名称：化工工艺流程设计智能化出图系统软件

任务提出者：浙江省天正设计工程有限公司

系统开发者：浙江省天正设计工程有限公司

系统用户：  浙江省天正设计工程有限公司

### 1.3 缩写、术语与解释

DCS	 —— DCS 是分散控制系统的英文缩写（Distributed Control System）

DDD——领域驱动开发——领域驱动设计是一种通过将实现连接到持续进化的模型来满足复杂需求的软件开发方法。

### 1.4 开发优先级定义

核心域（Core Domain），整个系统最重要的部分，是整个业务得以成功的关键。

支撑域（Supporting Subdomain），在核心域功能需求实现之后实现。

通用域（Generic Subdomain），不影响系统运行的功能，可以在后续实现。通用域的解决方案可以采购现成的，也可以采用外包的方式实现。

## 02 总体设计

### 2.1 系统描述

化工过程通常是由许多不同的工序组成，包括：存储、反应、蒸馏、吸附、萃取、干燥等工序。当前的化工设计，不同的人根据自己对各种工序及规范的理解，逐个工序进行设计，以致最后的成品或多或少存在差异，甚至不足。尤其是重点监管的危险化学品和重点监管的危险工艺，一旦设计有所偏差，将会给生命、财产、环境带来危险的隐患，基于此因素，国家对危险化学品和危险化学工艺进行了越来越严的管控。

本软件（种智能化出图系统），通过对以往设计项目的总结；把以往设计过的项目提供给模型训练；在模型完成后，对模型进行检验，确认模型对各种工序能够进行稳定的分析，从而实现化工工艺智能化的出图。核心内容包括：

1、现有工序大数据整理，自动清洗，聚类，提取关键特征，并入库存储。简历快速索引查找表。

2、构建海量数据检网络模型。以项目工艺施工安全系数为优化目标，训练模型。把以往设计过的项目提供给模型训练；在模型完成后，对模型进行检验，确认模型对各种工序能够进行稳定的分析。

3、化工工艺智能化出图系统友好的人机互动界面。

4、设计人员通过设计相关资料（包括：工序和反应介质的温度、压力、物性等参数）的输入，系统能够按要求准确出图。

### 开发环境

硬件：PC（Intel (R) Core (TM) I5-8265u CPU 1.60GHZ 1.80 GHZ 8.00GB）

操作系统：Windows7

开发工具：Visual Studio Code V1.51

开发语言：Autolisp、Python、PHP

开发平台：PC 软件平台

### 运行环境约定

硬件：赛扬 2.5G CPU/ 1024M RAM / 80G Disk

显示分辨率 1024*768 或以上配置

操作系统：Windows7

软件环境：.NET Framework 3.5

### 2.2 软件体系结构

化工工艺流程设计智能化出图系统软件，借鉴了传统的 Web 软件架构 MVC，新增了服务层（Service）用于实现机器学习。整个系统主要包括展示层、服务层、控制层和数据层。

1、展示层（View）：负责用户页面设计，不同业务有不同的页面。例如，登录界面、各具体功能交互界面、数据库查询页面、数据预览界面等。

2、服务层（Service）：负责具体业务逻辑的处理，也是领域对象的实现层。例如，提取数据、机器学习、自动出图等业务。

3、控制层（Controller）：负责联动展示层和服务层。

4、数据层（Model）：负责完成数据访问，如增删改查数据库中的数据、记录事件到日志文件等。完成数据的持久化，如关系型数据库 MySQL、缓存系统 Redis 等。

回到前面所说的三层架构，这是行业中最早普及的一种架构模式，最开始是 MVC，也就是 Model、View 和 Controller。MVC 的概念起源于 GUI （Graphical User Interface，图形用户界面）编程，人们希望将图形界面上展示的部分（View）与 UI 的数据模型（Model）分开，它们之间的联动由 Controller 负责。这个概念在 GUI 编程中是没有问题的，但也仅限于在与 UI 有交互的部分。很多人误以为这也适合服务端程序，他们就把模型部分误解成了数据库里的模型，甚至把它理解成数据库访问。于是，你会看到有人在 Controller 里访问数据库。

软件配置文件（仅描述一些重要的配置文件）描述：

UIManager.json——用于配置界面框架中各组成部分包含的元素，如菜单、工具栏及主界面。

ControllerManager.json——用于各领域模型间通信的接口。

DataShareManager.json——数据共享的对等控制配置。

### 2.3 功能模块描述

简要描述本系统中各主要模块的基本功能。

编号	模块名称	功能描述

1、系统管理。添加维护各子系统的通信配置，如 IP，端口，所支持的协议类型，重连配置等。

2、权限管理。针对不同的人员给予不同的权限功能，以及人员信息的维护管理。

3、监控规则。主要对生产工艺过程参数的控制与设置。浆料生产过程中，加热纯水温度控制在 50℃到 60℃的范围间，洗料过程严格进行料量的控制，滴加过程控制在 70℃到 72℃，随后的升温过程控制到 80℃到 85℃之间即可。保温时间为 1 小时后，加入助剂进行中和反应。

水性浆料生产过程中，在反应釜中加打底水，温度控制在 50℃到 60℃中，加入助剂的量由系统自动定量配比控制，加热温控在 75℃到 78℃之间，滴加单体料 1 小时后加入 M14，随后升温控制在 80℃到 85℃之间，保温 1 小时后，冷却至 50℃，加入水调节浓度含量，浓度检测系统自动控制加入阀。

4、日志管理。系统产生日志的查询功能。

5、数据共享。各子系统的数据流转共享规则配置管理。

6、用户登录。用户输入用户名，密码，是否记住密码等，只有完全输入正确方能使用本软件。

### 2.4 内部接口设计

模块名称	接口编号	接口描述

数据共享模块——IDataShareModule_1.1——各子系统数据共享对接规则设置接口。

### 2.5 外部接口设计

模块名称	接口编号	接口描述

自动出图模块——IPrintModule_1.1——自动生成 CAD 图形文件的接口。

## 03 系统主体流程

系统主要操作流程为： 启动软件，输入用户名密码登录，登录成功后，首次使用需要添加需要监视的子系统及相关信息，后连接各子系统控制中心，连接成功后，展示各子系统的工作运行状态信息，相关参数由各子系统控制中心主动实时发送，配置软件运行的相关系统参数，以及各子系统数据共享对接规则设置等，持续监控各子系统的运行状况，直到人工断开或子系统出现系统故障而停止，因网络环境造成的断开，分散控制系统支持自动重连断开的子系统控制中心。

浆料生产过程流程图如下所示：

水性胶生产流程图如下图所示：

4 各模块界面与实现

4.1 系统管理

系统管理主要包括对需要监视的子系统的相关信息的维护，包括控制中心的 IP，端口，支持的通讯协议类型等。

系统管理窗口

4.2 权限管理

权限管理包括部门，人员的信息的维护以及相关功能权限的授予功能等。

4.3 监控规则

主要对生产工艺过程参数的控制与设置。浆料生产过程中，加热纯水温度控制在 50℃到 60℃的范围间，洗料过程严格进行料量的控制，滴加过程控制在 70℃到 72℃，随后的升温过程控制到 80℃到 85℃之间即可。保温时间为 1 小时后，加入助剂进行中和反应。

水性浆料生产过程中，在反应釜中加打底水，温度控制在 50℃到 60℃中，加入助剂的量由系统自动定量配比控制，加热温控在 75℃到 78℃之间，滴加单体料 1 小时后加入 M14，随后升温控制在 80℃到 85℃之间，保温 1 小时后，冷却至 50℃，加入水调节浓度含量，浓度检测系统自动控制加入阀。

4.4 日志管理

日志管理包括各子系统上传信息的记录，系统运行日志的查询等

日志管理窗口

4.5 数据共享

数据共享主要包括各子系统需要交换数据及转换的规则设置等功能。

4.6 用户登录

用户登录包括输入用户名密码，是否记住密码等功能，都验证正确方能使用本软件。

用户登录窗口

5 数据库结构设计

5.1 表汇总

以一览表的方式给出本系统所使用的每个数据结构对应的数据表的分类汇总。

数据表名称	对应数据库表名（英文名）	数据表描述

系统表	T_System	对各子系统信息进行管理

权限表	T_Power	对功能权限进行管理

系统设置表	T_Config	系统参数设置管理

日志表	T_Log	记录操作日志与系统错误信息日志

5.2 功能表

系统表结构

字段名	中文描述	字段类型	默认值	是否主键	备注

ID	记录序号	int (11)	null	是

type	分类	varchar	null	否

name	资源名称	varchar	null	否

path	资源保存路径	varchar	null	否

creatTime	创建日期	datetime	now	否

……	……	……	……	……	


权限表结构

字段名	中文描述	字段类型	默认值	是否主键	备注

ID	记录序号	int (11)	null	是

name	菜单名称	varchar	null	否

parentId	上级菜单	int (11)	null	否

position	分布顺序	int	now	否

visable	是否显示	bool	true	否

……	……	……	……	……	


系统设置表结构

字段名	中文描述	字段类型	默认值	是否主键	备注

ID	记录序号	int (11)	null	是

name	参数名称	varchar	null	否

value	参数值	varchar	null	否

lastMotifyTime	最近修改时间	datatime	null	否

……	……	……	……	……	


日志表结构

字段名	中文描述	字段类型	默认值	是否主键	备注

ID	记录序号	int (11)	null	是

type	分类	varchar	null	否

logInfo	日志信息	varchar	null	否

creatTime	创建日期	datetime	now	否

……	……	……	……	……	


6 系统错误处理设计

可能的出错或故障情况出现时，系统输出信息的形式、含意及处理方法。

出错信息	输出形式	输出含义	处理方式

数据解析错误	日志记录，状态栏信息提示相应内容	异常捕捉	数据解析错误，提示具体出错原因，记录日志

系统运行中断	日志记录，状态栏信息提示相应内容	异常捕捉	跳出本次运行流程，等待下次运行。

其它错误	MessageBox 弹出对话框提示或状态信息提示及日志记录	提示用户终止程序或忽略错误，并将错误内容保存联系公司技术人员解决	其它错误

