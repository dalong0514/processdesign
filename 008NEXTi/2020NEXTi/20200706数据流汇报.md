# 数据流一体化汇报

### 目录——P0

01 Why——数据流一体化的目的和意义

02 What——数据流一体化的演示

03 How——数据流一体的实现

04 数据流一体化的优势以后续计划

### 未来设计模式猜想——P1

用户需求进来，工艺专业进行数据处理，分发到其他各个专业。各专业进行数据处理。我们要打造的数据一体化平台，是要封装各个专业间需要传递的数据、基础数据库、算法、逻辑。数据流对外可以生成设备、仪表等清单（这里为啥有流程图？）。

数据流一体化的意义体现在三个方面：数字化、高效率和高品质。我们先说数字化。

### 助力公司数字化工作——P2

数据流一体化是在给公司数字化工作添砖加瓦。它更侧重于设计人员具体作业的数据化，而且我们的数据都是很小的颗粒度进的数据库，颗粒度小应用场景就多了。

这里我以工艺专业为例。我们将流程图里块作为「数据容器」，作为一个数据输入源。1）设备块里的数据时为了完成设备一览表、电气条件用的；2）管道号块里的数据是为做管道特性表；3）仪表块里的数据时为了提仪表条件。4）外管块里的数据为了提外管条件。下面的是暖通全面通风所用的数据块。

我们将图纸里的块数据提取出来存进数据库，接着加载基础数据、加载业务逻辑算法，完成具体的设计作业。完成作业后产生的数据，一种是直接进数据库，作为下游专业的数据源；另一种是直接生成所需格式的成品，比如设备表、各个专业条件表。

### 高效和高品质——P3

接着说高效率和高品质。点一下鼠标。我们原来的作业里有很多痛点。点一下鼠标。主要体现在2 个方面：第一个是机械性、重复性的工作。比如各种计算里，比如各种计算里需要查基础数据的环节，计算里的一些固定算法；比如设备选型里要查样本的数据；比如条件表里的固定逻辑。第二点是存在误差即局限性，我们的作业不够精确。比如一些计算的不精确、条件传递时的误差、遗漏等。

现在数据流一体化可以帮我们解决这些痛点。我们通过封装数据和算法，搭建数据流一体化平台，从而实现高效；优化、完善精确计算。

### 工时对比——P4

经我们估算，暖通这边实现谢雨东的几个模块后，原来四五天的工作，半天可以完成，提升了 8 倍；工艺这边完成刚刚说的几个模块，原来一个月的工作，至少能缩短一半，效率提升 2 倍。下面由谢雨东进行第二部分的讲解。

### 全面通风系统流程对比——P5-6

### 软件服务模式 SaaS——P7

我们先看看常规的软件交付模式。最左边是很早之前的传统软件服务模式，所有的东西都放在客户本地服务器上。右边 3 个是目前流行的 3 大类云服务。Laas（基础设施即服务）、Paas（平台即服务）以及 SaaS（软件即服务）。数据流一体化的服务采用的是 SaaS，软件即服务模式。所有的服务和数据都是放在云端，用户只要有网，通过网页浏览器即可访问软件，非常方便和灵活。

### 数据流开发的技术栈——P8

前端：JavaScript，其抽象封装后的框架 Vue，以及第三方组件库element。

后端：PHP，其抽象封装后的框架 laravel，外加 python 进行数据爬取和清洗。

数据库：MySQL

### 2.3 前端框架——P9

这是我们可扩展的前端交互界面。

对内以专业来划分，我们要实现各专业在各自独立的界面内完成作业。每个专业拥有自己独立的操作界面。我在做我本专业作业时，我不需要要管其他专业，绝大多数输入都是从数据库里提取的（包括上游专业数据、基础数据等），只有少量数据是在页面输入，算法自动处理作业后产生的数据也是直接进数据库，一方面可以按我们需要的文件样式导出，一方面可以作为下游专业某个作业的输入数据。

对外实现客户信息在网页端的自动收集。我们会在网页端做一个专门供客户的输入信息的界面。比如客户的某些 URS，我们把客户要输入的信息固化好，客户输入的信息直接存入我们的数据库，供内部各专业作业时使用。

### 2.4 后端计算逻辑——P10

全面通风的业务逻辑，有 9 大块计算：1）房间参数计算。2）室外通风参数计算。3）消除余热计算。4）消除余湿计算。5）稀释有害物质计算。6）防爆通风计算。7）平时通风计算。8）事故通风计算。9）通风系统计算。

### 2.5 数据库表——P11

我现在以暖通的全面通风模块为例来说明所涉及的数据库表。

公共数据方面有：1）物性数据，密度、相态、爆炸极限、危害程度等。2）室外气象参数库，全国各省各个城市的室外温度和湿度——「工业建筑供暖通风与空气调节设计规范GB50019」的附录A。3）有害物质的职业接触极限，比如最高容许浓度 MAC、时间加权平均容许浓度 PC-TWA——「GBZ2.1-2019 工作场所有害因素职业接触限值第一部分：化学有害因素」。4）有害物质的换气次数—— HG/T20698-2009 的附录。

业务逻辑方面：1）项目数据表单。2）单体数据表单。3）房间数据表单。4）房间内所含有害物质的表单。5）房间所含散热设备的表单。

数据流的优势体现在 2 个差异上。

### 现有作业流程的差异——P12

与现有作业流程的差异。首先，我们在保留现有的作业模式的前提下做的优化。比如提取图纸的数据源，我们用块的形式，设计人员画图时跟之前没有任何区别，而且也是对图纸规范性的一种提升，可以说无学习成本，不会增加设计人员的额外负担。第二，作业环节大大简化了，数据源自动提取出来，上传到网页端，网页里某个作业只需输入很少的数据，点点鼠标就自动完成了。

### 与天正软件的差异——P13

第二点是与天正软件的差异。体现在 2 个方面。

首先，这些软件主要是全国市场的民用设计院，所以它里面的功能都是一些通用型、基础型的东西。比如结构的「探索者」，我专门问了下孜孜，他跟我说软件上很多条件是没有考虑的，深度不够，一般出的结构他们都会再考虑其他条件来修改。其他专业的天正软件都有这个问题。数据流可以说是在通用模块的基础上加载我们行业设计里相关的经验和算法进去。所以，跟我们现有的天正软件一点都不冲突，是很大的补充和完善。而且我们可以根据自己的作业模式来开发，不断的调整。

第二点是数据的连续性上。这些天正软件里的模块算完一个就完了，它不能供其他模块用，更别说块专业使用，它是独立的。我们的数据流一体化平台共享一个数据中心，各个模块间可以互相调数据，它是连续的。

### 后续规划——P14

这里我汇总了下，目前收集到的后续可以做的模块。暖通；工艺；仪表。其他专业这些预留的模块就靠在座的各位了。算上今天的，之前已经汇报过几次，大家现在应该很清楚我们到底想做什么了。

最后，趁着这个机会我再说 2 个目前在研究，不太完善的想法。

### 设备新型的更多应用——P15

设备信息的更多应用。我这边想到的有 3 个。1）设备型号关联设备的关键参数。化工 101 那边之前一直在收集设备信息，我们可以分别在网页端和手机端查询页面。这样在流程的块属性里我定型设备的型号，自动关联设备数据库里的关键设备参数。一个是减少输入，另一个是定型设备的关键参数大家都统一了。甚至于一些常见的非标设备，比如储罐、列管换热器，我们大家约定好代号，填代号关联设备。

2）第二个是自动传数据到布置图。这个是基于我以前做项目的一个习惯想到的。我平时会收集不同尺寸釜和罐的平面图做成块，排布置的时候，先根据设备清单，把按工序把设备清单里的设备放在一起。排一个设备从里面移走一个设备，移完之后设备也就布置完了。所以，我想以后流程图的设备信息直接导进设备布置里，自动插入匹配到的设备平面块。一个是效率高了，一个是设备的样式也统一了。

3）最后一个关于三维项目的。这个要去要就一下 cadworx、pds 这些三维软件有没有开放的数据接口，有的话我们可以接口要去做特定的数据格式，直接把流程图里包含的数据信息传过去。

流程图的信息直接生成块到设备布置图里。设备表里各个型号的块都做好。

### 管段表和材料表——P16

既然流程图里的信息最全，我甚至想把阀门和管件都做成块，自动抽信息统计材料。流程图里也就没有管道长度和弯头数量，这个可以放到网页端输入。不过公司本来就有管段表软件，这个开发和带来的提升效率有待评估。

## 碎片点

智能化图审系统

跟产品库结合起来，比如风机选型。

物性库在做数据流开发的时候，反向弥补。

按一个模块一个模块的讲。设备表、仪表条件、电气条件、外管条件。

前段查询，手机端和网页端。

标准和非标设备。

流程图的信息直接生成块到设备布置图里。设备表里各个型号的块都做好。

计算书；泵旁边的块

CAD 端以块作为「数据容器」。

这里先感谢下吴总，借鉴了一些逻辑。

之前大大低估了块的功能。不仅仅只是用来固化输入数据，现在可以把它作为一个实体对象的容器，作为某个生产环节的数据源，直接抽取数据到数据库。只要大家院里能够约定下来的东西都可以用块先约定死要输入的东西，如果需要进一步进行数据处理的话，那么就进数据库。

块的应用：土建条件该如何

有具体实施路径的：

还需探索的：

1、二维版的 PDS、cadworx。

对于二维项目，管段表、材料表也直接从流程图里抽取。流程图是最准确的。直接流程里抽材料，长度和弯头也可以做到管道的块属性里。

也可以实现标准化的目的，出来的图是一个样子的。

2、二维图纸里的数据以接口的形式与三维数据库对接。设备建模。我们这边可以根据三维的要求做对应的 api，比如 json 格式的数据。

3、与排方案、土建条件的衔接。

我得感谢吴总您。我们工艺这边管段号的提取插件是您用 lisp 写的，我前几天借鉴了里面的一些东西，现在也写了一个插件可以自动抽特定块里的属性出来了，这样就不行一步步点了。

03 产品演示

项目信息不用自己输，提前输好，到时告诉吴总这边是可以增删改查的。

02 说明 2 个差异：

1、我们跟天正暖通、天正水道、天正电气，现有的东西的差异。

我们要在现有软件的基础上，把我们天正的经验加载进去。

目前这些天正软件只是针对民用行业的。

2、和现有的设计流程的差异。

与谢的交流：

第二块的演示谢来做。

对比表。以前的作业环节，现在的作业环节。

原来很多设计的数据时经验值。第一个，我们现在要把它精细化。第二个，原来的一些作业的方法比较单一，比如全面通风计算，之前只是用的换气次数法，我们现在这套系统里的这个模块如果能普及的话，我们还可以用有害物的散发量法，多个维度方法的话我们就可以做比对验证了。数据多了，可以做成多个数据方案，对我们来说只是鼠标点点做选择，具体实现固化到算法里了。

可以把上面的优点放到提升设计品质里去。

最终的目的。

最终的畅想场景。1）做一个客户的输入接口，比如客户的 URS，我们把客户要输入的信息固定好，客户直接在里面输入就行了，直接到我们的数据库。2）一体化的解释：各个专业都有自己的界面。我不需要管其他的专业，其他专业的数据都是在他们自己的界面里输入、处理、输出到数据库，作为我这个专业只需要在自己的界面里调数据作业（提条件）就行了。这个解释放到第一部分里讲。

设备信息这一块，对总包的采购很有用，数据直接抽出来。

跟我们院目前各个共用工程在用的天正系软件相比。以天正暖通为例，它里面都是一些很通用型、基础性的东西，它的功能基本都是在后端，也就是画图的时候用到的工具。因为本身就是面向民用行业的，它里面是没有针对项目的东西的。我们的数据流一体化基本上是在处理前端的作业，即画图前，比如上游专业的 u rs、业主的 urs。

我们是针对工业设计院用的，主要是加载了工业设计方面相关的经验、算法进去。跟那些天正软件一点都不冲突的，是很大的补充和完善。而且这种完善很适合我们院自己的作业模式，因为本身是我们自己开发的。

这些软件没有数据连续性的功能。比如做一个风管计算，它要把风管画完后才出来。

传统作业：暖通专业收到条件后，先进行计算，然后设备选型，然后方案确认，条件表的填写，校审，然后下发到各个下游专业。现在的作业输入几个接口的数据、点点鼠标。