# 化工工艺流程设计智能化出图系统软件 V1.0

概要设计说明书

## 01 引言

### 1.1 编写目的

本文档是在软件系统需求规格说明书的基础上，对化工工艺流程设计智能化出图系统软件进行的概要设计，采用了「领域驱动设计」的方法论，对实现需求进行了各子域的设计。包括如何把该系统划分成若干个模块、决定各个模块之间的接口、模块之间传递的数据等。

软件工程师参考本文档进行详细设计。

系统测试工程师依据本文档进行系统集成测试和验收测试。

## 1.2 背景

系统名称：化工工艺流程设计智能化出图系统软件

任务提出者：浙江省天正设计工程有限公司

系统开发者：浙江省天正设计工程有限公司

系统用户：  浙江省天正设计工程有限公司

### 1.3 缩写、术语与解释

DCS	 —— DCS 是分散控制系统的英文缩写（Distributed Control System）

DDD——领域驱动开发——领域驱动设计是一种通过将实现连接到持续进化的模型来满足复杂需求的软件开发方法。

### 1.4 开发优先级定义

核心域（Core Domain），整个系统最重要的部分，是整个业务得以成功的关键。

支撑域（Supporting Subdomain），在核心域功能需求实现之后实现。

通用域（Generic Subdomain），不影响系统运行的功能，可以在后续实现。通用域的解决方案可以采购现成的，也可以采用外包的方式实现。

## 02 总体设计

### 2.1 系统描述

化工过程通常是由许多不同的工序组成，包括：存储、反应、蒸馏、吸附、萃取、干燥等工序。当前的化工设计，不同的人根据自己对各种工序及规范的理解，逐个工序进行设计，以致最后的成品或多或少存在差异，甚至不足。尤其是重点监管的危险化学品和重点监管的危险工艺，一旦设计有所偏差，将会给生命、财产、环境带来危险的隐患，基于此因素，国家对危险化学品和危险化学工艺进行了越来越严的管控。

本软件（智能化出图系统），通过对以往设计项目的总结；把以往设计过的项目提供给模型训练；在模型完成后，对模型进行检验，确认模型对各种工序能够进行稳定的分析，从而实现化工工艺智能化的出图。核心内容包括：

1、现有工序大数据整理，自动清洗，聚类，提取关键特征，并入库存储。简历快速索引查找表。

2、构建海量数据检网络模型。以项目工艺施工安全系数为优化目标，训练模型。把以往设计过的项目提供给模型训练；在模型完成后，对模型进行检验，确认模型对各种工序能够进行稳定的分析。

3、化工工艺智能化出图系统友好的人机互动界面。

4、设计人员通过设计相关资料（包括：工序和反应介质的温度、压力、物性等参数）的输入，系统能够按要求准确出图。

### 开发环境

硬件：PC（Intel (R) Core (TM) I5-8265u CPU 1.60GHZ 1.80 GHZ 8.00GB）

操作系统：Windows7

开发工具：Visual Studio Code V1.51

开发语言：Autolisp、Python、PHP

开发平台：PC 软件平台

### 运行环境约定

硬件：赛扬 2.5G CPU/ 1024M RAM / 80G Disk

显示分辨率 1024*768 或以上配置

操作系统：Windows7

软件环境：.NET Framework 3.5

### 2.2 软件体系结构

化工工艺流程设计智能化出图系统软件，借鉴了传统的 Web 软件架构 MVC，新增了服务层（Service）用于实现机器学习。整个系统主要包括展示层、服务层、控制层和数据层。

1、展示层（View）：负责用户页面设计，不同业务有不同的页面。例如，登录界面、各具体功能交互界面、数据库查询页面、数据预览界面等。

2、服务层（Service）：负责具体业务逻辑的处理，也是领域对象的实现层。例如，提取数据、机器学习、自动出图等业务。

3、控制层（Controller）：负责联动展示层和服务层。

4、数据层（Model）：负责完成数据访问，如增删改查数据库中的数据、记录事件到日志文件等。完成数据的持久化，如关系型数据库 MySQL、缓存系统 Redis 等。

回到前面所说的三层架构，这是行业中最早普及的一种架构模式，最开始是 MVC，也就是 Model、View 和 Controller。MVC 的概念起源于 GUI （Graphical User Interface，图形用户界面）编程，人们希望将图形界面上展示的部分（View）与 UI 的数据模型（Model）分开，它们之间的联动由 Controller 负责。这个概念在 GUI 编程中是没有问题的，但也仅限于在与 UI 有交互的部分。很多人误以为这也适合服务端程序，他们就把模型部分误解成了数据库里的模型，甚至把它理解成数据库访问。于是，你会看到有人在 Controller 里访问数据库。

软件配置文件（仅描述一些重要的配置文件）描述：

UIManager.json——用于配置界面框架中各组成部分包含的元素，如菜单、工具栏及主界面。

ControllerManager.json——用于各领域模型间通信的接口。

DataShareManager.json——数据共享的对等控制配置。

### 2.3 功能模块描述

简要描述本系统中各主要模块的基本功能。

编号	模块名称	功能描述

1、系统管理。添加维护各子模块的通信配置，如 IP，端口，所支持的协议类型，重连配置等。

2、项目管理。各项目信息、各项目包含的单体信息、设计人员绑定的项目和单体信息，针对不同设计人员给予不同的权限功能，以及设计人员信息的维护管理。

3、数据清洗。现有工序大数据整理，自动清洗，聚类，提取关键特征，并入库存储。简历快速索引查找表。

4、机器学习。构建海量数据检网络模型，以项目工艺施工安全系数为优化目标，训练模型。把以往设计过的项目提供给模型训练；在模型完成后，对模型进行检验，确认模型对各种工序能够进行稳定的分析。

5、日志管理。系统产生日志的查询功能。

6、数据共享。1）公共数据，如物性数据、规范数据。2）各子系统的数据流转共享规则配置管理。

7、用户登录。用户输入用户名，密码，是否记住密码等，只有完全输入正确方能使用本软件。

### 2.4 内部接口设计

模块名称	接口编号	接口描述

数据共享模块——IDataShareModule——各子系统数据共享对接规则设置接口。

### 2.5 外部接口设计

模块名称	接口编号	接口描述

自动出图模块——AutoPlotModule——自动出图的接口。

## 03 系统主体流程

系统主要操作流程为： 启动软件，输入用户名密码登录，登录成功后，添加项目和单体信息。对样本数据进行规整清洗后，将图纸数据载入机器学习界面。训练模型的过程中，系统根据拟合出的模型参数以及更新的数据自动更新迭代，模型检验评估后获得最终的模型参数。设计人员输入设计相关资料（包括：工序和反应介质的温度、压力、物性等参数），根据具体工况自动生成流程图。操作过程流程图如下所示：

## 04 各模块界面与实现

4.1 系统管理

系统管理主要包括对需要监视的子系统的相关信息的维护，包括控制中心的 IP，端口，支持的通讯协议类型等。

4.2 项目管理

各项目信息、各项目包含的单体信息、设计人员绑定的项目和单体信息，针对不同设计人员给予不同的权限功能，以及设计人员信息的维护管理。

图图

4.3 数据清洗

现有工序大数据整理，自动清洗，聚类，提取关键特征，并入库存储。简历快速索引查找表。

图图

4.4 机器学习

构建海量数据检网络模型，以项目工艺施工安全系数为优化目标，训练模型。把以往设计过的项目提供给模型训练；在模型完成后，对模型进行检验，确认模型对各种工序能够进行稳定的分析。

图图

4.5 日志管理

日志管理包括各子系统上传信息的记录，系统运行日志的查询等。

图图

4.6 数据共享

数据共享主要包括：1）公共数据，如物性数据、规范数据。2）各子系统的数据流转共享规则配置管理。

4.7 用户登录

用户输入用户名，密码，是否记住密码等，只有完全输入正确方能使用本软件。

图图

## 05 数据库结构设计

### 5.1 表汇总

以一览表的方式给出本系统所使用的每个数据结构对应的数据表的分类汇总。

数据表名称	对应数据库表名（英文名）	数据表描述

系统表	T_System	对各子系统信息进行管理

项目管理表	T_Power	对功能权限进行管理

系统设置表	T_Config	系统参数设置管理

日志表	T_Log	记录操作日志与系统错误信息日志

### 5.2 功能表

## 06 系统错误处理设计

可能的出错或故障情况出现时，系统输出信息的形式、含意及处理方法。
