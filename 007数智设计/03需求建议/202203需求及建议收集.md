## 01. 需求建议收集

1、所有的设备块增加 2 个备用参数字段。—— 已完成（2022-03-16）

涉及：1）数据库。2）临时表备用关键参数的显示，要考虑 josn 数据里没有备选字段的情况。3）成品设备一览表。

之前叶旭峰、郑涛等人也提过这个问题。

贡献者：蒋万忠

2022-02-28

2、提取格原的图签项目信息。（2022-03-14）

3、设备表的电机型号。

电机功率能匹配到到自动填充电机型号，匹配不到的填充防爆电机或非防爆电机。

贡献者：蒋万忠

2022-03-18

4、仪表条件里，拼接的联锁符号，在左侧可导回并存库的字段里增加一个该字段。

现状：功能代号有联锁 S，报警里既有 H 也有 L 的情况下，用户有可能是高报联锁也可能是低报警联锁，系统没法判断，索性加一个字段，用户不填的话按之前的逻辑走，用户填了的话以用户填的为准。

贡献者：蒋万忠

2022-03-25

补充：待确定要不要开发。（2022-04-12）

6、工艺非标条件导出来的标注比例和文字大小往上调大。

备注：赵总审核看不清楚。

贡献者：林骏

2022-03-29

7、辅助流程管道更新是做校验。

如果找不到主流程的管道数据 ID 的话，变图层变颜色，让用户自己决定要不要删。

贡献者：蔡维玲

2022-03-31

8、兼容格原新图签。—— 已完成

## 02. Bug 修复及优化

### 工艺专业

1、仪表位号有空值时自动编号打圈圈。—— 已修复

靠调试工具解决的。（2022-03-12）

2、外管条件里公称直径数据以及其他（序号、壁厚）。—— 已修复

贡献者：蒋万忠

2022-03-18

3、所有涉及到面板 dcl 的功能都用不了。—— 已修复

主要的错误提示：base.dcl 未找到文件。

Google 搜到的解决方案是 op 设置里，支持的搜索路径缺少：

```
C:\Users\<用户>\AppData\Roaming\Autodesk\AutoCAD 20xx\Rxx.x\enu\Support
```

比如我自己的：

```
C:\Users\dell\appdata\roaming\autodesk\autocad 2016\r20.1\chs\support
```

添加进去就解决了。

贡献者：牛亚禄

2022-03-30

### 设备工程图

1、无损检测表格无数据。

写块的数据采用的是忽略下划线的那个函数，但这里获取的数据字段是沿用老逻辑，属性字段是待下划线的，所以写数据的函数改一下就行了。

另外，之前通过焊接系数自动匹配检测率的逻辑，放在 CAD 端的，目前考虑放到 Java 后端。

2、卧式储罐底部的几排标注间距引入图纸比例。

之前是写死的，偏移 100，目前修改为图里比例的 10 倍，比如图纸比例是 15 的，那么间距自动设为 150。涉及到好几个函数，比如 InsertBsGCTOneEquipSideDownHeadDimension。

底部管嘴的定位也得引入图里比例信息，涉及到函数 InsertBsGTCHorizontalDownNozzleTag。

3、管嘴生成不全，图纸生成时终止。

问题：卧式储罐侧面定位数据的数据有问题，之前按照直径做的定位，应该改成大家习惯的半径（暂时不改，涉及的东西比较多）。

贡献者：叶菁

2022-03-03

解决方案：因为用的是很老版本的块，图纸里没有 DataFlow 的文字样式。自动插入接图箭头前先做一个字体样式的验证。

4、Excel 表里，焊接接头系数之前做的有 4 个选项，取消 1.0/0.85 的组合，这个组合不可能。

贡献者：叶菁

2022-03-15