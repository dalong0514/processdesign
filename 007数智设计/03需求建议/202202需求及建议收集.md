## 01. 需求建议收集

1、管道按超 3 位的编号。

新功能需求：面板里做个选项，按二位数、三位数编号，如果按 3 位数编的话，100 以内的自动在前面补一个 0。

之前叶旭峰、郑涛等人也提过这个问题。

贡献者：赵晓旭

2022-02-10

目前按工序编号基本都会超 100 位。

2、开发一个功能，一键清除所有流程图底部设备位号块内的 version 字段。

贡献者：王丽清

2022-02-10

3、非标设备条件，储罐表剔除所有混凝土材质的。

贡献者：朱颜清

2022-02-10

补充：混凝土的污水池压根不用做非标条件，发现很少有人自己去核哪些不用做非标条件，比如之前搪玻璃反应釜也是。以后的目标是做到无脑，遇到明确不用做非标设备条件的，后台里剔除掉。

4、仪表条件组装的报警和联锁逻辑优化。—— 已完成

贡献者：赵晓旭

2022-02-19

原逻辑：只要功能代号里有联锁 S，那么组装的报警和联锁都是跟 CAD 原生报警值一样。

新逻辑：只要功能代号里有联锁 S，CAD 原生报警分两种情况。一是没有字符 / 的（比如 H），组装的报警和联锁跟 CAD 原生报警值一样。二是含有字符 / 的（比如 H/HH），组装的报警为前面的 H，组装的联锁是后面的 HH。

新逻辑实现：没有字符的 / 的也拼接成有字符 / 的，比如 H 拼接为 H/HH，然后全部按照有字符 / 的逻辑往下走。

4、设备布置图缺长型支耳。

贡献者：尚颜娜

2022-02-22

5、设备数据更新。

2022-02-22

场景：设备清单发给业主后，业主更改了设备位号，修改的信息要同步到流程和布置图。只要有业主改的新旧数据对比表，在 Excel 表内用 VLOOKUP 可以修改，再反导回布置和流程。这个功能可以嵌入到功能「流程和布置设备数据对比」页面里。

## 02. Bug 修复及优化

1、自动插入截图箭头时，没反应，箭头不显示出来。

解决方案：因为用的是很老版本的块，图纸里没有 DataFlow 的文字样式。自动插入接图箭头前先做一个字体样式的验证。

贡献者：毛宇文

2022-02-10

2、数据流属性块，version 字段与格原入库冲突。

解决方案：收下清除了管道、设备、仪表块内的 version 字段，发现无效。接着把流程图底部的设备位号块内的 version 字段清除，有效。

补充：应该只跟流程图底部的设备位号块内的 version 字段有关，好像是因为距离靠近底部的图签。待验证。

贡献者：王丽清

2022-02-10

3、设备布置图到设备临时文件导不出来。

布置图的设备位号，块名修改了，增加了 GsBzEquipTag 前缀。

贡献者：徐骋

2022-02-11

4、无新图签造成的问题。

知道要插入数据流的小图签，但插错了位置，查到了左上角，导致一键更新仪表所在位置无效。

贡献者：蔡一夫

2022-02-14

5、刷数据并绑相对位置，绑不上数据。

问题解决方案 1：发现绑数据和放冻结层的顺序反了。应该先绑数据后再放入冻结图层。

发掘的信息点：仪表块如果在冻结图层，除了属性值写不了数据，字典对象数据也写不进去。

问题解决方案 2：楼一先的图纸里，个别仪表就是绑不上相对位置，目前没找到原因。但换一个块把属性值迁移过去就能绑。目前这种的过渡方案：只有绑了相当位置才把块放进冻结图层，至少让用户知道，哪些块没绑上。

贡献者：徐骋

2022-02-15