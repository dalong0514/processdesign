## 01. 需求建议收集

1、图签内项目名、图纸名的字体宽度修改。—— 已完成 V2.4

贡献者：吴聪

2021-08-03

2、相对位置专项功能。

仪表、阀门、变等级号、异径管。

贡献者：徐骋

2021-08-04

第一步，刷仪表所在位置的同时，1）打标签（绑距离）剔除进入后续匹配集。2）切换图层换色。管道上的仪表，所在位置填写物料代号。

第二步，自动匹配：1）剔除打了标签不需要匹配的仪表。2）仪表所在位置空值的找最近的设备（仪表）块。3）仪表所在位置有物料代号的找物料离它最近的该物料管道块。

3、自动加载数据流插件的设置。—— 已完成 V2.4

贡献者：徐骋

2021-08-04

4、文字版管道编号转为数据流管道块。—— 已完成 V2.4

针对场景：已经做了一部分的老项目、业主提供的有管道编号的流程图。

贡献者：蒋万忠

2021-08-11

5、仪表按设备位号编号。—— 已完成 V2.4

可以匹配昌海设备位号形式 `2528_V01_01`。

贡献者：赵晓旭

2021-08-16

6、插入部分阀门管件。—— 已完成 V2.4

2021-08-16

## 02. 修改记录及 bug

### 工艺 bug

1、所有图纸自动加载。

```
(load "D:\\dataflowcad\\dataflow.VLX")
```

2、开着客户端时，CAD 导出无法写数据到文件。（2021-08-12）

因为之前提取项目信息时，读取的那个文件时客户端没把它关掉，导致写不了数据。

解决方案：重写了文件「getFirstRowJsonFile.ts」。

```js
import fs from 'fs-extra'

// refactored at 2021-08-12
export default async (filePath) => {
  const dataList = fs
                    .readFileSync(filePath)
                    .toString('UTF8')
                    .split('\n')
  const projectInfoStirng = dataList[0]   
  const projectInfo =  JSON.parse(
    projectInfoStirng.substring(projectInfoStirng.indexOf('{'))
  )

  return projectInfo
}
```

2、图纸目录填充目录图号。

同时目录的图纸写死为 A4。

贡献者：沈洋

2021-08-04

### 给排水 bug

给排水迭代意见修复（2021-08-10）：

1、市政到生产加压水是往上的箭头。—— 已完成

2、生活用水量那边漏掉了排污的水管。—— 已完成

3、循环水排水的 52.8 有肯能是放在污水量那边（之前放在的是清下水），哪个有值读哪个。—— 已完成