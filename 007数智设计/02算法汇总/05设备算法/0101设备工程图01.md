## 单项功能

### 1.1 无损检测

方全利：无损检测数据，比如筒体，只要填一个检测率，其他数据（等级技术、检测标准、合格级别）都可以匹配出来。

叶菁：检测比例按焊接接头系数取，焊接接头系数 1.0 的，100% RT-II，其余 20% RT-III。

需求表中的无损检测：（2021-06-08）

1、筒体公称直径小于等于 1200 的椭圆封头：焊接接头系数直接取 1.0，检测率技术等级检测标准合格级别为一整行，标记为「整板制作」。

2、筒体公称直径大于 1200 的椭圆封头：焊接接头系数 0.85 的话，检测率 100%，技术等级 AB 级，检测标准 NB/T47003.2-2015，合格级别 RT-Ⅲ。

3、筒体公称直径大于 1200 的椭圆封头：焊接接头系数 1.0 的话，检测率 100%，技术等级 AB 级，检测标准NB/T47003.2-2015，合格级别RT-Ⅱ。

4、筒体公称直径小于 400 或者等于 400 的管材：筒体焊接接头系数取 1.0，检测率技术等级检测标准合格级别为一整行，标记为「整根制作」。

之前的逻辑是有问题的，重新梳理。筒体检测率和封头的检测率是分开的：（2022-03-15）

筒体检测的逻辑：

先确定是管材还是板材，直径小于 400 或者等于 400 的管材：筒体焊接接头系数取 1.0，检测率技术等级检测标准合格级别为一整行，标记为「整根制作」。直径大于 400 的是板材：1）筒体焊接接头系数是 1.0 的话，检测率 100%，技术等级 AB 级，检测标准NB/T47003.2-2015，合格级别RT-Ⅱ。2）筒体焊接接头系数是 0.85 的话，检测率 20%，技术等级 AB 级，检测标准 NB/T47003.2-2015，合格级别 RT-Ⅲ。

封头检测的逻辑：跟之前的逻辑一样。注意：封头的检测率都是 100%，之前没注意到这个细节。

补充：直径 400 的不一定都是用的管材，有些业主不听设备专业的，非要用卷材。

### 1.2 图形数据库

从 HGCAD 里薅图形数据。

设备法兰相关：

目前只做设备法兰的，垫片先不弄了。设备法兰需要的组合如下：

1、三个规范都要（JB/T4701-4703）。

2、只需要 RF 密封面的。

3、只需要主视图和俯视图。

4、不同的公称压力都做。

5、厚度默认按 8mm。

6、不同筒体直径的。

### 1.3 工程图重量计算模块逻辑

1、筒体重量。

中径 (mm) X 厚度 (mm) X PI X H (筒体长度) X 7850 (CS) 或者 7930 (SS)/10^9。

问题：1）中径的概念；2）算出的单位是 kg。

回复：中径是内径加上一个壁厚；按上面公式算出来的单位是 Kg。

2、封头重量。

查数据库。

壁厚没有的话，取平均值。比如壁厚 6 对应重量 100，壁厚 8 对应重量 200，那么用此方法，壁厚 7 对应的重量为 150。

补充：1）误解了，不是壁厚取平均值，壁厚都是按 6、8 这些整数值的，是筒体直径可能不是整数。2）换个实现方式，数据库里把筒体按 10mm 分割，所有的数据都先做成库，直接查表。其实可以按 50 分割，比如直接 1210 的情况很少的。（2021-12-05）

3、接管法兰重量。

查数据库。

普通法兰：

接管重量：1）计算公式同筒体计算公式；1）管子的壁厚按工艺管道等级号里的数据。

法兰盖重量：每个备用口配一个法兰盖。

人孔手孔重量：目前设备专业手动查数据填写。

补强圈重量：DN50 及以上的管口都查表补强圈的重量。

确认：工艺条件里没有仪表口的尺寸数据。（备注一下，先不做仪表的口，反正会导出一个中间文件）

4、支座重量。

查数据库。

支座数量：1）支腿式，规范里表格特定筒体直径、型号的支腿，数量是固定的。2）支耳的数量，筒体直径小于等级 300 的设 2 个支耳，大于 300 的设 4 个支耳。3）鞍座：按 2 个考虑，有极少情况下是 3 个，3 个的话安装角度都不一样，目前不考虑。4）支撑式：目前无法定死，设备人员自己输数量，支座数据Sheet里增加一列支座数量。

5、设备法兰重量。

查数据库。

需要三个信息：1）设备法兰形式：甲型平焊、乙型平焊、长颈对焊；2）压力等级；3）密封面形式：平面、凹面、凸面等。

实现逻辑：1）主数据表增加字段「是否包含设备法兰」，是的话才去匹配重量数据。2）增加一张设备法兰数据 Sheet，  包含的属性字段：设备位号、设备法兰型式、压力等级、密封面形式、设备法兰对数。

6、其他（人工填写）。