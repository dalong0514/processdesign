## 更新内容记录

## V2.3 版更新内容

**设备条件相关：**

1、新增非标设备条件模块（贡献者设备专业）。

自动提取流程图内设备条件的相关数据到 Excel 模板，Excel 补充、修改相关数据后自动在 CAD 内生成设备条件图。

**流程图相关：**

1、自动编号算法改进（贡献者郑飞宏）。

以前不按图号编号模式，只能一整行一整行的编。实现了所有数据全部一起编号，前提是先一键将所有数据填充图号信息。

2、导出临时 Excel 文件界面简化并增加框选数据功能。以前只能导全部数据，现在可以框选只导出部分数据。

3、修改数据流块的字宽（贡献者李恒、林骏、尚颜娜）

场景：有时候管道号、仪表编号太长，一个个用原生的 CAD 方法修改块属性字体宽体太慢，新增功能批量修改管道块、仪表块内的相关属性字体宽度。

4、接图箭头批量生成（贡献者叶旭峰）。

场景：很多时候泵出口有多根管道，一个个点太慢，可以批量生成。

5、增加了双箭头外管块（贡献者王禹谋）。

6、设备块的材质外显。应多人要求，设备块的材质属性外显出来方便画图时核对。

**布置图相关：**

1、设备图形块旁边自动生成设备位号（贡献者徐骋）。

布方案时可以只管图形块，定稿时在设备图形块旁边一键生成设备位号块。

2、洁净空调块新增系统编号、楼层，服务于暖通洁净空调模块。大家提洁净空调数据流的块提，比原来的模式要块。更重要的是，数据可供暖通专业直接使用。

3、新增舒适性空调条件模块（贡献者牟苏嫣）。

**设备一栏表相关：**

1、设备一览表模板更换为公司 2017 年的那版（贡献者楼佳明）。

**其他：**

1、新增介质物性匹配工具（急性毒性数据模块，贡献者陈康麟）。

将项目涉及的物质拷到 Excel 模板后，后台自动与「危险化学品目录（2015 版）实施指南（试行）的通知」匹配，获取该物质是否为急性毒性 1 级、2 级的信息，该模块后续会不断匹配更多的规范数据以及介质本身的物性数据。

2、集成清理命令到公共工具（贡献者李奕峥、王运）。

另外：建筑设计流增加了「泄压面积自动计算」模块，工艺这边有些人排方案的时候是直接用天正建筑自己画的，如果你用的天正建筑可以找我学下该模块，排方案的时候直接看下泄压够不够，避免后面浪费时间。

## V2.2 版更新内容

**流程图相关：**

1、自动填充公用工程管道的来去向设备位号（贡献者曾涵卫）。

再次特别感谢曾涵卫的好点子。之前一个设备配套的公用工程管道，其管道来去向的设备位号要通过刷「管道来去向」功能赋值，新增的功能可以省掉绝大部分此项工作。

基本原理：每张图里筛选出公用工程管道（物料代号支持自定义），每个管子去找离它距离最近的设备位号块，就当是这个设备上的管子自动把设备位号填充进管道的来去向里。差不多 80% 以上是对的。剩下的 20% 按以前的方法刷，刷的同时也跟这个设备做了数据绑定，下次再使用「一键赋值公用工程管道」时，如果管道上已经绑定了数据，以你绑定的设备信息来更新，没绑定的话才会去找距离最近的。

2、一键生成流程图底部的设备位号（贡献者曾涵卫）。

跟之前的一键更新图号数据一样，流程图底部的设备位号也不用一张张图纸刷了，全部自动生成，且支持一键更新。

3、刷仪表位置的时候绑定设备的数据 ID（贡献者徐骋）。

之前刷仪表所在位置，只是把设备位号（管道号）赋值给仪表的「所在位置」属性，现在做了数据绑定，设备信息改了后支持一键更新。

4、自动编号新增自上而下和自左而右两个方向选择。

所有管道、设备、仪表的自动编号，之前的排序逻辑只支持「先左右再上下」，新增「先上下再左右」的排序选项。

## V2.1 版更新内容

**总体相关：**

1、设计流自动生成图形时所需的「图形模块」全部放入了公司内部服务器，确保所有人调用的是同一个数据源。

2、网站里生成成品时，导出数据支持选择性导出。

3、图签支持多行多列同时自动编图号。之前只能一整行一整行自动编，新功能使用的前提：同一行的所有图签必须放在一个水平方向（Y 轴定位必须一样）。

4、管道、设备、仪表所有设计流的块，支持一键复制所在图号信息。以前要一张一张刷图号，现在根据流程图图框大小定位数据，自动赋值。

5、集成了去教育版功能。很多人的图纸目前都带教育版，一键去教育版目前集成到了「公共工具」栏里。

**流程图相关：**

1、改进上个版本增加的功能：生成仪表块继承所在设备或所在管道的数据。

经使用反馈，自动生成的仪表会自动继承所在位置的介质、温度、压力等数据，但很多时候我们这几个数据会经常改。改进后的逻辑：自动生成的仪表只自动填充所在位置（设备位号或管道编号），而且支持自动更新（设备位号管道编号改了，仪表所在位置也可以一键更新）。介质、温度、压力等数据，如果跟设备或管道相同，只要空着，导成品时后台已经有功能可以去匹配关联的数据。所以自动生成的仪表填充所在位置信息即可。

再次强调：设备、管道、仪表三个块的数据，仪表的数据很多可以不填，只要跟其所在位置（设备、管道）相同的都可以不填。

2、主物料管道的初始数据自动填充。管道的来源、去向这两个属性，只要填的是「设备位号」，那么可以自动填充来源设备里的「介质、温度、压力」3 个数据。有此初始数据后再根据实际情况做调整。（贡献者郑涛）。

## V2.0 版更新内容

2021-03-20

**总体相关：**

1、设计流所有组件封装到后台。

以后不用每次拷之前发布的模板 CAD 到自己的流程图里了，新建一个空白图纸也可以通过工具栏里的按钮生成管道、仪表、设备位号等属性块。

2、重新梳理了内网上的文档说明。

**布置图相关：**

1、流程图设备数据自动迁移到布置图。

目前流程图中的设备数据可以直接迁移到设备布置图里。一键生成对应的布置图设备位号，并根据设备尺寸匹配相应的「设备平面图形」。

备注：目前只设备外形图形库只做了立式储罐以及 B 型支耳的搪玻璃反应釜（开式及闭式）。如果设备尺寸匹配不到相应的「设备平面图形」，而你手里又有比较好的设备图形，请提供给我。此功能的实现，需要大家一起把手里比较好的、厂家提供的设备外形尺寸放在一个公共图形库里。

2、设备布置图平面图形根据设备代号自动匹配更新。排方案后，如果设备尺寸修改后，可以根据「设备代号」自动更新其外形图形。

布置图中的设备数据也可以导出到临时 Excel 文件，通过更改「设备类型代号」可以更新设备的外形尺寸图形。

3、迁移建筑底图到工艺设备布置图。

基本思路：1）自动抓取建筑图纸里特定的对象数据（柱子、墙、门、窗、楼梯）生成建筑底图，干净的建筑底图可以迁移到工艺设备布置图里。2）建筑底图的图层支持一键锁定和解锁。3）支持一键更新。建筑那边的图纸修改后可以更新到本专业底图。

4、通过设备的临时 Excel 文件自动生成布置图里的设备位号以及设备的外形尺寸图形。

针对的场景：拿到业主的设备资料后，整理出需要的设备关键参数后，复制到临时 Excel 文件，可以直接在布置图里生成设备位号以及匹配的设备的外形尺寸图形。

**流程图相关：**

1、生成仪表块继承所在设备或所在管道的数据（贡献者王小飞、曾涵卫）。

除了常规的 copy 外，目前提供了另外一种画管道块和仪表块的方式。以设备为核心，生成设备上的仪表块可以继承设备的部分属性数据。生成从设备出去的管道也可以继承设备的部分属性数据。详见内网说明文档中的「流程相关说明」。

2、新增批量刷只刷管道起点或者只刷管道终点。

3、通过设备的临时 Excel 文件自动生成流程图的设备位号以及流程设备图形块。

针对的场景：拿到业主的设备资料后，整理出需要的设备关键参数后，复制到临时 Excel 文件，可以直接在流程图里生成设备位号以及匹配的设备图形（设备图形库还未上线）。

4、取消了每次导临时 Excel 文件前必须选择「预览修改」的限制。

## V1.4 版更新内容

2021-01-27

**仪表条件相关：**

1、仪表位号新增按设备号自动编号。（贡献者王禹谋、陈仁勇）

使用前提条件：1）仪表块里「所在位置」的属性要刷好。2）如果仪表在管道上，该管道块「来去向」属性所连的设备位号要刷好。

基本逻辑：1）设备上的仪表，仪表所在位置填有该设备。2）管道上的仪表，找到仪表所在位置对应的管道，接着找该管道里来去向连接的设备（来去向都是设备位号的话以离仪表位置最近的设备为准）。

**设备相关：**

1、储罐、反应釜新增自定义字段。（贡献者孙伟昌）

储罐可能会有外盘管参数信息。储罐块、反应釜块新增了 2 个自定义属性，常规参数不够填往这里填。

2、各设备块的更多属性参数外显。（贡献者周星）

## V1.3 版更新内容

2020-12-30

**总体相关：**

1、数据流菜单规整。（贡献者郑飞宏）

工艺的数据流目前 6 大块功能模块。1）帮助：版本信息、一键同步数据流属性块；2）数据修改：刷数据图号、刷管道起点终点、刷仪表所在位置、命令版刷块属性、界面版刷块属性、强化版自动编号、图签自动编号；3）数据提取：导出数据、导出数据流临时 excel、导出通用块临时 excel；4）流程图辅助：自动生成接图箭头、自动生成辅助流程、自动生成设备位号、刷变等级号信息、刷变管径信息；5）布置图相关：洁净空调条件房间自动编号；6）保留的旧版功能。

在此特别感谢郑飞宏提炼出的功能分类模块。

2、新增数据流常用命令工具栏。（贡献者郑飞宏）

将常用的数据流命令做成了一个 CAD 工具栏，目前画图时你有 3 种方法使用数据流功能：1）菜单栏。2）工具栏。3）将数据流命令映射为自己喜欢的命令名称（CAD 里的工具 -> 自定义 -> 编辑程序参数）。大家根据自己的习惯自行选择。

3、新增一键同步数据流属性块功能。（贡献者徐骋）

以后不需要用命令 BATTMAN 一个块一个块点「同步」了，同步时将自己的图纸整体拷进「模板」CAD 中，点帮助里的「一键同步数据流属性块」即可。

特别提醒：请谨慎同步「管道块」。我们发现同步管道块后，所有管道的「数据 ID」会更改，而一键更新接图箭头和一键更新辅助流程，是与管道的数据 ID 关联的，同步管道块后这两个功能无法使用。所以本次更新的「一键同步数据流属性块」剔除掉了管道同步，也请大家如非必要，不要同步管道块。

4、规整字体、图层以及一些块的基点位置。（贡献者郑飞宏）

汇总：1）数据流数据字体统一样式命名「DataFlow」，里面的字体用公司常用的 tssdeng.shx；2）数据流块图层做了一些调整，外显的字调整到 0 层，保证整个块随意调整到其他层后可随层变化；3）仪表块的基点位置做了调整。使用过程中，有些人将块进行了镜像操作，此时同步块后会出现位置偏移。解决办法是将基点设为图形的中心。

此版已经将仪表块的中心作为基点，同步后你图纸里的仪表块会整体左移，通过 CAD 右键自带的选择类似对象筛选出仪表块，整体右移 5 即可复原位置。目前管道块的偏移问题还没找到好的解决办法，如果管道号文字居中设置且中心设置为基点，会导致不整齐结果。如果有人有解决办法请告知于我。

5、新增批量刷块属性功能。（贡献者郑飞宏）

数据修改的「命令版刷块属性」，可以提取一个块信息为源数据，批量将其属性值刷给后面框选的块，刷的块可以是不同类型的数据（后台自动匹配相关的属性字段）。

6、升级版导出导入 excel 文件。

数据提取模块中的「导出数据流临时 excel」。两点：1）数据流相关块的导入导出集中到一个功能面板，现在可以同时导出 7 大类设备块。2）取消导入临时文件的前置条件，旧版只有点击导出数据完成后才让用户导入。

7、导出通用块临时 excel。（贡献者屠立峰）

数据提取模块中的「导出通用块临时 excel」，可以导出 CAD 中任意同类型块数据，并且自动添加撇号转化为 excel 文本格式，解决一些被 excel 自动转化错的场景，如被当作科学计数法。

**管道数据相关：**

1、新增变等级号、变管径功能。（贡献者郑飞宏、徐骋）

通过给管道刷变等级号、变管径信息，管道数据表中生成相应的多根管道。

**仪表条件相关：**

1、新增自动补全仪表控制点名称隐藏功能。（贡献者徐骋）

自动抓取相关数据补全仪表控制点名称，需要「暗号」，具体操作详见说明文档的技巧篇。

**设备布置相关相关：**

1、新增洁净空调条件模块。（贡献者郑飞宏、牟苏嫣）

## V1.2 版更新内容

2020-11-19

**总体相关：**

1、自动生成跨流程图的接图小箭头，并实现一键更新。所有设备块新增「所在图号」属性，跨流程的管子包含起点终点的设备位号，设备块内又有所在图号信息，那么跨流程图的接图箭头可以自动生成。而且做了数据绑定，管道数据变动后，接图数据可以一键更新。

2、自动批量编号强化版。1）对于管道：后台根据物料代号自动分类，每一个小类自动编号，同时支持按流程图自动编号（如果业主没特殊要求的话，个人强烈推荐按流程图编号）。2）对于仪表同理。强化版的自动编号结合自动生成接图箭头（解决跨图号管道编号重复问题），管道和仪表编号自动化基本解决了。（贡献者王禹谋、李恒）

3、自动生成辅助流程图强化版。生成的辅助流程数据与主流程的管道数据做了绑定，主流程数据修改后，支持一键更新辅助流程。

4、配置「数据流工具选项板」，将设计流的相关属性块集中到一个工具面板上，类似于「天正电气」的那种界面，可以直接选择块插入到图纸里。有些人可能喜欢直接在图纸里 copy 块，看个人喜好。配置步骤详见说明文档里的「01 使用说明」部分。（贡献者郑飞宏）

备注：CAD 很多原生的功能我是不知道的，如果大家知道哪些功能可以跟「数据流」结合在一起，跟飞宏一样直接告诉我，我这边集成进来，至少让你多一个选项。

## V1.1 版更新内容

2020-11-09

**总体相关：**

1、流程图图签自动编号，以及从图签自动提取图号，刷这张图里所有数据的「所在图号」属性。（贡献者王禹谋、张坤）

2、自动生成辅助流程图主要数据。（贡献者叶旭峰）

3、通过选取数据源，批量刷属性块内的数据。（贡献者徐骋）

4、自动编号（管道、仪表、设备），新增「点选」功能。（贡献者徐骋）

5、数据块更新：1）管道的起点和终点数据外显；仪表所在位置数据外显。备注：方便刷完数据后确认。2）外管块内「图号」属性名修改。

**管道数据相关：**

1、通过选取数据源，刷管道的「起点」和「终点」数据。

**仪表条件相关：**

1、批量刷仪表「所在位置」属性。

以上所有具体操作，大家可以去网页端看「文档说明」中的技巧篇。

## V1.0 版更新内容

2020-10-27

**总体相关：**

1、数据流的菜单栏调整以及新增相关图形交互界面。

2、始终自动加载插件的解决方案。（贡献者张堃）

部分人即使在 CAD 插件的启动组里添加了数据流的插件，还是遇到无法加载的情况。请找信息技术部装下 360，查杀一下自己电脑里的「acaddoc.lsp」病毒，清除一下即可解决问题。

**管道数据相关：**

1、根据管道所在的坐标位置，自动批量编号。（贡献者汪晨）

2、批量修改管道数据。CAD 中精准刷选出要修改的管道数据 -> 导入到 Excel 临时文件 -> 批量修改后反导回 CAD。（贡献者曾涵卫）

**仪表条件相关：**

1、新增 SIS 属性块。

2、根据仪表所在的坐标位置，自动批量编仪表位号。

3、批量修改仪表数据。CAD 中精准刷选出要修改的仪表数据 -> 导入到 Excel 临时文件 -> 批量修改后反导回 CAD。（贡献者曾涵卫）

**设备数据相关：**

1、自动生成流程图底部的一排设备位号。（贡献者陈李荔）

2、根据设备所在的坐标位置，自动批量编号。（贡献者叶旭峰）

3、批量修改设备数据。CAD 中精准刷选出要修改的设备数据 -> 导入到 Excel 临时文件 -> 批量修改后反导回 CAD。（贡献者曾涵卫）

4、设备块数据新增，是否防爆（Y/N）、电机级数（2/4/6/8，填 1 为变频电机），后台会根据电机功率、级数、防爆信息匹配天书里的电机型号写进设备一览表。（李恒）

5、自定义设备，下面文字「参数 1-3」，碍事，删除掉。（贡献者范敬宜）

提示：以后做安全专篇的设备表时，可以直接从 Excel 临时文件里拷，节省时间。

以上具体操作详见文档说明里的「技巧汇总」。

## V0.6 版更新内容

2020-09-22

**总体相关：**

1、新增 CAD 提取数据的图形交互界面。具体设置详见文档中的「使用说明」。

2、修改用户密码。点击右上角的头像展开选项，点击「设置」，在弹出的面板后修改用户密码。

**仪表条件相关：**

1、仪表测量控制点名称自动拼接。（贡献者徐骋）

2、仪表自动关联管道数据匹配逻辑修改。（贡献者徐骋）

从原来匹配整个管段号到仅匹配最前面的管线号，例如仪表所在位置填的「PL1106-80-2J1-H5」，之前的逻辑是整个管段号去与图纸里的管道号匹配，有人反馈在画图过程中，经常会修改管道数据的信息（如管径），仪表所在位置已填的信息懒的再改。所以现在仪表所在位置的管道号只提取前面的「PL1106」去匹配管道数据。

3、备注里的保温厚度信息自动关联管道数据。（贡献者孙伟昌、徐骋）

仪表所在位置为管道的话，备注里的保温厚度不用填了，后台会自动提取所在管道的保温信息。

**外管条件相关：**

1、外管数据关联管道数据。外管块里的管道号会自动关联该管道上的相关信息，减少重复输入。备注：跟管道数据表一样，管道等级号必须使用数据流配套的「管道材料等级表」。

## V0.5 版更新内容

2020-09-07

**总体相关：**

1、新增用户系统。

每个人的账号为自己公司的邮箱名，密码默认为：tz123。账户密码修改系统下一个版本会更新。

2、各模块界面更新。

3、新增文档说明页面。

软件的使用说明、各个版本的更新内容、bug 修复情况等信息都会放在这个页面里。

**管道数据表相关：**

1、保温材料空值关联已有数据（贡献者徐骋）。

有保温符号的管道，保温材料信息，后台可以自动关联已填有的数据。比如 200℃ 以下的保温（符号 H、岩棉制品），200℃ 以上的（符号 H、硅酸铝），保冷（符号 C、聚氨酯），防烫（符号 P、岩棉制品）等。每个类型的，图纸里只要有一个数据填好了，其他的可以不填。

**仪表条件相关：**

1、新增控制阀条件表。开关阀和控制阀的信息放在控制阀条件表内。

2、仪表属性块增加「备注」字段。（贡献者张堃、孙伟昌、徐骋）

备注信息如：保温厚度、开关阀的气开气关、联锁逻辑等，这个属性字段的信息会自动填充到条件表里的备注栏中。

**设备一览表相关：**

1、自定义设备块的参数，如果为空值就不填充。

之前自定义块中，4 个自定义参数默认写的是「xx」，空值的话设备一览表的那一栏不会再填充，省得导出的表里要自己手动删除。

## V0.4 版更新内容
 
 2020-08-22
 
**管道数据表相关：**
 
1、新增管道数据表模块。
 
抽出来的管道数据，在设计流数据一体化平台上可以导出 2 个文件，一个是我们的成品管道数据表，一个是做管段表用的数据源（可导入公司做管段表的软件里用于统计材料）。
 
特别强调的是：管道等级号必须使用配套的材料等级表（附件）。只有使用配套的等级号，压力等级、吹洗介质、无损检测比例、检测合格等级、泄露性试验介质、压力，这几个数据后台可以自动根据相关逻辑判断填充，否则只能在导出的数据表内自行修改。
 
另：如果你项目里用到的物质在配套等级表里找不到相应的等级号，请与我联系。
 
**仪表条件相关：**
 
1、仪表数据与管道块、设备块数据关联。（贡献者冯大龙、顾川川、徐骋、蒋万忠）
 
仪表块、管道块和设备块内有相同的数据可以共用，减少重复输入。这个想法包括我自己在内，有多位同事想到并给我提了建议，目前已实现。
 
仪表块的中工作介质、温度、压力、所在位置的材质、所在位置的规格尺寸，这 5 个属性数据的提取逻辑如下：1）先判断仪表块里该属性有没有填，填了的话直接提取该数值。2）没填的话，后台会根据仪表块里的管道编号或设备位号，自动关联到对应的管道块或设备块，提取相应的数据。
 
简单说，如果管道块和设备块那边已经有了这 5 个属性数据，仪表块里只要在「LOCATION」这个属性里填上管道编号或设备位号，那 5 个数据可以不填了。
 
2、仪表属性块增加型号字段（贡献者张堃）
 
远传仪表，例如液位计，有雷达，磁翻板，液位开关等多种类型，但是在流程图里只有 LI 一种表示方法。而实际过程中，有些位置是需要判断液位计类型的。流量计同理，楔形、质量、旋涡等，也都有特定使用工艺。仪表属性块增加种类这一项，既可以方便业主审核，也可方便工艺自查。
 
3、仪表属性块增加图号字段。
 
4、集中仪表块新增区域覆盖。（贡献者徐骋）
 
流量计放在管道多段线上可直接覆盖底部管道，方便位置拖拽。
 
**设备一览表相关：**
 
1、新增了一个「自定义」设备块。（贡献者张坤）
 
如果设备不属于反应釜、储罐、换热器、输送泵、真空泵、离心机，可以使用这个块。
 
2、定型设备新增工作介质、温度、压力。输送泵、真空泵、离心机也新增这些属性，便于与仪表块数据关联用。

## V0.3 版更新内容

2020-08-03
 
1、新增外管条件（贡献者郑重、沈琦）。

已跟外管对接，接受附件里自动生成的 Excel 版的外管条件。有点着重说明，外管去向里必须包含「去」或者「自」这 2 个字符，后台是根据这 2 个字符判断起点或终点的。

使用数据流提外管条件，目前可以为你节省时间的地方：1）设计温度、设计压力自动计算；2）管道直径根据管道号信息自动提取。3）流速，根据流量及提取出的管径自动计算；4）管道材质根据管道编号信息自动填充；5）管道保温代号、厚度信息，根据管道编号自动提取。

## V0.2 版更新内容

2020-07-28

1、上线电气条件。

CAD 里用命令 gselectric 提取数据，进入网页端工艺模块中的「To电气专业」。

2、设备块的备注信息缩小（贡献者陈李荔），这样信息多的时候不会显得太挤。

3、所有属性做成了移动（贡献者林俊），目前块里的属性都是可拖动的，比如集中仪表里，高低报警符号可以根据使用情况拖动到合适的位置。

4、非标设备块增加添加工作介质信息（贡献者顾川川），总师办之前发了文，目前因多数项目的非标设备不是本公司设计，制造图纸为甲供，因此技术规格不完整会造成实际加工的差错，甚至引起事故。故要求非标设备的技术规格栏中还应填写操作条件，即操作温度、操作压力、处理能力、介质名称等。

5、增加了离心机设备块、真空泵设备块（贡献者李恒）。

6、各个设备块根据常规经验新增了一些必要的关键参数信息。

最后，使用过程中有任何问题可随时与我联系（手机号：15857183324，短号：663324。）