### 优化记录

1、之前做好的管架数据复用。

2、定位间距之前按 50 的倍数，优化为按 20 靠，比如 200、220、240、260、280、300。

### 碎片

1、管架层标高。

2022-05-05

罗安民：外管标的都是绝对标高，加上总图的绝对标高（黄海标高），比如一个管架层的标高是 93.2m。

### 原始版的外管架条件功能产品需求

2022-03-02

输入：

1、系统图里的管道数据。

1、管道、管架图例。

1、管道重量和跨距数据表。

输出：

1、管架剖面图。

1、管架荷载计算书。

1、管架一览表。

1、画 PL 线把管道的数据附着上去，图层。

1、外管架结构条件表。

功能汇总：

功能 1：生成管架剖面图。

功能 2：生成管架荷载计算书。

功能 3：生成管架一览表。

功能 4：生成外管架条件表。

方案一：

步骤 1：系统图上框选管道提取一个管架上的管道数据。

是否可以在此批量提取多个管架的数据暂存，多个管架后续一起生成。

步骤 2：客户端里人工干预：1）管架图例形式选择；2）管架尺寸输入；3）管道顺序调整。4）管道间距在默认数值基础上调整。

步骤 3：CAD 内自动生成剖面图。

方案二：

备注：因为先做管架剖面图再做配管，方案否掉，但里面的局部功能点可借鉴，比如 pl 线附着管道数据

管道安装平面图的模型空间：

1、迁移系统图里的管道数据到管道安装平面图，生成所有管道号图层。

2、调用原生 PL 命令画管道（可弹出面板选择管道或命令行），画出的管道 pl 线自动放置到对应的管道号图层。

3、自动生成管道定位标注和管道号标注。

管道安装平面图的布局空间：

1、框选要生成管架剖面的管道，获取管道信息。

2、选择管架图例，输入管架标高等信息，按管道尺寸、定位间距生成管架剖面。

问题：

1、靠什么信息匹配对应的管架图形。

回复：

4种，T 型混凝土、T 型钢；门型混凝土、门型混凝土

输入尺寸：宽度、宽度。

客户端面板的形式做输入：1）图例形式；2）管架尺寸输入；3）管道顺序调整。4）管道间距在默认数值基础上调整。

1、管架上管道的间距定位信息从哪来。（应该是管道安装图）

回复：

按净距要求生成一版初的，自己调整。

1、剖面图上管道尺寸，罐间距是按比例画的，给的例子是 1:25。保温层好像不是按比例。（确认，应该是要按比例）

1、给的图例里，有 2 个管架一览表，横的和竖的，生成哪个？还是看情况生成。

回复：目前按竖表生成。

1、管道等级表（管道重量设计管径壁厚），先弄一个测试版，后续更新。

回复：调用工艺专业的等级库数据。

1、管道重量和跨距数据表，做成数据库表（枚举）还是通过计算公式。

回复：公式计算。

还需讨论的问题：

1、生成管架荷载计算书，如何提取所有管架的管道数据，可能CAD 里有修改，客户端的数据不是最新的。

2、生成外管架结构条件表的具体步骤，关键是平面图里提取数据 。

需提供：

1、管架荷载计算书里的荷载数据公式。（可以在做计算书时再确认）

荷载结果如何来的。