## 20200615化工厂压力变送器选型的考虑因素

在化学反应过程中，压力影响着化学物料平衡关系和化学反应速度，在化学品存储和流体输送中，压力也与管道、设备的安全性息息相关。

压力的检测和控制对保证化工生产的正常运行是十分重要的。压力检测是通过压力变送器实现的，压力变送器选型不合适或者使用不正确，或者错误的安装都会带来压力测量上的问题，会影响工艺生产中的产品品质，造成生产安全危险性等不良后果。做好压力变送器的选型，需要统筹考虑多方面的问题。

以下针对选型问题，结合规范和工作中的设计经验，归纳总结了压力变送器选型思路和安装上需要考虑的因素，为工程设计提供参考。

### 00. 引言

化工工厂中，压力变送器应用在压力、流量、液位测量的各个方面，根据不同的应用领域，采用的压力变送器的类型不同：

1、在单纯的压力测量中：会采用表压压力变送器、绝对压力变送器。对于非隔膜密封式的压力变送器又可以再分为管道直连式和导压管取压式两种类型。其中直连式的变送器，由于取压口在底部，可以和压力表一样，直接安装在管道上，安装十分方便。对于需要测量差压或者微小压力的场合，采用差压压力变送器。

2、在液位测量中：由于液体的静压和液位高度成正比，可以通过差压变送器来测量液位。

3、在流量测量中：通常采用差压变送器来配合节流元件，来流量检测。

因此压力变送器的选型涉及到各种领域，需要设计人员在选型中统筹考虑到各方面的问题，合理选型来达到测量目的。需要考虑的因素主要有：变送器的安全性、性能指标，环境条件、应用工况、安装条件、与经济性等。

### 01. 安全性

安全性是选型首要注意环节，压力的测量仪表无论在正常生产或故障情况都不应导致影响生产系统的安全，这分为几个方面：

1、压力仪表的耐压能力。在一些工况，工艺的正常操作压力和极端情况下的压力相差悬殊，如汽化器出口管线，这时候就需要压力变送器具备足够的耐静压能力，避免压力变送器超压爆裂，介质外泄的风险。

2、压力仪表的防爆。爆炸危险区域划分图是由电气专业设计的，压力变送器的防爆等级需要满足爆炸危险区域划分图中防爆等级要求。

3、压力仪表的防腐。压力仪表的测量元件的材质需要满足被测介质的腐蚀性要求，需要妥善选择仪表触液材质，避免泄漏的安全风险。对于环境腐蚀较严重的场合，如海边，也需要考虑好变送器外壳材质的耐腐蚀能力，避免减少仪表寿命，带来经济损失。

4、被测介质的特殊要求。对于强氧化性的介质，压力变送器的测量元件还需要做好禁油脱脂，避免产生接触氧化自燃的安全风险。

### 02. 性能要求

压力变送器需要在性能要求上考虑的内容有：1）量程选择。2）精确度。3）重复性、线性度。

#### 2.1 量程选择

压力变送器的量程选择是变送器选型中的一个重要内容，由于各个厂家的各档膜盒的量程会有差异，因此当需要采购变送器时，应先确定所采用变送器的生产厂家及型号，然后再根据工艺测量要求确定变送器的量程，同时考虑一定的调整裕度。

根据设计规范，在测量稳定的压力时，正常操作的压力值应在仪表量程的 1/3-2/3 范围内；当测量脉动的介质压力，正常操作的压力值应在仪表量程的 1/3-1/2 范围内，这也是压力或差压变送器量程选择的基础。由于压力变送器的不同代码的膜盒只能适用于一定的量程范围，以罗斯蒙特 `3051S_T` 膜盒表为例，可见该款变送器分为五种代码膜盒，不同代码的膜盒测量上限差异悬殊。

3051S_T 膜盒 —— 表 1

在确定变送器的量程时，不能选极端，将变送器的使用量程定在膜盒的最小量程或最大量程，因为在生产现场，有时候会因为工艺调整，变更量程，选型需要留有量程调整的余地，避免选择的膜盒无法适用。比如选择膜盒代码 1 时，设定为 0-207kPa 的量程，如果需要向上调整就只能变更变送器了。

对于绝对压力变送器，还需要注意最小量程的取值问题，以几个品牌的压力变送器对比表 2 为例。

表 2 —— 几个品牌的绝对压力变送器的可测最小压力与最小量程

| 绝对压力变动器 | 可测下限（绝压） | 最小量程（mmHg）
| --- | --- | --- |
|  3051(S)CA   |  0   |  15.5 |
|  3051(S)TA   |   0  |  8.625 |
| EJA310    |  0.1   |  5.0 |
|  EJA510A   |  0.1   |  75 |

由表 2 可见，最下量程，和最小可测值各个品牌不同，有的可测下限并不是从「0」开始。对于法兰式隔膜压力变送器，就需要看填充液的饱和蒸气压来确定最小压力与最小量程。

#### 2.2 精度选择

目前主流国际品牌的压力变送器的精度为 0.065% / 0.075%，国产压力变送器的精度相比较低。在正常生产一味得追求高精度其实并没有必要，由于压力的测量精度是一个系统的综合精度，压力的检测信号经过信号传输，控制系统的卡件转换，因此整个系统要考虑到压力变送器的误差和信号传输执行等环节的误差的影响因素。尤其是对于压力调节控制回路，由于调节阀有 2％ 左右的回差，是整体精度的短板，因此对于压力提过高的精确度要求也没有意义。现在压力变送器产品的高精度很多时候也是各产品供应商为了竞争性而提升的结果。精度的选择还是适合根据生产操作的需要来确定。

需要注意的是，仪表样本中的精度值是指引用误差（常用 ％F.S 表示)，代表满量程的百分比精度。大量程比的压力 / 差压变送器只是在一个较小的量程比范围内可达到目标精度。而这也会影响到变送器形式的选择。

同样以 `3051S_T` 为例，根据样本，引用误差为 ±0.055%，当量程比超过 10:1 时，精度如下：

```
精度 =±[0.0065x (量程上限 / 量程）] % —— 公式 1 
```

表 1 中的量程代号 1 的膜盒的量程上限为 207kpa，根据公式 1 可以计算得出：

如果测量目标精度为 ±0.075%，临界量程值为 18kPa，当压力变送器的量程在 0-18kPa 至 0-207kPa 之间调整量程时，精度指标优于 ±0.075%，当量程低于 18kPa 时，就需要根据公式 1 计算附加误差，或者选择临界量程值更低的表压压力变送器或者差压变送器。

1『目前上面的计算示例没弄明白。（2021-01-08）』

#### 2.3 重复性、线性度

重复性、和线性度是传感器的两个重要指标。

1、重复性：是指传感器在输入量按同一方向作全量程连续多次变化时，所得特性曲线不一致的程度。简而言之，重复性，就是重复测量同一个大小的参数，多次测量数据之间的误差。

2、线性度：定义为传感器输出量与输入量之间的实际关系曲线偏离拟合直线的程度。但是对于一些流量温压补偿计算时，为了提高动态计算精度，采取线性误差更低的压力变送器，对减少补偿后的流量计算误差更有利。

根据经验，除了用于贸易结算计量的工况，用于做温压补偿计算的压力变送器有必要高精度和高线性度外，用于工艺控制工况的压力变送器的重复性相对于高精度更重要。

### 03. 压力选型时需要注意的工艺参数

各类压力仪表会受到一些工艺参数的影响，所选择压力变送器要针对更多的条件进一步核对所选变送器类型是否合适。

#### 3.1 高温工况环境

目前主流的罗斯蒙特 3051 和横河的 EJA 的膜盒都可以耐温至 120℃，高温环境下，测量介质的温度较高，过程的温度往往会超过变送器的正常工作范围，并且不能通过导压管把温度调整到正常范围内。那么就可以通过选择远传型变送器利用毛细管引压，避免变送器受到高温破坏了电子元件的使用性能。

需要注意填充液的温度范围，参见表 3。

表 3 填充液温度范围表

| 填充液 | 温度范围（℃） | 相对密度（25℃） | 热膨胀系数
| --- | --- | --- | --- |
|  DC200 硅油    |  -40~205   |  0.934  |  0.001080 |
|  DC704 硅油   |   0~315  |  1.070  |  0.000530 |
| 情性液    |  -45~175   |  1.850  |  0.000864 |
|  Sylther 硅油  |  -75~150   |  0.850  |  0.000666 |
|  甘油和水  |  -15~95   |  1.130  |  0.000190 |

对于采用隔离装置的，需要注意负压，高温的工况。高度真空时，灌充液的沸点大大降低，工艺温度超过填充油在该压力的沸点时，填充液可能会部分气化，气化压力会施加给膜片，同时也施加给变送器传感元件，给测量正偏差要看选用填充液在真空下的适用温度，一些类型不适合真空场合。

#### 3.2 容易结晶的高黏度介质

介质一旦离开工艺设备，就很容易出现结晶现象，如果出现结晶或者介质的黏度太大，就容易导致导压管出现堵塞，不仅需要通过清理疏通而带来较大的工作量，还会造成测量结果不稳定。这种情况下，一般适合选择隔离式变送器，宜配冲洗环。如果结晶现象比较严重，就需要选择凸膜片型变送器。

#### 3.3 腐蚀性的工作环境

腐蚀性工况一般指的是环境条件腐蚀性和应用工况的腐蚀性。

1、应用工况的腐蚀性。

如果管道是碳钢或者不锈钢材质，那么首选普通型的压力变送器。如果介质具有强腐蚀性，压力变送器应采用隔膜密封膜片隔离，其中最关键的选材是膜片材质和法兰材质，膜片材质应根据介质的不同化学特性进行选择，介质的浓度和温度不同，对材质的要求也不同。

隔膜压力变送器的隔膜厚度：一般为 0.06-0.12mm，需要考虑腐蚀裕度的影响，因此防腐能力需要极佳，才能避免腐蚀穿孔，工艺管道材料因为壁厚大，裕度也高。

有几个介质的膜片选材需要比较注意：

1、HF。哈氏合金 C 和蒙乃尔合金是两种常用的耐腐金属，对 HF 的耐腐能力不相伯仲，但是蒙乃尔合金在盐酸中，在常温下只能使用到 15% 的浓度，在 70 度时，5% 的盐酸对其腐蚀性就很强，并且如果充气的话，腐蚀率更高，因此盐酸和 HF 的混酸不能采用蒙乃尔，而 HF 如果含 HCL，就不适合采用蒙乃尔合金。

2、氯甲烷。氯甲烷由于在生产的过程中，氯化氢会有残留，因此耐腐要考虑到氯化氢的腐蚀。

远传涂层（PTFE）膜片一般不推荐使用，可以选用替代金属膜片时尽量选用金属膜片，必须选用涂层膜片时，必须满足以下要求：1）过程温度低于 200 度。2）不存在负压，即低于大气压的情况不会出现。3）介质不含颗粒，即只能是纯粹的气态或液态介质。4）安装时要注意膜片不能过度挤压，避免划伤等。

法兰连接的变送器一般有碳钢、304、316 三种材质可以选择，由于法兰不直接接液，因此，考虑到经济性要素，一般可以选用碳钢材质。

2、环境的腐蚀性。

变送器外壳材质一般有铝合金和不锈钢，在非腐蚀性环境中选用铝合金材质经济性更高，如果处于腐蚀性环境中，则更适合选用不锈钢材质。

#### 3.4 低温的工作环境

对于普通的变送器，膜盒耐低温型可至 -40℃，通过取远引压可以测量更低温介质。对于隔膜远传压力变送器，需要注意选取高温硅油后要注意其黏度大于普通硅油，采用更粗的毛细管，使用温度一般从 0℃起，低温时可能会凝固，要注意环境温度的问题，见图，填充液凝固不会损坏变送器，但会影响测量，应考虑保温，伴热等措施，见表 4。

表 4 填充液的耐温范围表

| 填充液 | 温度范围（℃） | 相对密度（25℃） | 热膨胀系数
| --- | --- | --- | --- |
|  DC200 硅油    |  -40~205   |  0.934  |  0.001080 |
|  DC704 硅油   |   0~315  |  1.070  |  0.000530 |
| 情性液    |  -45~175   |  1.850  |  0.000864 |
|  Sylther 硅油  |  -75~150   |  0.850  |  0.000666 |
|  甘油和水  |  -15~95   |  1.130  |  0.000190 |

可见普通硅油膨胀系数不算低，但由于使用温度范围宽广，价格便宜，得到最广泛应用，除了一些卫生、需要禁油的使用场合，工艺介质中有氯、硝酸、过氧化氢等强氧化剂的场合，不得使用甘油，可以采用氟碳润滑剂或卤烃等惰性液。

#### 3.5 卫生等级要求高的场合

采用卫生型连接 - 卫生型卡子连接 DIN 32676，能有效避免触液留有死角，滋生细菌，变送器外壳需要采用不锈钢材料，无死区，抗冷凝，表面光洁度也有要求。

#### 3.6 高真空的场合

普通压力变送器的测量误差源于参考压力（大气压）变化：当被测对象的真空度恒定时，大气压力升高，DCS 示值降低，反之，示值升高。于是，根据本地大气压的变化，频频更改仪表的下限和量程。高真空下优先选择绝对压力变送器。

#### 3.7 强氧化性

工艺介质中有氯、硝酸、过氧化氢等强氧化剂的场合，不得使用甘油，采用氟碳润滑剂或卤烃等惰性液。

#### 3.8 富氢环境

氢气虽然没有腐蚀作用，但氢分子有渗透隔离膜片的能力。因为氢分子较小，它会进入金属的晶格里面，或当氢分压超过临界值时会引发材料的局部变形，形成金属鼓泡，这种现象称为「氢脆」。甚至有的氢分子还透过金属膜片，进入硅油内部，从而使填充液中含有气体，体积增大，迫使隔离膜片外鼓，造成仪表输出不稳，产生零点飘逸。含氢介质的变送器的测量原件（隔离膜片）选择建议：

1、氢含量为 1% 浓度时：＜100℃ 用 316L，＞100℃ 用镀金或陶瓷。

2、氢含量为 10% 浓度时：＜70℃ 用 316L，＞70℃ 用镀金和陶瓷。

3、氢含量近 100% 浓度时：用镀金或陶瓷。

### 04. 压力变送器在安装上需要注意的问题

#### 4.1 引压管取压的压力变送器的安装

1、测量液体或蒸汽压力时，变送器宜低于取压点，使不必另加排气阀。

2、测量气体（特别是湿气体）压力时，变送器宜高于取压点，使不必设置分离器。

3、对于真空场合，变送器与取压口同在一水平线，或低于最低的取压口。

4、当管路中有突出物体（如测温元件）时，压力取源部件应安装在其前。

5、当检测温度高于 120℃ 的液体、蒸汽和可凝性气体的压力时，直接安装的压力变送器的取源部件应带有环型或 U 型冷凝弯。

#### 4.2 隔膜远传的压力变送器的安装

对于隔膜压力变送器的取压，在水平管道上，如果液相中含气，法兰口宜旋转 45°-90°，避免在接管处形成气泡的聚集，见图 2。

图 2：隔膜法兰接管取压图

#### 4.3 配合节流元件的差压变送器的安装

需要注意管道取压口的要求：

1、气体取压口在管道上部；液体取压口在侧面斜下方，避免沉积颗粒会堵着取压口的；蒸汽的话取压口在管道侧面。

2、测气体的话差压变送器放在管道上方，液体的话放在管道下部，测蒸汽如果有配冷凝罐的话，应当保持冷凝罐在同一水平面高度上。

对于一体式安装的压力变送器，可以配一体化温度 / 压力补偿，但是再安装时，取压口的方向原则不变，因此测量液体有排污问题。对于双法兰隔膜差压变送器的孔板，一般是筒体上带支架，因此，差压变送器不需要与地面高 1.4m。

### 05. 经济性

经济性也是一个重要得指标，体现在在满足工况需求的前提下，用更低的价格实现压力测量功能。除了不同品牌产品价格上的差异外，通过以下几个方面来提高性价比。

#### 5.1 在膜盒的选择上

由表 1 可见：由于大量程的膜盒的量程覆盖小量程的膜盒量程，因此某一实际使用量程可能两个量程代号都合适，本来根据精度最高原则，应该应该选择与最大量程最接近的量程代号。但在个别情况下，如果这两个量程代号的膜盒价格相差较大，也可以这样综合考虑：牺牲一点精度，选用量程更大的量程代号。如量程 0-160kPa，从精度考虑，应该选择量程代号 1，但这膜盒压力范围低，加价幅度反而高，从价格最低原则考虑，可以选择量程代号 2 的膜盒。最后选用哪一个量程代号，应综合这两个因素确定。

#### 5.2 在压力变送器类型的选择上

在测量微压力或低压力时，也有压力变送器和差压变送器两种选择，建议在满足工艺精度需求的前提下优先选择压力变送器，压力变送器的结构相对简单，价格也便宜。但是因为膜盒上限较微差压变送器高的多，测量微压时附加误差较大，需要复核精度，在化工自控设计规定 HG/T 20507-2014 中，5.3.1 条提出，压力测量宜选用压力变送器，测量微小压力（小于 500Pa）时，宜选用差压变送器。这个不能盲目套用，以 `3051S_T` 为例，在 500Pa 时，引用误差达到 2.6%。

因此在变送器的量程选择时，应该根据工艺要求的测量范围选择变送器的量程，在确定膜盒选型时做好以下几点：1）所选变送器的量程在变送器膜盒的测量范围内；2）所选变送器的量程在变送器的确保精度的量程比范围内。

在差压法液位测量中，通常采用隔膜密封式单法兰差压变送器（常压设备）和隔膜密封式双法兰差压变送器（有压设备），由于双法兰隔膜密封件价格昂贵，如果密封的容器的气相空间为氮封。适合采用隔膜密封式单法兰差压变送器，负压室采用引导压管连通氮封管线，这样性价高，见图 3。

图 3：单法兰差压变送器测量带压设备液位

### 06. 结论

做好压力变送器的选型，需要统筹考虑多方面的问题。针对选型问题，结合规范和工作中的设计经验，对压力变送器选型思路和需要考虑的因素做了归纳总结，包括：变送器的安全性、性能指标，环境条件、应用工况、安装条件、与经济性等，为工程设计提供参考。

## 20210110华雷交流压力表选型

### 01

1、选型基本逻辑。

看就地压力表，先看是不是适合隔膜。

隔膜。隔膜的会先涉及到材质的问题。往下走，小于 0.1MPa 的选膜片，大于 0.1MPa 的就是非膜片的隔膜压力表。（振动工况比如泵出口，就选抗震）

非隔膜。非隔膜的先不管材质问题。往下走，小于 0.1MPa 的选膜盒，大于 0.1MPa 的就是普通的非隔膜压力表，即不锈钢压力表。（振动工况比如泵出口，就选抗震）

注意：1）膜片和膜盒都没有抗震的。如果量程比较小，是那种 kPa 级别的，都没抗震的。2）这里的 0.1MPa 是量程上限。

2、标准化的压力表分六档：膜片压力表、膜盒压力表、隔膜压力表、抗震隔膜压力表、不锈钢压力表、抗震不锈钢压力表。

3、工艺条件先做一些处理。1）工艺条件出来条件要先处理，只有就地（PG-XX）和远传（PT-XX）两大类仪表。2）核对流程图里的管道，管道有伴热、夹套的。3）腐蚀性的。4）易凝固介质，比如冰醋酸、液碱，这种介质工艺一般是不做夹套的。

4、抗震的情况：泵的进口和出口、压缩机的进口和出口。

5、比如这次的总包 C3 项目，在连云港，零下 20 度，循环水水管的压力表都选的隔膜，因为水是不会用 2H1 管子、电伴热，所以你不能通过这两个点来做判断。

6、还有一种情况是要用隔膜的，剧毒的介质。剧毒的目前压力表可以不用，没规范要求，是我们院自己提高要求的。但温度计必须用法兰的，不能用螺纹。氨气可以用，但液氯（腐蚀性）不行。

7、隔膜压力表，压力表平时为了省钱，材质优先考虑的是钢衬，如果温度是大于 100 度或者是负压（-5kPa 以上），那么就必须用金属膜片了，这只是压力表。压力变送器都是金属膜片。温度高的话，膜片中的硅油就用「高粘度硅油」，普通的只是写的「硅油」。如果碰到洁净区场所，硅油是不能用的，要用氟油或者卤代烃。

8、隔膜的，优先使用 DN50 的法兰，变更的逻辑详见华雷的选型逻辑里的第 29 条（DN25 的和工字型法兰）。补充：隔膜的是这 3 档，普通的不锈钢压力表和膜盒，连接规格 M20 的，如果管道口径小于 DN15，连接规格都更改为 M14x0.5。不锈钢压力表上面的表头从 φ100 更改为 φ60，精度 1.6 更改到 2.5；膜盒的只改连接规格，上面的表头相关参数不变。

9、之前的逻辑表只是针对化工的，医药的还不太一样。医药的卫生级别的用卡扣连接的，薄壁管的也不同。

10、工艺那边也需要有自查的机制。好几百度竟然用的钢衬四氟的管子。同一个点上，参数（温度、压力）竟然不相同。比如同一个点，自力式调节阀的阀前压力提的是 0.2MPa，储罐压力表又提的是 0.6MPa，根本对不起来。

1『工艺这边，做这种核查的逻辑很有必要。（2021-01-11）』

### 02

就地压力表逻辑：

目的：膜片压力表、隔膜压力表、隔膜抗震压力表；膜盒压力表、不锈钢压力表、不锈钢抗震压力表。

1、是否需要隔膜压力表的逻辑（或）：1）工艺条件备注里包含字段：腐蚀、高粘度、易结晶、易凝固、有固体。2）介质物性：腐蚀、高粘度、易结晶、易凝固。3）所在管道的管道的等级号包含：H、F、N、G。4）所在管道的管道号带有伴热相关符号（S、W、E、J）。5）所在设备的材质：搪玻璃、钢衬四氟、聚丙烯、增强聚丙烯。

压差变送器逻辑：

目标：隔膜压力变送器、压力变送器、压差变送器。

1、是否需要隔膜的判断，同就地压力表。符合条件的话匹配隔膜压力变送器。

2、量程小于 10KPa 的为话，匹配压差变送器。

### 0

2022-12-21

压力变送器的参数调整：

1、测量元件形式（press_element_style）

备注：以下条件逻辑的优先级依次增高。

逻辑1：参考就地压力表那边的逻辑判断隔离原件的形式是：隔膜、膜片、膜盒中的哪一个。

如果匹配出来的是膜片压力表，那么该字段更改为：隔膜。

如果匹配出来的是膜片压力表，那么该字段更改为：膜片。

如果匹配出来的是膜片压力表，那么该字段更改为：膜盒。

逻辑2：如果备注（assembly_comment）包含字符串「高粘度」或者仪表所在管道是夹套管的形式，那么该字段更改为：隔膜(凸膜片,H=200)。

华雷意见（2022-12-21）：

凸膜片这个还是手改吧，直接凸膜片先不做了，检修困难。

## 20210611自控阀门的设计要点

在控制系统中，控制阀直接和控制流体介质接触，不仅是控制系统中最薄弱环节，也是故障率较高的环节。在石油、化工、电力、核工业、冶 金、轻工等领域，都需要根据工艺条件的变化，用控制阀对温度、流量、 压力和液位进行调节。调节对象有高温、低温、高压、腐蚀、颗粒和纤维 等各种复杂工况有些场合还要求防火、防爆。因此控制阀在控制系统中的 可靠性变得十分重要。

『

控制阀是在我们控制环节中最关键的环节，同时也是故障比较高的环节。我们工艺提的温度、压力、流量、液位，最终控制好不好都是要靠调节阀调节以及开关阀正确的执行来实现的。

介质的粘度、温度等都会对控制阀产生影响，因此阀门必须考虑各种工况的变化，还要考虑到防火防爆的要求。

』

### 01. 控制阀组成要素

控制阀由执行机构和阀及一些附件组成。控制阀常见基本分类：

1、按用途：开关型、调节型。

2、按行程：直行程、角行程。

3、按阀内件结构：1）单/双座阀。2）套筒阀。3）三通阀。4）隔膜阀。5）蝶阀。6）球阀。7）偏心旋转阀。

根据工艺变量（温度、压力、压降等）、流体特性（粘度、腐蚀性、毒性、含悬浮物 等）以及调节系统的要求（可调比、泄漏量和噪音等级等）、调节阀管道连结形式（法兰、 焊接）来综合选择控制阀型式。

### 02. 控制阀的选型

1、角行程的控制阀。1）比如球阀、蝶阀、偏心旋转阀。2）角行程阀门的阀芯是和阀杆一起做垂直于阀杆的角度旋转动作。3）启闭迅速，对外漏控制严格时阀杆处填料密封 相对能达到要求，一般不需使用波纹管密封。4）阀杆处二道密封。

2、直行程的控制阀。1）比如单座阀、闸阀、隔膜阀。2）通过阀杆带动阀芯做垂直于阀杆的上升下降动作。3）启闭较慢，对外漏控制严格时阀杆处填料密封 不能达到要求，需使用波纹管密封，外漏密封造价高。（隔膜阀不存在阀杆填料密封）4）阀杆处二道密封，但其中一道密封必须将阀全 开才能起作用，设计目的是填料处漏时，全开阀门更换填料，但应用高危物料时慎用。

『总的来说，控制阀主要可以分为两大类：角行程和直行程。角行程是阀芯和阀杆固定在一起的，一起进行一个旋转动作，特定是适合于开关的动作。因为它是靠旋转密封的，跟直行程相比，它的填料更容易达到密闭性。所以，如果我们采用球阀、蝶阀、偏旋阀这些角行程的阀门，它不一般是需要再采用「波纹管」密封的，因为旋转性密封已经可以达到要求了。但如果采用单座阀、闸阀、隔膜阀这些直行程阀门，因为它的阀杆是通过升降来闭合，填料会与阀杆发生一些摩擦，容易把一些介质夹带出去。所以对一些密封要求比较高，不能外漏的场合，是需要采用二次密封手段，比如波纹管密封。』

### 03. 阀门类型相关

控制阀的选择，选其较为适用或选较低成本。

在一般工况下，有数种阀门类型都可以选择时，一般考虑成本高低，如果工况较为严酷，则需选相应的严酷工况用控制阀。

一般来说直行程控制阀能应用于普通到严酷的大多数工况；角行程控制阀一般适用于那些大流量，低压差的场合，或较经济的场合。

建议：1）调节阀 DN150 以上用套筒阀。2）开关阀 DN200 以上用双偏心蝶阀。

『阀体的选择，首先最主要的考虑的因素是成本。如果工况严酷的话，会用到一些专用阀。一般单座阀（直行程）可以用于大部分场合，而角行程阀门用于更苛刻的场合，比如说有固体颗粒、高压差的。还有一些更大口径的情况，我目前做的扬农项目，成达院做的统一规定，他们提出 DN150 以上的调节阀都用套筒阀，DN150 以下的才会考虑单座阀。大口径的时候，单座阀的密封性和平衡性是不行的。』

#### 3.1 阀体类型

1、直通单座阀。

阀体内只有一个阀座和密封面，结构简单，密封效果好，控制性能优良，是使用最普遍的一种阀体类型之一。1）一般适用于工艺要求泄漏量小、流量小、阀前后压差较小的场合。但口径小于 20mm 的阀也广泛用于较大差压的场合。2）不适用于高粘度或含悬浮颗粒流体的场合。可调比较小，一般为 30:1~50:1。不易做成大口径，直径一般小于 200 毫米。

『直通单座阀是最常规的调节阀形式。它只有一个阀座和密封面，它的特点是不适合用于较大压差的场合，因为它的不平衡力相对于其他阀门来说比较大。同样，对一些高粘度和颗粒度场合也不适用。』

2、直通双座阀。

阀体内有两个阀座和密封面，流通能力大 20-25%，不平衡力小，泄漏量大，切断效果差。一般适用于对泄漏量要求不严、流量大和阀后压差较大的场合，但不适用于高粘度或含悬浮颗粒流体的场合。

『双座阀常用于更大口径的场合，或者是泄露性要求不严的场合。现在对蒸汽、压差比较高的场合，会用双座阀。因为有 2 个阀座，它的阀芯和腔体间内漏量是比较大的。所以，双座阀不能用于切断阀，就是因为它的泄露量比较大。』

3、套筒阀。

阀体内部阀芯由套筒导向套筒上开有窗口用于决定流量与流量特性，阀芯上开有平衡孔，侧面导向，减小不平衡力。一般适用于流体洁净，不含固体颗粒的场合。和阀前后压差大和液体可能出现闪蒸或空化的场合。

『目前项目上，对蒸汽流量的调节都是采用套筒阀。与前面的单座、双座相比，它下面不是一个阀座，它是两个筒之间，是通过空筒的流通能力来实现流通流量的。因为是通过套筒间的孔洞来流通，它不存在像单座阀那样的不平衡力，所以很适合用于高压差的场合和一些像蒸汽一些容易闪蒸的场合。又因为上面有很多孔洞，如果有固体颗粒的话，会对套筒产生损坏，不适用于有固体颗粒的。所以说调节阀选型要考虑到各种情况，调节阀本身是一个阻力件，很少有说在调节阀前面加一个过滤器的，我们是通过阀门选型来达到相同目的的。』

4、角形阀。

阀体内有一个阀座和密封面结构简单，密封效果好。

一般为底进侧出，具有自洁净功能。阀体内不易存积污物，不易堵塞。1）适用于高粘度或悬浮物的流体（必要时，可接冲洗液管），高压差以及含有悬浮物和颗粒物的介质和管道要求直角配管的场合。（必要时，可接冲洗液管）。2）气-液混相或易闪蒸的流体。3）管道要求直角配管的场合。

『调节阀优先情况下是选单座阀（直行程），在一些苛刻情况下才选角形。角形阀有几个特点：1）以前做过的项目角形阀主要用于高压差的场合，因为它的密封面容易进行加硬。这样就可以耐更高的压差、闪蒸等工况。2）配管角度来看，往往用在高压反应釜的放空阀上，或存在直角配管的地方。因为反应釜放空的时候会把一个物料颗粒带出去，而角形阀是一个角状结构，它不像那些平行通道的阀门，固定颗粒不会停留在阀芯处（平行通道阀），它会自己往下走。对于有固体颗粒的就很适合，所以适用于高压釜的放空管。』

5、三通阀。

三通阀有三个出入口与管道相连接，有合流，分流两种类型。适合用于流体温度为 300℃ 以下的分流和合流场合，用于简单配比调节。两流体的温差应不大于 150℃。

『三通阀就是满足工艺的特殊要求，需要有合流、分流控制的情况。但并不是每种情况都适用于用三通阀合流和分流，根据厂家样本来说的话，如果进出口两端的温差大于 150℃，那么就需要分拆成 2 个调节阀了。』

6、隔膜阀。

阀体内部衬耐腐蚀材料以隔膜代替阀内组件。结构简单，流阻小，流通能力大，无填料结构可避免流体外漏。1）适用于强酸，强碱，强腐蚀介质调节与切断和卫生级场合。2）由于受隔膜衬里的限制，只能用于压力低于或等于 1MPa，工作温度小于 150℃ 的场合，口径小于 DN300。

『

医药项目里，洁净区场合下往往需要用隔膜阀。隔膜阀相对于前面几种阀体结构特点，它是通过 2 片隔膜代替阀芯，所以它中间是不存在死角的。对于洁净区里那些要求流体卫生级要求高的，或某些介质的腐蚀性非常强，但是调节性能要求又不高，是很适合用于隔膜阀的。但隔膜阀的特点是，隔膜材质用的是非金属材质，所以不能用于高温、高压差的场景。而且隔膜不能做的太大，对尺寸是有要求的。根据厂家的样本，一般不能超过 1MPa 的。温度不能超过 150℃。口径也不能太大。

还有，隔膜因为反复折叠，很容易受损疲劳，所以也不太适合用没有旁路，连续操作不能检修的场合。所以隔膜调节阀一般是要配旁路的，或者工艺是间歇的或经常检维修的。

』

7、蝶阀。

结构简单，价格便宜，阀体与蝶板可衬各种耐腐材料，常用的有双偏心，三偏心结构。1）适用于大口径（可到 2 米）、大流量和低压差的场合。2）一般适用于浓浊液及含悬浮颗粒的流体场合。3）用于要求严密封的场合，应采用橡胶或聚四氟乙烯软密封结构。对腐蚀性流体，需要使用相应的耐蚀衬里。4）控制性能差，一般提供近似线性流量特性。

『

公用工程，比如水，我们常用蝶阀去代替球阀，蝶阀的特点是很便宜。公用工程上的水、洁净的空气，蝶阀都可以不采用法兰连接，对夹式的就行了。蝶阀要做到开发阀要求的密封，一般是需要软密封的，软密封的形式可以采用橡胶或聚四氟乙烯。因为它直接接触到介质的，要考虑到介质的腐蚀性问题。比如用的是橡胶衬里，就不适用于冷冻盐水的场合，因为氯离子对橡胶是有影响的。

还有，蝶阀里面一般是柔性的软密封结构。但对密封性要求高的，需要采用三偏心结构，就不能采用软密封了，因三偏心结构只能用硬密封。一些经济条件比较好的业主，不会采用前面说的普通蝶阀，更多的是用三偏心蝶阀。现在在做的扬农项目，在 DN200 以上，是用三偏心蝶阀来替代球阀的，他们有钱。三偏心蝶阀是通过阀杆、阀内件、密封面，三组偏心结构来达到密封的目的。

』

8、球阀。

节流元件为带圆柱孔球型体称为型球阀，常用于开关控制。1）适用于高粘度、含纤维、颗粒状和污秽流体的场合。2）调节系统要求可调范围很宽（R 可达 200:1、300:1)、流通比大的场合。3）阀座密封垫采用软质材料时，适用于要求严密封的场合。4）O 型球阀一般适用两位式切断的场合。

『

球阀是项目里用到最多类型的阀门。对工艺来说也有参考意义，跟手阀相比就少了一个执行机构而已。我们最常用的是 O 型球阀，O 型球阀它中间是一个圆柱形的球体，不是完全是球形的，它是通过一个圆柱形的球孔通过旋转来实现开闭的。它适用于一些高粘度、含纤维、颗粒的场合。

用 O 型球阀为了达到密封要求，会采用软密封结构。但是，在一些管线上面常常会采取伴热或者夹套形式，这时候就要考虑密封的材质能够耐得住保温和伴热的温度。有些场景会采用高度伴热，100-200℃，比如导热油的伴热。

』

V 型球阀

节流元件为 V 型缺口球形体。1）常用于控制场合，特别适合于纤维纸浆等介质的调节。公称压力较低，一般小于 10MPa。

『自控专业常常用到的是 V 型球阀，自控往往需要考虑到高粘度、高纤维化的流体的一些调节作用。V 型缺口有利于调节性，如果只是用于 2 位的开关作用，是没必要用 V 型球阀的，用 O 型就型了，V 型是用于调节性的。因为是 V 型缺口，不像 O 型的是一个对称结构，就受力不平衡了。项目里 O 型球阀最高可以耐到 CLASS2500、CLASS1600 这种高压，但 V 型球阀一般最高只能到 10MPa。而且口径也不一样，我们查样本上，最低也只能到 DN40，再小的也没有了。O 型球阀，DN15 的口径都有。』

9、偏心旋转阀。

节流元件为扇型球面，重量轻，体积小，密封性能好，依靠柔臂弹性变形。1）适用于流通能力较大，可调比宽（R 可达 50:1 或 100：1) 和大压差，严密封的场合。2）耐冲刷，特别适合于含有颗粒介质，或冲刷严重的场合，特别适合于饱和蒸汽应用。3）公称压力较低，一般小于 10MPa。

『前面说的 O 型球阀、V 型球阀适用于纤维、颗粒的介质，但有些介质并没有这些，它是在常温下有固体颗粒、会结晶，但在伴热、保温状态下就是流体状态。我们自控上不建议采用保温的单座调节阀来控制的，因为常规的直行程阀门阀杆那边保温不好，有可能会有结晶，这样会磨损阀门。所以像这种常温下会结晶，伴热状态下是流体的介质，我们会采用偏心旋转阀来替代常规的调节阀。』

10、保温夹套控制阀。

调节阀用于高粘度、易结晶、易汽化以及低温流体时，应采取保温和防冻措施。

『自控专业不推荐用保温夹套阀，如果要用的话，必须注明几个要求：1）所采用的夹套阀是全密封的还是半密封的。2）夹套上热媒的进出管，对接法兰是什么，多大的法兰，什么压力等级。这几点要写清楚，否则没法跟管道上的热媒进行很好的对接。』

#### 3.2 阀盖类型

普通型阀盖。适用于常温介质，工作温度：-20~+200℃。

散（吸）热型阀盖适用于高温介质，工作温度：-60~+450℃（和填料有关）。

操作温度低于 -20℃，应选用长颈型阀盖。

波纹管密封型阀盖适用于强毒性，易挥发易渗透，或贵重流体和真空场合。

『

阀盖的作用主要是承接执行机构，和下面阀体的部分连接，然后普通的阀盖用的是常温介质，高温介质或更低温介质，这时候就需要加长型阀盖、散热型阀盖了。低温用长颈型阀盖，后面将液化烃的时候再展开。

前面说了，对于直行程阀，因为阀杆是升降式的，它必须采取更可靠的二次密封环节来避免一些不能外泄的介质泄露，所以这时候会对那些有毒性、挥发性，不能外漏的介质，再比如放空场所，我们会采用波纹管密封，波纹管密封的阀门去做二次保护，虽然后波纹管阀盖，它其实里面还有阀盖的，所以叫二次保护。

』

### 04. 阀门材质相关

#### 4.1 阀体材料

1、阀体耐压等级、使用温度范围和耐腐蚀性能和材质都不应低于工艺连接管道材质的要求。并应优先选用制造厂定型产品。一般情况选用铸钢或锻钢阀体。

2、水蒸汽或含水较多的湿气体和易燃的流体，不宜选用铸铁阀体。

3、环境温度低于 -20℃ 的场合不应选用铸铁阀体。

4、阀内件应能耐腐蚀、耐流体冲蚀以及耐流体经节流产生空化、闪蒸时阀内件的气蚀损坏。

5、高温（450 度以上），低温（-60 度以下），应选择不锈钢材料为阀体材料高压场合（大于 16MPa）最好选择锻不锈钢。

氢气阀门材料：

| 设计压力（MPa）| 材料 |
| --- | --- |
| <0.1 | 阀体采用铸钢；密封面采用合金钢或与阀体一致 |
| 0.1-2.5 | 阀杆采用碳钢；阀体采用铸钢；密封面采用合金或与阀体一致 |
| >2.5 | 阀体、阀杆、密封面均采用不锈钢 |

『

上面说的是控制类型的东西，下面主要说材质相关的。做设计时，阀门跟管道一样，要考虑的温度、压力一个曲线的问题。阀门的耐压性不能仅仅考虑工作的压力，还要考虑到当前使用温度下，材质能承受的压力范围。尤其在一些高温场合。具体材料会在将液化烃的时候展开。

首先，阀体不宜采用铸铁的，现在做项目，起步都是采用锻造的。其次，低温下也不适合采用铸铁阀门。阀门在切断的时候，比如球阀，它中间有个内腔，内腔两边在密闭的时候，内腔还有介质，如果这种介质像液化烃那样受热膨胀，那就会对阀体噪声额外的附加压力。所以，在阀内腔除了考虑常规的工作压力，还要考虑介质受热膨胀造成的压力。

铸件和锻件的要求。对一些要求不高的场合，可以采取铸件。但对一些低温、高温、高压，就需要用锻件了。

我们设计时，无论是自控还是工艺，阀体的材质是根据管道等级表来的。

特殊介质的阀门，比如氢气阀门。下面这个表示来自氢气站规范里的。优先采用不锈钢和铸钢的。

』

#### 4.2 阀内件材料

1、一般选择不锈钢为阀内件材料。

2、在强腐蚀介质中可选用钢衬或其它抗腐蚀合金材料。

3、出现闪蒸、空化和含有颗粒的流体场合，阀芯、阀座表面进行硬化处理。

4、当流体的温度过高及压差过大时，其阀芯、阀座应进行表面硬化处理。

5、最常用的硬化处理方法包括热处理、堆焊、表面硬化处理等。

6、堆焊 STL 工艺复杂、生产效率低，且大面积堆焊易使零件产生变形和裂纹，对金属单座阀等阀门堆焊比较常见，超音速火焰喷涂（HVOF）工艺，硬度最高可达 60-70HRC，集合强度高，厚度 0.3-0.4mm，超音速喷涂是球阀等表面需硬化面积较大的主要工艺手段。

7、硬化处理原则：1）金属单座阀的阀芯与阀座硬化材料及厚度一般是相同的，所以两者硬度等方面参数是一样的。2）硬密封球阀的阀芯硬化强度要稍高于阀座的硬化强度，一般球芯比阀座高 5-10 个洛氏硬度。

『

现在说的阀内件是调节阀的阀内件材料，开关阀和调节阀的阀内件材料的要求是不一样的，先讲调节阀的。直行程的调节阀，它的动作频率高，它对材料的要求相对于开关阀是更高一些的。

下面这张表是国内一家单座调节阀产品的阀内件材质。可以看到，在大于 1.5 个压差时，在 0℃ 及以上，那么就必须堆焊 STL 了。随着温度的升高，允许压差更小，这是在不加硬的情况下。我们现在做项目，很多设计人员仅仅局限于蒸汽要加 STL（发音：斯特莱斯），其实还是应该要考虑到温度和压差的要求的。

STL：只是硬化工艺的一种做法。不管是哪种做法，它做主要的要求，都是要保证我阀内部结构中，阀内件要比阀座的硬度要更高，或者相等。其中有两点不一样：1）金属单座阀，对于调节阀来说，阀芯和阀座的硬化材质是相同的，而球阀的话，阀芯要比阀座硬度要求更高。因为金属球阀，它表面的局部不平，会影响它的密封性。而对于单座调节阀来说，我们的泄露等级没有像球阀那么苛刻，所以并不需要去区分它（但其实是不一样的），阀芯和阀座两个硬度是一样的也能接受。因为对调节阀并不是要求严密切断，允许有泄露量的。所以对硬化来说可以这么写，我们平时有的项目不会这么注意到，有些项目要求高会问为什么这么要求。以前我做蓝天项目，业主的确是有要求的，加硬的时候专门要我把阀芯和阀座的硬度等级专门区分开了，他就是为了对厂家提出要求，避免一些问题。所以说，调节阀和球阀的硬化要求是不一样的。

』

#### 4.3 阀座材料

固定球球阀软密封阀座的压力和温度关系。

1、一般选择不锈钢为阀内件材料。

2、在强腐蚀介质中可选用钢衬或其它抗腐蚀合金材料。

3、出现闪蒸、空化和含有颗粒的流体场合，阀芯、阀座表面进行硬化处理。

4、当流体的温度过高及压差过大时，其阀芯、阀座应进行表面硬化处理。

为了留有安全系数，建议：

温度 >100℃ 且 ≤180℃，PTFE+碳纤维；温度 >180℃，硬密封。

调节阀软密封阀座的压力和温度关系，详见 PPT 的图。

注：三偏心蝶阀只有硬密封。

『

阀座材质我们主要是讲软密封的材质。我们做项目，软件密封是最主要的阀座材质。因为我们很少有那种非常严苛的工况用那种硬密封的（高温、高压差），我们做的项目主要是以软密封为主。

对球阀来说，软密封的温度/压力关系比调节阀要放开的多，单座调节阀相对于球阀来说更加苛刻。PPT 里是一家合资品牌的材质，聚四氟乙烯是比较常见的，聚酰酯、尼龙不太常见的。可以看到，对于球阀，它的软密封，可以做到什么程度呢，在 200 华氏摄氏度（140℃）下，它可以接近做到 10MPa 的压力等级。因为聚四氟乙烯耐不了高温，所以聚四氟乙烯的软密封也耐不了高温。对其调节阀，其要求更苛刻，它的范围下降了。调节阀，纯四氟乙烯的软件密封，只能耐到 1.5MPa，如果是改性材料的话，可以耐到 3MPa，与球阀相比，其范围大大下降了。

我们在做项目时，很多时候是拿着调节阀的这个温度/压差曲线图去套球阀的，但其实球阀的这个图范围更宽，球阀在同样材质下可以耐更高的压力。球阀的结构特点决定了相同材质下可以做的更高。

为了简化（留些安全系数），我们平时建议，在 100℃ 以上 180℃ 以下时就要用增强聚四氟乙烯了，如果温度更高比如 180℃ 以上，就要用硬密封了。这是调节阀的，如果是开关阀，这个受压曲线非常高，10MPa 都可以用软密封。开关阀和调节阀，同等材质的耐压数据是不一样的。球阀的结构简单，阀芯手里简单，更能耐压。

』

#### 4.4 填料

PTFE 聚四氟乙烯填料-聚四氟乙烯 V 形环：

1、适用对于大部分已知的化学品，不能用于熔融状态的碱金属，以及高温的氟、氟化氢等介质。

2、度极限为 -40 至 +232℃。温度大于 200℃ 或温度低于 -35℃，填料选择柔性石墨。

3、不适合于核工况，因为 PTFE 很容易被辐射破坏。

4、当流体含有固体颗粒时，阀门中不能使用 V 型聚四氟乙烯填料。

柔性石墨填料-石墨片：

1、适合于高温工况。

2、阀杆摩擦力高，阀门回差大。

3、不能用于王水、浓硫酸、浓硝酸等介质。

4、适合的温度范围：-196℃~815℃。而且在其它零部件耐温允许的条件下，可不采用加长型或散热型阀盖。

『

填料的目的主要是避免阀门内部的介质通过阀杆往外泄，填料是非常重要的一个环节。常规项目，优先是采用四氟乙烯。四氟乙烯被称为塑料之王，比较耐用，四氟乙烯的特点是不耐高温，还有一些化学介质也不耐，比如氟化氢。温度过低，也不适合用四氟乙烯填料。四氟乙烯在低温下虽然不会坏，但其膨胀系数有问题，收缩性很强，温度越低收缩的越厉害。所以温度低于 -40℃ 也是不能用聚四氟乙烯的。塑料都不耐辐射，所以四氟乙烯也不适用于核工况。如果有固体颗粒，我们会用更耐磨的材料，比如石墨材料。固体颗粒的场合不多，我们主要是考虑到一些含催化剂的反应釜的放空。

填料的材质除了聚四氟乙烯外，还会用到就是柔性石墨。它的耐压耐温比四氟乙烯更强，所以在一些项目里为了厂家的选配，为了业主采购方便，会尽量让填料的材质统一起来。有些介质是浓硫酸、王水等强酸，它会与石墨反应的，这种就不适用了。

如果不考虑阀门摩擦力高，阀门回差大的情况，其实项目里是可以统一填料的材质采用柔性石墨填料的，只要石墨材料能够耐项目里的数据，这个是可以统一掉的。

后面会讲到散热型阀盖，散热型阀盖主要的目的就是为了保护填料，如果填料的耐温性采取了柔性石墨（不像四氟乙烯不耐高温），那么就可以不采用散热型阀盖。因为就算不保护它，阀杆不够长，自己也可以承受。

』

填料函类型

有弹簧单层填料：

1、标准配置模式。

2、V 型自密封填料。

3、弹簧产生预紧密封力，保证填料的低压密封。

无弹簧单层填料：

一般用于高中压阀门、需要填料的预紧力较大，摩擦力比较大，需配备阀门定位器。

隔离式双层填料：

1、密封更可靠、安全。

2、对毒性较大的流体或温度高于 200℃ 的场合，应选用双层填料结构。

角行程控制阀填料：暂无展开信息。

『填料函形式我们一般采用单层有弹簧的填料，这是常规的形式。一层填料，上面有螺栓压起来。但在设计规范中有要求，对于剧毒的介质（或温度高的），必须要采用双层填料。如果设计深度够的话，这个可以做一个区分的。』

### 05. 开关阀的浮动/固定式球阀

#### 5.1 浮动球球阀

浮动球球阀关闭时球体与下游阀座的密封：在介质压力作用下，球体能产生一定的位移并紧压在出口端的密封面上，保证出口端密封。

浮动球球阀的特点：结构简单，靠介质压力形成密封比压并实现密封。因此，浮动球阀不宜用于较大尺寸的场合，否则，当介质压力较低而球体较重时，切断密封的效果变差，甚至不能密封。

『

我们平时做项目，开关阀，如果没有一个清晰的备注，是没有表示出来，你阀门是固定式的还是浮动式的。项目要求高的，比如扬农项目，会要求备注出来。

浮动式球阀是用的最多的。浮动式球阀的特点是只有阀芯的上面部分与阀杆相连的，它下面是浮动的。在流体的压力作用下，它上面会有一些轻微的摆动。它使得阀体往下游的这个阀座进行紧密密封。浮动式球阀的原理是，通过上游和下游的流体的压差，来实现阀体的密封性的。它这样的好处是结构简单，因为是压差密封，是单侧密封，这边压紧了另外一边肯定就松了（低压侧密闭紧高压侧肯定就密闭松了）。又因为好一个下球杆的固定，结构简单，不光是阀门密闭，它与固定式球阀还有其他的区别。

我们平时用的都是浮动式球阀，它的特点是结构简单，而且价格便宜。但它的口径不能做的太大，根据一般厂家的样本，DN200 口径以下是可以做到浮动球阀的，DN200 以上就不能做浮动式，得做固定式球阀了。我们普通化工项目，DN200 的算很大的管子了。

浮动式球阀是靠球体进行摆动，阀座是固定的，球动阀座不动。因为是靠压差来密封，如果阀门的压力非常小，比如天然气项目，天然气管道的压力才 0.0X 个 MPa，几十 KPa，它没有压差，其密封性就没那么好了，所以对于低压的工况，也不能用浮动式球阀。

』

#### 5.2 固定球球阀

固定球球阀的密封方式：浮动阀座，受介质压力后，阀座产生移动，使密封圈紧压在球体上，以保证密封。

固定球球阀的特点：固定球阀的球体是固定的，受压后不产生移动。操作扭距小，适用于高压的 阀门。不需要介质的压力就能实现密封，密封可靠，容易实现双向密封，故常用于大直径情况下。

『

球体是固定式的，所以必定要阀座是可动的。如果两个都固定，那么中间是没有间隙了。没有间隙就不能达到 XX 密闭。固定式球阀的密闭特点跟浮动式球阀完全不一样的。浮动式球阀是靠压差让球体进行摆动，跟阀门进行紧密连接实现密封的。固体式球阀是看球体介质流向中，有一个小小的通道，流通过去以后，正好推动它的阀座，阀座上本来就有一个弹簧力。上下游的压差也可以帮助阀座向球体那边靠，固定式球阀的密封特定是，球体固定，阀座浮动。这个特定引出一个问题：如果球体中间压力更高，那岂不是阀座往外移了么。固定式球阀还有一个特点：如果球体中间压力高，它的阀座就往后移。这个并不是其缺陷，这个特点反而可以避免内部压力积存，算是一个自动泄压手段。

固定式球阀是靠两侧的压力往下移，上面有压力下面也有压力，它可以通过上下游的阀座往球体中间位移，实现双向密封。可以用于严密密封的工况，也可以用于低压的工况。就算是压力非常低的介质，它阀座已经有弹簧力了，也可以实现密封。但因为结构复杂，所以造价比较贵。我们做项目，除了一些苛刻的工况，或者大口径的，否则一般不会选固定式球阀。现在在做的扬农项目，DN200 以上的球阀，都是采用固定式球阀。或者一些高压、液化烃的球阀，我们也是采用固定式球阀。

』

1『没听清，没有间隙就无法达到什么密封。这里与疑惑，没间隙不是更好么。（2022-08-30）』

双截断和放泄（DBB）功能

阀座的结构设计成：阀门处在关闭位置时，阀座的两侧在压力的作用下均可密封。

拧开阀体底部的放泄塞放泄阀体中腔中的压力。

『固定式球阀是两边阀座进行压紧，那么中间空腔就肯定会留存一些介质，不像浮动球阀是靠一边压紧，另外一边还能往下游流动。有介质留存在空腔会存在一些风险，比如会结晶、相变等，需要即使将其排放掉。所以对固定式球阀，得配放泄阀。在两边进行密封的时候，可以把中间放开。』

### 06. 阀门的防火和防静电

SH/T3059-2012

石油化工管道设计器材选用通则中第 7.7.2 中用于工艺物料及极度、高度危害介质和可燃介质管道的球阀、旋塞阀及其他通用结构的特种阀门，应有防火和防静电结构。

#### 6.1 阀门防静电结构

只要阀门密封副中有一方采用了绝缘体，密封副在上下或转动过程中，由于磨擦就将产生静电。由于绝缘体有集聚静电的危险，静电能引起火花，而火花又可能造成介质爆炸，所以为有效的防止静电的产生，就须使球体、阀顶、阀杆和阀体之间导电，从而把静电引出。目前，国内外通常采用弹性元件的连接方式，将静电经过弹性元件引出，在电源电压不超过 12V 的防静电电路应具有小于 10 欧姆电阻的导电性。

『

防静电是非常有必要的。阀门的组件里有软密封等，这些是非金属材质，在阀杆的动作中，它会有摩擦，会产生静电。在易燃易爆介质中，如果还有氧气是非常危险的，所以需要放静电。

防静电，一般是在球体、阀顶、阀杆和阀体之间导电，通过弹性元件的连接将其导出。

如果阀门要求有防静电结构，一般厂家有几个手段：1）加一个弹簧，通过弹簧把一些钢珠弹性元件顶出来。顶在一些金属的填料函的外侧，进行一个静电连接。像这次扬农项目，液化烃阀门都备注了防静电结构。2）球体和阀杆，还得加弹簧，中间有空腔，避免空腔有空气导电不敏感，还得加弹簧片。所以说，主要是通过阀杆、球体还有跟阀座的一些弹性结构进行导出。如果阀门数据表里有注明防静电，厂家就要做相关的措施。 

』

#### 6.2 阀门防火结构

无论是浮动球阀还是固定球阀，阀座的耐火结构的原理是一样的。即在阀座密封面完全失去作用时，阀座金属面能与球接触，达到暂时密封。

AP1607/API 6FA - AP1607: 旋转 90° 的软密封阀座阀门。

失火前阀座与球体和阀体的密封。

『

无论是浮动式还是固定式球阀，其防火结构是一样的。只能靠金属的才能防火。我们平时提防火要求一般是提 API607 这个防火标准，这个标准主要是针对旋转 90° 的软密封阀座阀门。如果你不是旋转类阀门，比如单座阀、截止阀，那应该用 API 6FA 规范标准。

具体的例子。一个软密封的球阀，失火前这是软密封层，着火后，它的软密封层因为非常烫，烧化了，损耗后中间肯定会有空腔，有空腔流体流过就起不到密闭效果了。这时候就必要要用弹簧结构去把这个阀座往前推，使得软阀座后面的金属阀座与之相连。结合前面的知识点，这个结构是典型的固定式球阀的结构，所以说你注明的是软阀座、有注明是用 API 防火标准，其实它的这种弹簧推动是固定式球阀。如果你用的是浮动式球阀，有注明用 API607，其实是不存在的。我们自控专业因为平时阀门里没有体现是固定式球阀还是浮动式球阀，往往有注明用 API607，可能是不对的。球不懂阀懂才能实现 API 的这种防火要求。

』

#### 6.3 阀门的泄压结构

《液化烃球形储罐安全设计规范》SH3136-2003

液化石油气上的阀门主体材质宜为碳素钢，并具有与罐体一样耐低温及抗 H2S 腐蚀性的性能。切断阀宜选用介质截止阀，当选用闸阀和球阀时，其阀门带压阀腔卸压机构。

腔体的热膨胀效应。场合：1）高温系统的隔离阀。2）容易受环境温度影响的液化烃介质。

下游阀座顶离球体方向的活塞效应。

固定球阀阀门关闭时，当中腔压力升高到大于阀座预紧力时，将阀座环推开，向低压侧（通常指下游）排放。

浮动球阀当阀门关闭时候，为了确保中腔残存介质不会因为温度聚变出现异常升压情况，在球体紧靠上游高压的位置钻一个通孔，用以泄放中腔压力。

『

《液化烃球形储罐安全设计规范》里提到，液化石油气的阀体，如果是闸阀或球阀，阀门要带压阀腔泄压机构。前面有提到过，当球体隔断的时候，因为里面有空腔残留，里面的介质会产生热膨胀的效应，会对阀门有比较大的影响。

涉及到热膨胀主要有 2 个场合：1）高温型隔断阀。现在很多项目里，高温反应器，它的进料物质可能是化工品物料，工艺提开关阀条件的时候，提的是进料的物料温度，比如是常温。但实际在反应的时候，开关阀是切断的，开关阀里内部的温度是反应器的温度，可能是 200-300℃。所以设备上进出口的隔断阀，那么这些切断阀其实经历了从进料常温的状态到反应时高温的状态，如果阀门热膨胀性很高那么就有风险。2）还有种情况是反应温度没那么高，比如液化烃，它的热膨胀性非常高，LNG 吸热膨胀成天然气，会膨胀 600 倍，压力非常高的。所以对一些高温的隔断阀以及容易受温度影响压力急剧变化的工况，就必须要考虑阀门腔体的泄压问题。

前面提高，如果采用固定式球阀，因为它有阀座活动这个特点和优势。所以如果是固定式球阀，是不需要采取额外的措施去主动泄压的，泄压直接是往低压的地方泄压的，哪边压力低，它推着阀座往哪边移。但如果是浮动式球阀，那就没有自动泄压的措施，浮动式球阀是阀芯往阀座靠，阀座是不会动的，压力憋在里面是不会自动泄放的。浮动式球阀，只能采取在上游高压侧，钻个洞再放个泄压阀才行。所以浮动式球阀有个比较大的问题是，泄压是往环境里泄压的。不像固定式球阀，泄压是往下游泄压的。

』

1『这个时间节点才意识到，提到的这么多次的球阀其实是指代「开关阀」，单座阀指代「调节阀」，本次培训主要就是讲开关阀和调节阀的。（2022-08-30）』

### 07. 执行机构

执行机构是将计算机的输出信号转换成控制阀所需的推力或力矩，来控制阀内件的位置，改变操纵变量的数值。

按能源供应分为：气动、电动、液动、电液或气液式。

偏心旋转阀执行机构的注意问题：偏心旋转阀门注明流向。

『

常规一般就电动和气动两种常用结构，气动最常用，因为起源折算下来更便宜。常规项目用气动的没问题，但对于一些阀门需要反应迅速，可能就需要采取别的形式了，比如电动形式。气动有滞后性，电动的就没有滞后性。对于一些高力矩的场合，会采用电液形式。

现在在罐区里，采用的气动阀门，因为气源管路的敷设，有气源损失量，成本比较高，那么就会采取电动、电液的形式。这两种形式在系统罐区规范里都可以适用的。但是电动执行机构，有个特点是没有故障位，一些罐区项目里，如果要求一定要有故障安全位，有不适合采取气源（没有气源），那么就只能采取电液形式，它不仅可以用于高力矩场合，也可以用于必须有故障位的场合。

有种特殊的执行机构需要注意，那就是偏心旋转执行机构。设计提条件是需要注意安装位置，偏心旋转执行机构它的头是靠侧安装，需要提醒管道专业，流量的哪边（左手边还是右手边）需要预留出安装位置。它的执行机构头是很大的。

』

#### 7.1 阀门附件

电磁阀：防爆、电源、直动/先导、线圈、二位三通/二位五通。

定位器：防爆、智能/机械。

『

电磁阀、定位器都是阀门附件，它们都是将一些气信号转化为电路信号。电磁阀是给开关阀用的，定位器是给调节阀用的。但这两个也不是绝的的，电磁阀和定位器也可以配合起来，以实现一些「保位」的功能要求。自控选型中要注意，电磁阀和定位器术语电动设备，要考虑到一些防爆、电源的要求。设计中要考虑怎么利用外部件来实现工艺的要求，我们平时基本上都是采取气开、气关的一些做法。但是有些调节阀、开关阀工艺要求必须实现动态保位，那么就需要通过一些外部件（保位阀）来实现。通过保位阀来实现一个单作用调节阀的保位作用，单作用调节阀常规是用实现故障开故障关的作用，如果要实现保位，必须要用保位阀将执行器堵住，来实现这个功能。

自控专业是接受工艺条件需求来定故障位还是故障保位，要通过选择合适的附件来实现这个功能。

』

外配件实现功能：

单作用调节阀-保位

保位阀：适用于当气源压力低于给定值时， 要求调节阀保持在某一位置上的场合。

双作用调节阀-保位

#### 7.2 手轮机构

未设置旁路的调节阀，下列情况应设置手轮机构：1）需要限制阀开度的场合。2）对于大口径和选用贵金属管道的场合。

但对工艺安全生产联锁用的紧急放空阀和安装在禁止人进入的危险区内的调节阀，则不应设置手轮机构。

『我们平时调节阀都是要配手轮的。但对于工艺安全用的放空阀，或者人员不能进出的场合，是不用配手轮的。因为这种场合本来就是不能手轮操作的，你还给它配一个手轮，那么不就「故意」让人去手动操作么。还有对一些限制开度，还有一些大口径场合，也是可以配手轮的。』

#### 7.3 快排装置

1、装在执行机构气路上用于气体的快速排放。

2、实现阀门的快速动作。

『有时我们为了配合一些快速动作的场合，比如工艺要求这个阀门动作小于几秒，当阀门口径很大时，常规阀门是做不了的，我们会根据阀门的气开气关形式，来选择它的快排机构，让它的放气可以快一点。』

#### 7.4 储气罐

存储一定数量的空气以备发生故障时和临时需要时紧急使用。

『规范上都提到要有储气罐，其实是指如果你采取的是没有故障位的阀门，比如说是双作用阀门，但是你工艺有没有阀位要求，或者有没有安全联锁要求，比如阀门联锁要求关的，但阀门故障又要求保持，那么就必要通过储气罐来实现了。储气罐是为了保障你的阀门不受气源稳定性影响的措施。』

### 08. 特殊阀门类型

#### 8.1 陶瓷阀门

高硬度颗粒介质切断。

硬度 HRA87 氧化锆。

热冲击量 100℃ 长期温度 456°，最大 Class600。

适用场合：钢厂脱硫、钢铁厂喷煤、多晶硅场合。

价格是普通碳钢阀体的 3-5 倍。寿命：调节阀 3 年，开关阀 5 年。

『对于一些固体颗粒特别多的场合，我们是需要陶瓷阀的，以前我项目就接触到过。陶瓷阀的特点是，它特别硬，但特别不耐温度（如果温度变化快速急剧）。』

#### 8.2 釜底阀

釜底阀是借助于阀门底部法兰（凸缘）焊接或法兰连接于反应釜或储罐和其它容器的底部，因此，消除工艺介质通常在容器出口的残留现象，实现排空、排净的功能。

釜底阀的分类：

1、按开闭形式：上展式、下展式。

上展式：阀门正确安装时，阀杆向上运动，阀门打开，为上展式；上展式釜底阀，阀芯在阀门体外动作，其阀门体积更小，但需要设备内有一定的操作空间；当釜底结构无法满足上展式这个要求时则选用下展式，让阀芯向阀内动作。

下展示：阀杆向下运动，阀门打开，为下展式。下展式釜底阀，阀芯在阀体内动作，阀门体积更大，无需操作空间。适合于框式锚式反应器的反应釜放料。下展式放料阀为阀瓣（柱塞）向下运动阀门打开，打开时运动方向与介质作用力相同，因而打开时较关闭力矩小。

『

工艺提条件很多没提清楚是上展还是下展，只是提的釜底阀。上展阀，它的阀芯，它是在上面的设备内部进行动作，它是阀杆往上动作。这种特点造就了上展阀的阀体可以做的比较小，因为它不需要阀内件动作的空间。但是它对反应釜的内部空间就有要求了，如果你反应釜的搅拌桨是那种比较大的框式的，那么底部空间就比较小，那么就不适合用上展式底阀。

上展式底阀的优点汇总：1）阀门空间小。2）上展式阀可以做成耐腐蚀的，比如钢衬的。所以我们很多项目用的搪玻璃反应釜，那么配套的是上展式底阀。上展式底阀的缺点汇总：1）阀芯只能往设备里伸，为什么采用釜底阀，是因为釜底的料粘稠，可能会结晶。采用上展式底阀，它是往上捅，里面的物料是存积在里面的，如果粘度太高是不能自流干净的。或者如果没有其他的处理手段，物料会堵在下面了。这种情况下能采取的措施：阀门带特殊结构往里加抽气管线，或者是采取下展式调节阀。

下展式底阀的阀芯是往下动作的，它的阀芯可以一直往下扫，扫到下部。对它的阀杆，是一种自清洗和自刮的模式，可以刮的很干净。因为是往下动作，行程长，阀门会很长，体积会很大。同样材质、同样口径，下展式底阀比上展式的贵 30% 左右，体积大价格贵。如果反应釜的内部空间狭窄，或者物料粘度很大，我们肯定采取下展式底阀。同样，下展式底阀要配套阀体的外清洁管件进行再次清洁，这样效果更好。

』

2、按行程：直行程。

3、按阀内件形式：碟片式、柱塞式。

碟片式：碟片式釜底阀阀芯为阀瓣结构，阀杆较细，行程较短，阀门动作时，阀芯始终在流道内动作；物料排放时，阀芯退至流道内的底部，不可避免地将阻碍物料下排，排放不畅。

柱塞式：柱塞式釜底阀采用阀芯阀杆一体化设计，阀芯为柱状结构，阀杆较粗，行程较长，阀门动作时，间芯可完全退至流道外；物料排放时，间芯对物料流动无影响，排放更流畅。

注意：只有下展式一种。

『碟片式底阀，就像一个马桶塞。柱塞式底阀，它的阀芯就是一根棍子，直接往上捅。这种结构的特点：阀芯退的更彻底，退的干干净净，把这个通道完全清扫掉。因为是棍状结构，它做不了钢衬四氟的。阻塞式的只能是下展式的，不可能往上捅。蝶片式的既可以做上展式的也可以做下展式的。另外，碟片式的可以做一些软密封结构，阻塞式阀门它的杆子只能做硬杆，只能采取合金，一般是要堆焊的，因为是要考虑固体颗粒，加强它的寿命。』

阀门材质：其密封形式可以有软密封和硬密封。根据需要时封面均可堆焊有硬质合金，硬度可达到 HRC44。其金属硬密封（锥形密封面）可以保证密封等级达到 V。

价格：柱塞式的阀门相同口径下一般要比碟片式的高出 3 成左右。

特别要求：

1）阀体带清洗或排放喷嘴，可以对阀门进行清洗、排堵，增加了阀门的可靠性。

2）保温夹套，可以根据工艺要求保护阀内介质不会在常温下凝固或结晶。

3）釜底阀的出口角度可以选择 45°/60°/90° 默认 60°。

4）釜底阀带温度测量。当生产上需要测量反应釜底物料的温度，而反应釜底有盘管无法安装温度计，可以选择带温度测量的釜底阀，温度计就安装在阀芯处，能有效地测量釜底物料的温度，满足了工艺的测量要求。

需要注意点：

1）釜底阀的开口尺寸大小、压力等级以及所用的标准都需与设备上的法兰一致。

克服釜底法兰接管死区的影响，釜底阔的阀座采用了凸出设计，阀座结构如图 1 所示。阀座凸出部分的长度 z 与外径 d 可根据设 备管口的尺寸进行制造，与其匹配，确保凸出部分伸人管口内， 并且两者之间。

2）釜底阀的阀芯表面需与釜底面相平。

3）如选用上展式阀门需确保釜底有足够空间满足阀芯行程范围。比如搅拌器的位置。

4）高粘度介质采用阻塞式阀芯。

5）反应釜材质为搪玻璃。鉴于搪玻璃材质的特殊性，安装釜底阀时容易使搪玻璃表面损伤，所以，采取让设备制造厂商统一集成釜底阀的措施，来减少安装上可能带来的麻烦，而釜底阀的性能由设计来确定。

『

釜底阀可以考虑再加保温夹套，来进一步避免介质结晶。

釜底阀的角度要注意，45、60、90 是可以选择的。

上展式的还是下展式的要写清楚，不然常见没法选。

可以配一些清理管线。

釜底阀一个特殊的地方是阀芯直接插到设备里的，所以它可以带温度传感器的。反应釜的温度计可以直接放到放料阀这里的，自动温度传感器还是比较方便的。

选釜底阀要注意，它里面有个凸件，也有可能没有凸件。如果有凸件的话，要跟设备口做一个匹配（上展式阀门）。

搪玻璃的材质很容易挂坏，所以还是让厂家一起带过来比较好。这样可以避免自己选的，安装尺寸有问题，那么会磨损搪玻璃釜的表面。

』

#### 8.3 低温阀

国外资料将不同气体在常压下液化温度分为六个温度等级一般将 -29~-100 为低温，-101 以下为超低温。

低温阀的泄露风险：

1、密封在低温下产生变形，当介质温度下降到材料发生相变产生体积变化，导致密封不良。

2、法兰连接泄漏：由于连接的紧固件在低温下材料之间收缩不同步产生松弛导致泄漏。

低温阀材料选择：

主体材料选择首先避免低温脆性，选择适合低温工作下的材质。

1『 PPT 里有张表，列举了各类材料最低使用温度。（2022-08-28）』

材料的默认出厂状态如冲击不满足设计要求的，要额外提出冲击。

『

低温阀我们平时接触的比较少，这次总包项目我们接触到一些低温阀。低温阀只要是指液化烃介质的阀门。像一些空分的项目，肯定会用到超低温阀门。低温阀有一些风险：泄露性风险。当它里面的介质温度下降，介质一般是带压状态。在装车工况下，介质充分气化，会带走大量的热，装车时温度回到 -110℃。低温下会有密封的变形，比如四氟乙烯等非金属柔性材料，温度下降时肯定会发生变形，如果变形到一定的程度就会密封不行。还有法兰连接件的泄露，主要是螺栓螺母和垫片，这些组件低温下材料之间收缩不同步产生松弛导致泄漏。前者与材料、选型有关系，后者做过 MG 项目，在安装前必须进行预冷，而且这个阀门如果关闭了，还必须有一小段物料进行回流。这样在关闭状态下，它不会因为上有没有物料而到常温，必须要有一个冷流回流来保证其在低温状态。

低温阀门只会考虑耐低温的措施，不会考虑到耐高温的情况。

液化烃阀门，需要考虑到一个低温冲击的问题，材料的默认出厂状态，冲击不满足设计要求的话要提出冲击要求。像这次做的扬农项目，液化烃的阀门，数据表中都备注了 -190℃ 冲击实验，到时必须要厂家提供项目的试验材料数据。

』

填料材料的注意问题：1）氟塑料随温度降低的缩量很大，容易密封性不良，引起泄漏。2）石棉填料不能避免渗透泄漏。3）橡胶在天然气介质有泡胀性，低温不可采用。4）低温阀门一般选择柔性石墨填料，无渗透性，自润滑性，温度范围高。5）一般通过结构设计使得填料接近环境温度下工作，长颈优点。

阀内件材质的注意问题：1）软密封：四氟乙烯不能低于 -70℃，聚三氟乙烯用于-162℃。2）硬密封：采用硬质合金对焊。3）阀杆：奥氏体不锈钢。

低温阀其他注意事项：1）防超压。

『

四氟乙烯前面说了，温度下降的话，其冷缩量非常大，密封性不行；石棉材料跟家里面被子一样，是不可能堵住水的；橡胶材料在一些场合可以，但天然气介质对橡胶有泡胀性，橡胶接触天然气就会膨胀。所以说，对于深冷，比如 -100℃，一般都是采用柔性石墨材质的。

柔性石墨材质有几个特点：1）温度下降时，缩量非常低，没什么缩量。2）没什么渗透性。3）不可能泡胀，它非常惰性。而且石墨是非常好的润滑剂，非常适合做这种填料。

低温阀门，会考虑采用加长阀杆。工作温度 -30℃ 以下就会采取加长阀杆了。加长阀杆的主要目的就是使得填料温度达到接近环境温度。前面也说过，当填料的温度可以耐得住当前工况下的问题时，我们可以不用加长阀杆，但那种情况主要是说高温工况的。低温情况不一样，推荐优先使用柔性石墨，它可以适用于极端的工作温度，-100~-200℃，但我们还是要采用加长阀杆，这时候不是为了保护填料，是因为对液化烃或 MG 介质，如果你在阀杆这边，如果阀杆很低（无加长阀杆），如果介质往上渗漏，那么肯定是很低温度泄露的，它一泄露马上会膨胀吸热结冰，结晶物会卡在阀杆和填料之间，就会造成刮擦和磨损。如果是用加长阀杆，如果泄露的话是沿着一个比较长的通径缓慢泄露的，不太会结冰，那么对内部阀杆的磨损就不会很大了。同时加长阀杆在低温下还有一个优势，可以进一步进行热水式的保障。

软密封材质的阀座，阀座是没有冷缩性问题的，我们可以用软密封，这个时候需要考虑材质的耐受性。对于聚四氟乙烯是 -70℃，-70℃ 还是需要软密封的话，就得用聚三氟乙烯了。

低温阀要有个防超压措施的。前面也说了，固定球和浮动球的做法是完全不一样的。

』

### 09. 化工品储罐根部阀选择

1、储存汽油、煤油、柴油等无特殊腐蚀、无固体杂质、高黏度介质的储罐，罐根控制阀宜选用普通型单闸板闸阀。阀门口径小于 DN150 时，宜选用单闸板楔式闸阀；阀门口径不小于 DN150 时，宜选用单闸板平板闸阀。

2、储存苯等对橡胶等有机物溶解性较强的介质的储罐，罐根控制阀宜选用双闸板闸阀，避免介贡对阀板与阀座间密封环溶解损坏，导致阀门内漏。

3、储存液化石油气、丙烯、氨等介质的压力罐，根据目前的制造水平，综合可靠性、可用性施也高，建议罐根控制阀宜采用球阀。

4、执行机构类型选择：气源管配线工程量、故障安全要求。

5、实现故障关的方式：建议口径大于 DN300 的阀门选用双作用式双气缸执行机配事故风罐。

『

储罐根部阀属于静态流体的阀门，不同于那些管线高压差、流动介质的阀门，我们可以对这类阀的要求放宽一些。以前做的仓储项目，很多情况下，储罐的根部阀一方面是考虑造价，另一方面本身工艺要求比较低，一般不会用球阀，用闸板阀（闸阀）。管道口径 DN150 以下的用单闸阀，单闸阀一般是用橡胶进行密封的，如果是苯或其他一些介质，这些介质对橡胶是有腐蚀性的，如果还是要用闸阀的话那就就得用双闸阀。

对于液化烃介质，在规范中明确有规定的，要用球阀不能用闸阀。

一般有两种工况，一个是大的仓储罐区，一个是小的化学品罐区。对于大的仓储罐区，前面也说过，如果开关阀采用的气动，考虑到气源量的问题，可能会采用电动阀或电液阀。

储罐根部阀，一般进料阀的话是跟安全相关的，一般都是要跟液位计联锁，一般都是要配故障位的。但是对大的仓储项目，口径很大的话，带有故障安全位的阀门，比如单座的故障关的阀门，价格非常贵。从造价的角度考虑，可以采用双作用执行机构，如果工艺有安全要求的话，一定要配气罐，价格就下来了。如果是总包项目，那么 DN300 以上就要采用双作用阀门再配气瓶是比较好的方案。

』

1『通过上面的信息才意识的，FC/FO 是自控阀门故障位的设置，其实并不是所有自控阀都要设置故障位的。』

防火要求：阀门处于火灾区域时，在有限的时间内，能够远程关闭罐根阀，或罐根阀因受热而自动关闭，阀体不破裂泄漏，阀内件不内漏，阀盖处不外漏。

1、阀体防火：金属密封或满足 AP1607 的软密封；阀门高温下耐压性耐温性要求；阀门过程连接方式：不能对夹式。

2、执行机构：单作用/双作用。

3、电源失效问题。

4、阀门密封填料选用耐火型。

5、外部电缆，气源管。

『

项目里车间里的自控阀一般不太会写防火要求，但化学品储罐的自控阀规范里有明确有防火要求的。工艺提阀门防火要求时，阀门着火时，它自动关闭还是需要人工远程操作，是两个概念。阀门的设计防火要求分为两种，一种是一旦着火自动切断，还有一种是着火时我通过自身的一些防火措施，确保阀门还能够远程操作。

如果阀门防火：1）对于硬密封阀门（金属密封），硬密封天然防火的。软密封的话要满足规范要求。2）阀门高温下的耐压性要考虑，我们平时设计时考虑的一般是工艺正常工况的要求，那么有没有考虑极端工况呢。储罐下面的阀门工作温度是常温，如果真着火，里面残留介质会不会因为高温膨胀而泄露。所以如果这个阀门提出有防火要求，那么它的设计温度不是工作温度而是火灾温度了。3）防火阀门肯定不能是对夹式的，要用阀门或焊接的形式。

阀门防火，那么执行机构肯定也要耐火，否则没法控制。

对于电动阀，电源可靠性也很重要，如果火灾工况下电源失效也不行。对于有些电源，可能采用备用电源。其配套的电缆也有能耐火。

』

在中国石化建 [2011]518 号《液化烃球罐紧急切断阀选型设计规定》；球罐根部紧急切断阀的防火罩应选用适用于户外露天场合的刚性防火保护罩，防火保护罩应能够在 1093℃ 烃类火灾下 30min 内保证其内部温度低于 80℃。

SH/T3005规范中对有防火要求的紧急切断阀提出配防火罩，且要符合 U1709 标准。

因此，凡是构成一级、二级重大危险源的化学品罐区，在储罐的进料管上的阀门阀应该有防火措施，首选防火罩，且要符合 U1709 标准。

SH/T3005-201610.3.6.7 在用于紧急切断阀的气动执行机构的气缸上应能加装易熔塞，易熔塞的熔点宜为 250℃，当气缸温度达到或超过易熔塞的熔点时，易熔塞熔化将气缸内的压力泄放掉，使另一侧气缸内的弹簧或储气罐内的压缩空气推动活塞将阀门关闭。

『易熔塞的作用是，在火灾工况下能够自动放气。以前「焦油」提出过这个问题，防火阀阀体本身符合 API 的防火要求，如果不配防火罩，就完全靠易熔塞，有故障位的阀门，火灾时自动排气，这样是否可以？有这种想法时，其实潜意识认为执行机构是耐火的，其实防火罩的目的一方面是为了保护阀体，一方面是为保护执行机构。如果执行机构一烧就烧坏了，那么易熔塞也没啥作用。所以即使配了易熔塞，防火罩还是要做的。』

现场遥控开关：

根据罐根控制阀的安全功能和 AQ3053 2015 等标准的要求，应对罐根控制阀具有控制室遥控关闭和现场遥控关闭的功能。在罐区防火堤巡检入口处，设现场遥控开关。遥控开关宜输出两对触点，其中一对接至阀门控讯箱，直接控制阀门关闭；另一对接至控制室进行报警、记录、联锁控制。建议该遥控开关在罐根控制阀规格书/数据表中一并设计，由控制阀成套提供，以便减少接口，正确接线，正确配线，准确实现所要求的功能。

AQ3053-2015《立式圆筒形钢制焊接储罐安全技术规范》设置要求：

12.2.2 液位限制附件

大型罐应设高低液位报警装置、高高液位报警装置和紧急切断装置，并采取高高液位报警联锁紧急切断装置的措施，在防火堤外及控制室操作站应设置紧急切断阀联锁按钮。当储罐发生液位报警高高或火灾时，能够遥控或就地手动关闭进料切断阀，在切断阀关闭后，应自动联锁停止进料泵。

『我们现在很多做法是一键停车，在防火提设一个按钮，一键把所有的根部阀都关了。这样的做法是可以说的过去的，因为规范上并没有一一对应几个字，这样既满足了要求有比较省钱。我之前接触到中石化的一些做法，他们是每个根部阀，在现场它都设有一个切换开关（遥控开关），他们是一一对应的，可以单独的进行操作。』

### 10. 阀门配管需要注意的事项

1、调节阀宜垂直、正立安装在水平管道上。公称通径 DN≥80mm 的调节阀，其阀前后管道上应设有永久性支架。高处的调节阀需要维护平台，小于 50mm 的管道上开关阀可以安装在垂直管道上。

2、阀门的上、下部分应留有足够的空间，以便在维修时取下执行机构和阀内件以及阀的下法兰和堵头。

3、当阀安装在有振动场合时，应考虑防振措施。

4、浆状和易结晶的流体等。

调节阀旁路设置：

1、下列情况应设置旁路：1）腐蚀性流体。2）严重磨损阀内件的场合。3）其它重要场合，例如锅炉给水调节阀。

2、下列情况可不设置旁路：1）清净流体。2）公称通径 DN>80mm 的场合。3）调节阀发生故障或检修时，不致引起工艺事故的场合。4）工艺过程不允许或无法利用旁路阀操作的场合。例如：紧急联锁放空阀以及浆状和易结晶的流体等。

『我们调节阀在提条件时是要求垂直安装的，很多项目因为工艺配管困难，可能装在垂直管道上，这样长期运行来说对阀门是不利的。但是小于 DN50 的开关阀是可以安装在垂直管道的。因为像一些放空阀你不可能装在水平管道上。阀门在一些比较高的地方，或者外管上的阀门，阀门的上、下部分应留有足够的检修空间。』

### 11. 选型中注意的其他几点问题

1、气源管：1）DN100 以上阀门，建议用 10mm。2）振动场合采用柔性管（阻燃）。

2、阀门线形特性。1/0 表需注明 EQ% 修正。

3、装车阀的选择。1）调节球阀/两段阀/数控电液阀：油品；化学品；液化烃；其它粘度较大、强腐蚀、溶剂、含颗粒等产品。2）两段式开关阀选型注意。两段式开关阀气缸（弹簧返回）。

『

气源管，设计中没有明确区分大阀和小阀气源管口径选型问题，大阀动作比较缓慢，DN100 以上阀门，建议用气源管 10mm。以前规范里都建议用金属管，金属管线有好处也有坏处，金属的耐火性比较好，但对于压缩机房，因为工艺管线远离振动源的，它是不动的，阀门是安装在振动管线上的，它中间就有硬连接，气源接口一旦松动漏气，阀门就会回复到故障位，就会发生一些安全事故，所以这种场合建议采用柔性管（阻燃的）。

装车阀门。主要是考虑到液化烃、化学品、油品，还有各类不同粘度的物料。每个物料只要有装车肯定有装车阀门，平时选型，工艺提出条件后，自控专业选型，一般来说，如果采取的是速控电液阀，价格比较高，是自力式形式，但它不适用于液化烃。装车如果采用两段式开关阀，也是两种常规的手段，它可以弥补速控电液阀的不足（高粘、液化烃、有腐蚀性）。两段式阀门的阀内件可以选型的。目前装车阀是与装车空隙进行匹配的，装车球阀设计的话，肯定是要装置输出一个控制信号（调节信号）。目前国产系统做的比较好了，国产的装车仪一般可以控制调节性阀门，进口的装车仪反而做不到。进口的只能控制两段式阀或速控电液阀，所以我们是要根据介质的特性来选择阀门类型，同时还要根据装车仪的输出信息来进行选择。如果选择了两段式调节阀，必须是在装车栈台那边设置气源才行。没气源的话只能用速控电阀，但前面说了速控电阀不能用于液化烃等介质。两段式调节阀有两个活塞，它是三个气路通路进来，如果有故障位要求（比如故障关），它至少要配 2 个电磁阀。如果有故障保持的要求，那么就需要配置 3 个电磁阀才行。

』

俞洪明：

1、关于装车。用电动阀装车的情况也比较多，油品里速控电液阀比较多。电液阀就是以液体本身的动力来作为阀门的起源，成品油罐区那边用的比较多。化学品罐区这边用的是两段式调节阀。

2、精细化工里的调节阀常规现场是不带手轮的。如果要选带手轮的，要在条件里注明。一把情况下都会要求在调节阀的前后设置手阀，因为调节阀带个手轮是要加不少钱的。

3、阀体的选择。阀体的选择华雷讲了很多，其他阀体选择这块内容跟你们工艺是一样的。工艺是什么要求，自控的阀体就是什么要求。

4、调节的本质。流体力学里，流量、压差这两个元素，介质确定后，流量是与阻力有关的，阻力越大流量越小。调节阀本质上就是一个阻力件，所以工艺提调节阀调节时，要告诉自控专业需要多少阻力，多少阻力体现在：1）什么介质。2）压差是多少。根据介质、流量的大小，在这个特点压差下我们可以算出这个「阻力」。

## 20220221与华雷交流仪表年度工作

### 华雷整理

自控专业已提交的资料：温度、压力、流量、液位、调节阀的选型逻辑。

自控专业需求：

数据表、索引表、电缆表、监控表、电缆表可人工修改后上传系统，数据库自动更新。

其中：

仪表索引表内仪表类型初步根据选型逻辑自动生成，如果逻辑中有多个可选，根据统一规定中的优先选型确定。

索引表内的仪表类型可以人工修改上传，更新自动生成的仪表数据表类型。

仪表数据表选型中的接口和类型，以仪表统一规定为依据。

设备上的仪表接口未核对过返资设备资料的，数据表需要备注「待返资后确认」。

自控专业需提交的资料：1）EXCEL 格式仪表统一规定模版。2）最新的仪表数据表模版 2 月底之前。3）安装图选型逻辑 2023 年。

### 记录

干涉界面方面。

问题 1：校审查什么东西。

问题 2：业主的要求、统一规定在哪里改。

定一个模板，有些可以自定义的东西。我们的统一规定一般是打勾的（一种仪表）。我要做一个交互模板，一个项目里所有项目的仪表选型规则都在这里面，每一个项目一个统一规定。

最好也做一个 Excel 版，这样可以让业主勾选，有些东西是业主选的。

我们之前统一规定的模板一般是，一种仪表，下面几个口径选型打勾，是竖向的。包括电缆。

这个条件模板（选型统一规定）可以直接作为我们仪表专业的项目统一规定，到时直接上传给 D4 系统。

校核的磨合期：前期的时候时候，还是跟之前校审一样的东西，成品数据表。

之前我提供的逻辑，其实没有 100% 覆盖选型的经验的，还有一些细节性的东西需要人工干预。

大龙：人工干预的部分，需要单独去校核。

成品回导的问题：

之前改的东西要能保存记录，比如我把接口形式改了。常规设计人员肯定直接在成品里改仪表型号（省事）。本来他可能开始逻辑上没考虑那么周全，就先生成仪表了，后面很可能要去修改的。所以最好要能把成品回导提取数据，保证数据库里的仪表类型是最新的。最新的仪表类型后续是要给仪表安装图用的。

大龙：A（数据库）=> B（成品），先不考虑一定要把 B 同步回 A。措施一：优化 A 转化为 B 的逻辑，逐步减少 B 修改的操作。措施二：先不强制 B 一定同步回 A，只有当 B 要去做 C 的时候，重新上传 B，获取最新的数据。

我们一般四大块的表：数据表、监控表、索引表和电缆表。

仪表选型这边有一个关键前提，工艺的条件一定要准确。典型如仪表所在管道的变等级问题。

大龙：这个系统里以后要开发一个校验的功能，仪表会花费很多时间核对工艺的这个信息。

索引表，主要是仪表位号，仪表位号肯定是从仪表数据表里抽取出来的，里面还有仪表类型，仪表类型肯定要等所有模块开发完后才能出来。

我还想过一种模式。前面说的是第一种模式，根据统一规定以及工艺条件自动匹配仪表类型。还有一种模式，能不能在索引表这边先定好仪表类型。我目前不知道会不会有这种业主干涉的要求，比如业主说，这些表必要要选什么类型的。因为根据我们目前线性的选型逻辑，是没法指定某一个仪表位号，要用什么仪表的。是有这种情况的，业主在我们选型前已经做了相关的工作，某些仪表是要按他指定的类型。

1『这个思路大赞。其实可以 2 种模式结合起来。用自动选型的逻辑先在索引表里匹配出来一版，然后在索引表里人工去修改仪表类型，以修改后的仪表类型去生成仪表数据表。（2022-05-15）』

那么数据表变动来源：1）既受变更后的工艺条件的修改影响。2）又受索引表仪表类型修改后的影响。

监控表。是在索引表数据的基础上加上一些量程数据，量程一般都是根据数据表来的。

电缆表。电缆表更简单，就是根据索引表来的，只是仪表位置要根据平面图的信息来。电缆表里的电缆规格是根据统一规定来的。

作业线。按我上次整理时的理解，不仅是设计线的推进，还包括网上提的一些归档资料，网上提的给其他专业的条件。

索引表很关键，除了刚刚提到的选型过程中的类型变化外，还有一些是工艺条件里没提的成套设备点，要能手动加上去的。加上去后，后面的监控表、电缆表都要相对应的加上去。

数据流一方面是节省重复劳动，另一方是要保证各个图纸里的数据对应，避免这个图里有的东西另外一个图纸里没有了。所以索引表拎出来，作为更统一规定差不多的可修改的输入条件，很重要。

还有个问题，设备上安装的仪表接口。我本来是想根据设备资料来的，设备上的仪表管口多大，是要设备厂家返资来的。我目前想：设备上的仪表，如果是返资没有的数据，要加个备注：「待返资后确认」。非设备上的仪表就可以直接定下来的，非设备上的仪表主要是温度、压力、流量，设备上的仪表比如液位计。返资的资料其实很难在数据流里更新的。返资的时间节点跟设计节点不同步的。

我提供的转子流量计的数据表模板，里面是自带计算程序的，我以前只要数据流量是可以自己选的。

## 20220530与华雷交流仪表选型统一规定

讨论内容：仪表统一规定卡片。

华雷：

仪表的过程连接是怎么出来的？

大龙：

如何把之前跟的选型逻辑跟统一规定里的信息结合起来，以压力表为例。

华雷：

就说过程接口这边，比如我统一规定里选了下面的 4 个选项，那么自动选型逻辑里，出现的也仅仅是这 4 项，而不是全部的 9 项。

再比如附件的要求。如果附件里二阀组（压力）打勾了，那么压力表里都有这个附件，如果不打勾，压力表里压根就没这个附件。

大龙：

我要的就是这些关系。我先按你之前提供的选型逻辑重新梳理一下，梳理里的过程中我把在统一规定里涉及的内容都拎出来，一个个找你确认，确认选型逻辑里的信息与统一规定里信息的对应关系。

华雷：

仪表类型的选择在选型逻辑里已经都有了，统一规定里涉及到的主要是一些过程连接还有一些附件。

大龙：

就是选型逻辑里，最后面要调整的仪表相关参数的逻辑。

华雷：

压力指示表头直径这边，常规都是 100 的，不太会有 150 的，然后管道直径小于 DN15 的，表头直径改为 60 的。

过程接口，之前给的选型逻辑里是定死的，现在统一规定里弹性更大。抗震相关的也是。

压力表这边还好一些，流量计就麻烦了。比如我现在做的海科项目，流量计就不是我们常规做的导电、电磁的，能孔板的全部上孔板流量计。

统一规定输入好后，先导出索引表。在索引表核对仪表类型和修改仪表类型，改仪表类型的时候，我肯定是要看工艺条件来改的，所以临时索引表里右侧要把工艺的条件数据全部放进去。

人工修改仪表类型，我们常常有个场景：某个介质直接用某个类型的仪表。我想要的是，有个基础版的统一规定，每个项目里又有针对这个项目的定制化统一规定，比如刚刚说的，涉及到某个介质的就直接定某个类型的仪表。

## 20220601与华雷交流仪表索引表

### 提炼

仪表索引临时表里需要的字段：

仪表位号

仪表大类

仪表类型

仪表用途

流程图号

所在管线或设备

仪表系统（DCS/SIS）

是否配安全栅

如果是阀门的话，额外增加字段：

阀门附件

本安/非本安

### 记录

华雷：

应该是在生成索引信息后，再打勾加备注。因为就算我这个项目整个都要求是本安型，但我有些仪表是只能做隔爆的。隔膜的话只有这两个，本安的话就多了一行安全栅。我们平时用的是公式，跟编号原则有关系的，就是我们后面加个 M，代表安全栅，再加个后缀代表本安。这些跟选型要求一样的，有些元件。

举例。这是一个常规的（隔爆）仪表，前面说了是要有附件，正常的话，就前面 2 行，前 2 行是阀门。像我们的温度、压力、流量、液位，这些标准的模拟量仪表，这种 AI/AO 的东西，就前 2 行。隔爆的阀门的话，这三个属于它的附件。这个是安装管道设备号（Excel 里管线或设备号），这一栏有数据的仪表都是安装在管道或仪表上的，我们有公式弄过来的。这是它的三个仪表，这是源头，如果一旦是本安的仪表，那么后面再加一个附件，就是我这个仪表要先经过安全栅才能再进系统。所以，对于我常规的仪表来说，如果是隔爆的，这个是系统位号（第一行），这个是仪表位号（第二行，工艺提的 ）。第二列是代表它的用途，没有的话就是空白的。第三列是仪表名称。一旦碰到非隔爆仪表，那么就要加安全栅了。它的仪表的信息，是通过安全栅发出来的，仪表对应的就没有信号类型了。AI 代表信号输入，它叫输入安全栅。看这里的调节阀，它的信号输出是 AO，输出安全栅。

『

补充：（2023-07-04）

1、第一列的仪表位号，第一行是工艺的回路号，第二行是仪表的位号。

2、仪表临时表那边，是否配安全栅填了「是」的话，那么仪表这边增加第三行，输入安全栅，信号类型（AI）填到输入安全栅这一行。如果没有配安全栅的话，信号类型（AI）是填到仪表那一行的（第 2 行）。

』

大龙：

系统号是从哪来的？回复：就是工艺提的仪表位号，下面的几行都是转化了的位号，看我之前给你的选型逻辑里有位号的处理。

我在想能不能弄一个中转的临时索引表，一个仪表一行数据。额外单独加的字段汇总：1）比如安全栅的就加一个字段，勾选是否有安全栅。2）进哪个系统，如果有 SIS 的是进 SIS 系统。3）仪表类型肯定要。4）所在管道或设备位号。5）阀门附件（开关阀调节阀的话）。6）本安还是非本安（开关阀调节阀的话）。

华雷：

数据表的索引页面解决方案（临时表里不设这个字段）：

跟索引表里仪表的序号是挂钩的，根据后面生成仪表数据表时的页面信息反填会成品索引表。原来给了你一版仪表数据表模板，Excel 文件名那上面本来就是有个序号，1、2、3、4...，一般是按照这个序号来的，但没有这个仪表，后面的仪表是往前排上去的。不是说电磁流量计永远是 05 的。

刚刚说的上面的仪表，都是根据工艺条件抽出来的。我当时考虑过你的这些问题，我当时专门把可燃气体（可燃气体不是工艺这边的，是我们仪表自己做的），可燃气体的仪表位号，我是直接从 -60、-61、-62 开始了，可燃气体仪表位号序号都是固定的，我也是自己往上加的，你这个就不用管了。你就按照数据表的模板，把工艺的仪表弄上去就行了。

安装图的图号没法弄的。数据表的图号都是 -03KS，它是一个小的分号，但安装图不是的，一个项目里有哪些图纸，我是要自己排过一遍，把目录做出来我才知道的，安装图永远是在最后一张图里，安装图的图号是不知道的，安装图的逻辑还没做，安装图的页面就更不知道了。安装图我们到时自己做，安装图比数据表更难做。

临时索引表里阀门。阀门要配什么附件就不一定了，可能配 1 个电磁阀可能配 2 个电磁阀，有可能配定位器。

大龙：能不能通过一个代号去匹配阀门组件的组合形式。

华雷：

是可以的。这里阀门的位号，这里什么样的配置，这个是跟数据表里数据挂钩的。阀门附件可以选本安也可以选非本安，每个阀门的本安非本安是要单独定义的，加一个字段。每个附件，都可以配安全栅。

说白了，只有阀门才有附件的问题。附件不管有几个，都要有个选型是否是本安。其实可以把这个组合放到统一规定那边去，统一规定里加一个「阀门附件」，比如可以配 6 种。定位器本安非本安、限位开关本安非本安、电磁阀本安非本安，也就这 6 种。可以把这个写在防爆形式的选型里，只要阀门类型定了，那么阀门附件的配置就定了。有哪些互斥的选项，我到时也列一下。

华雷：

这个临时表里，把工艺条件的数据都放过来。

还有一个麻烦的是哪个调节回路。我们之前是根据仪表条件外加流程图才能看出来的。调节阀跟着哪个回路走的数据流现在应该提取不出来吧。

大龙：调节阀的仪表位号不是应该按回路号来设的么。回复：现在工艺提过来的条件很多不是的，调节阀是自己编的。

华雷：

我现在做调节阀回路号的方法。仪表的系统位号中间，如果是调节阀的，工艺位号里都是带有 C 的。带 C 的我先默认当它是有调节阀的，筛选出仪表这些带 C 的后，再去跟调节阀里的阀去做匹配（这里应该是根据控制点名称去做匹配的）。匹配上的话，一般肯定是仪表的数量多，调节阀的数据少，肯定是以调节阀的数量为准。调节阀数据多的才麻烦，多的话，无非是几种场景：1）要么是控制风机。2）要么形成了串级回路，而且如果是串级回路，我们是要把这个信息写在监控表的备注里的。一定不能让有 C 的回路，没有被控对象，保证每个 C 都能落实。

这个地方一旦有人工干预，就有手动和自动的问题，如何去跟前面说的临时索引表衔接沟通。要么简单点，生成列表后，跟我现在人工的一样，调后面那列调节阀，如何快速的让人工来核、来加这些信息。这个列表我可以下载下来，后面有一列是「调节回路」，我自己把对应的有些位号加上去，如果没有位号，那么我自己备注：XX 控制回路的串级回路或变频控制某个设备（风机）。我自己加备注，要么备注阀门位号、要么备注设备位号、要么备注串级回路位号。加上去后，再把这个传到服务器。这个数据也可以用于后面的监控表。

1『这个备注列，匹配到的对的阀门位号可以自己先填充一版的。（2022-06-12）』

还要加上一个系统判断。一旦这个调节回路里，比如 PIC，但没有任何备注，那么这个时候就要带有提醒功能了，是不是要把流程确认清楚。有的时候，是工艺阀门没提，有的时候工艺条件改了，仪表条件里还是 C，其实流程里没有 C 的了，变开关阀了。

调节回路只能自己来调。

大龙：在到临时索引表之前，要先有个功能去补充调节回路数据的。

## 20220710华雷的仪表选型逻辑

准备工作：

1、核对并补充设备图纸管口规格和流程图管段号，并加入参数。

2、核对并补充管道/设备压力等级，并加入参数。

3、核对管道有伴热、夹套的，宜凝固的介质，做标记「凝固」。如果环境极限温度低于 -10℃，选择水，选择凝固点高于环境极限低温的作为宜凝固介质。

4、核对对不锈钢有腐蚀的介质，做标记「腐蚀」, 检查是否有「Ta」不适应的介质，要注明。

5、核对管道等级分界面的阀门材质和压力等级，并加入参数。

6、核对设备温度计、液位计（顶插）插入深度，并加入参数「插入深度」。

7、核对仪表液位接口为顶部的，做标记「顶部安装」。

仪表位号自动生成：

1、仪表位号，远传表统一为 xT-xx, 就地表统一为 xG-xx, 开关阀位号统一为 XV-xx。

2、进 SIS 的仪表，位号第二位增加 Z。

3、差压仪表位号改为 PDT-xx。

仪表选型部分：

仪表选型，根据工艺条件，初步判断仪表类型。

1、温度计仪表选型部分。

管道上的：

根据统一规定要求，选择统一的法兰口径或螺纹。

远传：当温度 <500℃，选择带热电阻一体化温度变送器/热电阻，当温度 >500℃，选择带热电偶一体化温度变送器/热电偶。

仪表材质：管道非金属的写为钢衬四氟，金属的根据管道材质选择 S31608 或其他材质（最低 S31608）。

根据统一规定：选择温度计套管类型。

根据管道口径定温度计插入深度

所在管道 d<200，插入深度 L=200

所在管道 d>200，插入深度 L=250

设备上的:

非金属材质（除搪玻璃），仪表带钢衬套管。

搪玻璃设备，反应釜，或设备带套管的，温度计接口改为卡套连接。

匹配设备内数据「插入深度」。

2、压力表仪表选型部分。

压力变送器的接口初始为 1/2"NPT(F)，材质初始为 S31608。

压力表的接口初始为 M20x1.5(M)，材质初始为 S31608。

压力表中过程为泵出口的，压力表备注：表头充硅油。

特殊性介质修改：

针对标记「腐蚀」，压力仪表备注：隔膜，法兰改为 50-xxRF。

管道口径小于 DN50 选择 DN25，小于 DN25 选择 DN20, 备注工字型法兰。

隔膜材质：

压力变送器：初始值：Ta；压力表：初始值：S31608+PTFE。

压力表：大于 100℃，压力表隔膜材质初始值改为 Ta，增加备注：高粘度硅油。

压力表：压力含 -5kPa 以上负压，压力表隔膜初始值改为 Ta。

压力变送器：含氢气介质，测量材质：改为 S31603 镀金。

3、液位计仪表选型部分。

液位计初始选型：磁性液位计，法兰选择 25-xx RF, 材质 S30408。

筛选出液位开关，法兰选择 50-xx RF, 材质 S31603。

真空、宜汽化介质，选型优先选择浮筒液位计，材质不变。

介质温度 ＞250℃，改为差压变送器，材质 S31603。

调节回路，改为差压变送器，材质 S31603。

介质粘度大于 150mPa.s，改为差压变送器，材质 S31603。

液位范围大于 4000，或者标记为「顶插」，选择雷达，材质 S316。

特殊性介质修改：

标记「腐蚀」，磁翻板，材质改为 S30408+PTFE, 改为 40-XXRF。

当温度 ＞100, 改为隔膜差压，材质初始值「Ta」。

雷达液位计，材质改为 PTFE。

液位开关，材质改为 S31603+PFAF。

接口修改：

雷达过程连接改为 80-xxx。

差压变送器过程连接改为 80-xxx。

筛选出液位开关，材质修改为 S31603/S31603+PFA。

4、流量计仪表选型部分。

工艺要求高精度，仪表类型选择质量。

介质为氢气，仪表类型选择质量。

介质为液氮，仪表类型选择质量。

管道材质为非金属，介质为液相，初始选择电磁流量计。

管道材质为非金属，介质为气相，选择转子流量计。

管道材质为金属，介质为液相，工艺介质：冷媒，水介质，选择电磁流量计。

剩余的非腐蚀介质初始选择：旋涡流量计。

剩余的腐蚀介质，选择转子流量计。

工艺流量中，正常流量小于 1m³/h 或者 20Nm³/h, 流量计改为转子流量计。

工艺压力小于 0.1MPa，旋涡流量计改为转子流量计。

涉及到塔顶回流，塔出料流量，流量计改为转子流量计。

泵出口流量，流量计改为转子流量计。

旋涡流量计：

管道大于 200，流量计改为孔板流量计。

管道口径 < 25, 改为转子流量计。

电磁流量计：

电极材质默认为 S31603。

管道材质为非金属，电磁电极极选择 Ta。

介质盐水选择哈氏合金 C。

管道口径 > DN200, 改为插入式电磁流量计。

转子流量计：

材质根据管道材质选择 S30408/S31603/钢衬四氟。

对于初选钢衬材质，气体介质：转子流量计改为 HC。

流量计接口：

电磁流量计同管径，其他流量计需要根据流量值，查厂家样本确定是否要缩径。

5、开关阀仪表选型部分。

阀门的阀体材质、阀内件材质，填料，作用形式，初始值：WCB 304/PTFE PTFE FC。

根据管道材质调阀门阀体材质，钢衬阀改为 WCB+F46 304+F46/PTFE。

设备涉及非金属的/特材的设备，核实管口根部阀门的材质。

温度 ＞100℃ 且 ＜180℃，阀内件材质：PTFE + 碳纤维。

温度 ＞180℃，阀内件改为纯金属。

温度 > 200℃，温度低于 -35℃，填料改为柔性石墨。

介质：蒸汽/导热油，填料改为柔性石墨。

## 20220915仪表选型模块方案评审会

需要做的 4 个表：数据表、监控表、索引表和电缆表。

监控表是在索引表数据的基础上加上一些量程数据，量程一般都是根据数据表来的。

电缆表也是根据索引表来的，只是仪表位置要根据平面图的信息来。电缆表里的电缆规格是根据统一规定来的。

根据统一规定和华雷提供的选型逻辑，在临时索引表里会有一个自动匹配出来的仪表类型，这个选出来的仪表类型为默认值，可以人工修改。比如业主要求，流量计能上孔板的就全部用孔板，这时候需要人工修订。

仪表类型的选择在选型逻辑里已经都有了，统一规定里涉及到的主要是一些过程连接还有一些附件。1）过程接口。比如我统一规定里选了下面的 4 个选项，那么自动选型逻辑里，出现的也仅仅是这 4 项，而不是全部的 9 项。2）附件的要求。如果压力表附件里二阀组（压力）打勾了，那么压力表里都有这个附件，如果不打勾，压力表里压根就没这个附件。

### 准备工作

讲稿：

P1 —— 开场

各位领导早上好，今天是华雷做数智设计仪表选型模块的方案评审汇报。这个模块的开发之前已经做了一部分了，华雷做每个类型仪表选型逻辑汇报之前，我先把我们整个模块的基本思路和流程介绍一下。

P2 —— 统一规定

首先是做项目的仪表选型统一规定。这里是对那些既可以是 A 也可以是 B 的情况，按公司级或项目级确定掉。统一规定的数据是跟华雷的选型逻辑配套结合起来用的。

华雷之前已经整理好了总则、温度、压力、液位、流量、分析和控制阀的统一规定，我们客户端里这部分内容已经做进去。

P3 —— 临时索引表

选型统一规定做好后，我们会先导出一个仪表临时索引表。大家可以看到，这个临时表有 2 块。左边的数据是以仪表索引表为模板的，拎了需要看的关键参数；右边是把工艺的条件全部拿过来的。

根据统一规定和华雷提供的选型逻辑，在临时索引表里会有一个自动匹配出来的仪表类型，这个选出来的仪表类型为默认值，可以人工修改。比如业主要求，流量计能上孔板的就全部用孔板，这时候需要人工修订。

P4 —— 导成品数据表

临时表确认完后，上传回到服务器，还要结合统一规定的数据，比如过程连接尺寸等，再生成最终的成品数据表。

数据表有了，以此为基础再生成成品的索引表、监控表和电缆表。

最后提到的 CDMO 验收事项，2.51 min 音频时刻：

9 点开始把任务书发给你们，做到 10 点，差不多时间了你通知我们看你的成果。任务书我准备采用一张示意性的流程图，流程图上是会有东西的，管径没的，走向什么的你也不用相信的。设备是有的，设备主设备的设备规格有，其他设备是要你自己算的。最后你产出的是流程图和相关的条件。

20220916找吴总确认后的信息记录：

吴晓：

示意图是是有流向的。这个示意图是我一个模块的整体性示意，这个示意图我认为你们是不可能画在一张图纸里的，怎么拆分是你们的事情。就好比业主以前给我们的卷图，有 2m 多长，我这边只有 4 台主设备，试验的量我们达到目的就行了。我会在一张图上把这 4 台主设备的功能都表示出来。

徐骋：

是不是跟我们的合成产品线一样，我从溶解到结晶，涉及到物料的转移是硬接的。

吴晓：

有硬接也有活接的。你的物料固体投进去后溶解，这个东西我要送到另外一台釜去的，这个是去反应，这个是去结晶。因为是多功能，我这个釜这次当反应釜，下次当结晶釜也行的。

徐骋：

博腾的 CDMO，大部分的形式是甩头，或者软管的形式。

吴晓：

硬连的不多，但那种从计量槽到反应釜的，要硬连的，不硬连没有道理的，因为是一对一或一对二的，肯定是硬连。

没关系的，我把任务书给你们后，有不清楚就直接问我，把我当成业主。我理解，你拿到任务书后把输入界面打开，这个不懂、那个不懂你就问我，我告诉你我的需求，你去转换为输入。最后要一键成图，不需要你去做后续的事情了。

主设备的材质我这边会给的。

公用系统那边只到真空系统，其他的公用不用画。对 CDMO 这个体系，我认为真空不是公用系统，真空是我这个模块要配的真空，你不能让公用系统去干。

徐骋：

到时候，自控系统会指定么。会细到阀组么。

吴晓：

我示意图上会有一些要求，但我不会有编号。

### 会议纪要

邮件：仪表选型实施方案汇报会议纪要及后续行动计划

各位领导：

### 会议记录

#### 提炼

需修改项：

1、统一规定里需要补充粉尘防爆的类别。

2、压力表选型里，普通压力表逻辑那边补充含氢气介质的情况。只要工艺条件里判断有氢气，无论普通压力表还是隔膜压力表，都需要镀金处理。

3、压力表选型里，连接形式补充带散热器的情况。

补充：发现华雷整理的统一规定里有散热器的情况。

4、液位计选型里，顶装液位计的选型内容需修改：1）补充顶装磁翻板液位计和钢带浮子液位计选型的判断逻辑。2）剔除误放到此处的远传液位计相关逻辑。

5、流量计选型里，节流流量计直接定死为平衡式的。

6、开关阀选型里，补充固体料阀门的选择。

7、调节阀的选型里，调节阀门的流量流量特性还是人工来定，定好后根据流量特性来计算开度。

建议：

1、仪表接口区分非标设备和定型设备。仪表涉及的设备接口，非标设备的接口按统一规定的来，定型设备后期录入。

2、临时表里要能区分出哪些是需要修改的，哪些是不需要修改的。根据选型逻辑和统一规定能够确定仪表类型，不可能有变化的，这些仪表无需核对，比如管道上的温度计。仅核对剩下的需人工干预的仪表。

3、流量计选型思路更换的建议。目前的思路是一个一个做筛选，到最后就剩几个萝卜几个坑。可以换个思路考虑（建议），先按气相、液相分，按某种类型的介质，在多个条件下去匹配某个类型仪表。不穷举所有的情况，把能确定的流量计先确定掉，比如说你把水、天然气、蒸汽等等，不能确认的人工去选。

4、液位计选型里，车间内的中间罐组，大储罐的 2 台液位计就工艺人员提条件时把控，条件里 2 台（2 行），不放到自动判断逻辑里。

#### 温度计

华雷：

温度计分远传仪表和就地仪表。

远传仪表，开始会根据前面的统一规定：1）把远传仪表的电气接口。2）信号类型。3）防爆等级，比如是本安还是隔爆。4）铠装外径。5）温度计套管规格，规格主要是指如果采用温度计套管那么是锥形套管还是直行套管，锥形套管的外形尺寸，统一规定定好后开始后面具体的选型要求。

首选根据工艺条件判断是不是 SIS 回路里的温度，如果是 SIS 回路里的，那么温度计的数据表里要备注：SIL 认证。

传感元件的选择：

1、根据温度测量范围，选用相应分度号的热电偶、热电阻。1）项目里一般优先选用热电阻。2）但如果温度量程的上限高于 600℃，开始采用热电偶。为什么不选择别的热电偶，是因为一般项目，很少达到 1000℃ 以上，我们用 K 型的就够了。3）一些非常规的环境会选取别的热电偶类型，一般都在特殊行业里，我们基本碰不到。

2、泵和风机出口振动的场合，优先使用热电偶。但如果项目里统一要求选用热电阻也没关系的，无非是一些寿命上的问题。

3、选择温度计套管形式。分 3 种场合：1）设备上的。先要区分设备带套管和设备不带套管。带套管的话那就是可调节的卡套连接（温度传感器卡套 M27x2 连接），长度的话需要匹配设备图里的套管长度，或者匹配工艺条件里备注里的插入深度要求。如果设备不带套管的话，那么温度计套管要匹配设备接口，要么来自工艺专业统一填的设备接口条件，要么来自设备厂家的图纸。如果温度计的口子在侧边，统一规定里，设备上对于塔器、大型储罐的插入深度也做了统一要求。但如果设备是顶插，我们一般要插入到正常液位。如果是储罐，一般是要插入到「xx 位置」，要根据液位来判断。2）管道上的。温度计套管类型、插入深度根据统一规定要求。我们现在一般要求，DN350 以下的插入深度是 200，DN350 以上的插入深度是 250。3）套管的规格。前面统一规定里已经明确了，但套管的材质需要根据，条件中是否有腐蚀性场合来判断。我们根据规范要求，金属的套管材质要求不低于 316，但如果采用更高规格的合金，或钢衬四氟的话，那么要求套管材质不低于设备管道材质。套管内孔，完全是根据其传感器是什么元件，不同元件是有不同的内孔要求的。如果项目统一规定里有要求采用温度变送器，那么会采用温度变送器形式，温度变送器如果有分体安装、或者一体化安装，那么会选择相应的一体化温度变送器表和分体式安装的数据表结构。

工艺要求就地表，优先选用双金属温度计。双金属温度计，现在都统一使用万向式。温度计套管参考温度传感器，包括材质和插入深度。但如果温度低于零下 80℃，或者安装位置很高，工艺额外提出了「引远」观测要求，那么就要改用压力式温度计。如果采用压力式温度计，那么其相应的套管和内孔就需要改变。

沈奕锋：

以温度计为例，你想要的适应面是什么。我们以热电偶为例，我们以前做热电站，绝对不是高于 600℃ 就用 K 型热电偶。同样的，设备上的温度计套管也不一定全部是 M27x2 的。

华雷：

我们一单元主要的项目是精细化工、药厂。

沈奕锋：

按项目范围来缩减是可以。不过我反而觉得该缩减的地方应该缩减，比如温度计套管，金属的套管一律用锥管型的，我不相信业主会看这个细节。

华雷：

有些项目要求是用焊接型的，不怕漏么，像新和成的。

沈奕锋：

对的，焊接型肯定是锥形管的。

华雷：

但有些特别长的，比如超过 2m 的（像顶插的），不能用锥管的吧，所以我做了区分，如果长于多少用直管，小于多少用锥管，在统一规定里定好。

沈奕锋：

防爆等级也是这个问题，如果用统一规定的话，有氢气的怎么办。

华雷：

我们涉及到氢气的仪表，肯定要后期再改，因为只有平面图出来以后，我再结合防爆区域图再来改。我必须确认哪些在氢气防爆区域内。

沈奕锋：

这里粉尘防爆也可以选的吧。但统一规定里没有粉尘防爆的类别。

这里分体式温变，是指现场装的温变么？温度变送器也是装在现场的是吧。

华雷回复：是的。如果装在控制室的话，那么我就用热电阻了，然后现场配安全栅或转换器。要求的分体式，一个是沈总刚说的场合，还有一个是管道井也是这个场合。管道井这个东西还真是需求平面图做出来后才能确定，现场没法知道，只能后期改。

吴晓：

这些判断，工艺条件里都能提取到么。

华雷：

之前我给林骏也发过一个仪表条件的说明，像泵出口这种场合，我们通过判断其用途里有没有带 P 出口、C 出口。工艺条件的备注里要提出，带不带颗粒、易不易结晶这种特殊工况要求。

吴晓：

氢气含量 5% 谁告诉你。

华雷：

具体含量是没有的，但含不含氢气是可以的拿到的，5% 很容易达到，默认有氢气就有 5% 的含量。 

之前跟大龙说过，仪表选型的难点在于，所有设备安装的仪表，它都有一个设备接口的匹配。工艺目前提的设备接口数据我如何抓到数据库里去。我的温度计在设备上是什么接口，我不可能自己定义的。

吴晓：

你说的设备的这个是要去看设备装配图吧，要么是工艺看要么是仪表看。如果接口条件，工艺自己可以定义，那么他给你定好，然后他接着往设备工程图方向走（一条线走）。但很多是定型设备，样本来的，这个总归要人去核的。

华雷：

如果无法直接抓设备装配图的数据，那么只能是，设备专业给出一张表，这个表系统去读进去。这个表有个标准格式，是人工来核的。

吴晓：

我们自己非标设备这块我认为是好做的，我们定死。定型设备定不了，只能去看。

华雷：

如果能自己出来，工艺专业也方便的，定型设备里也有很多工艺的口子。我们现在是一个设备，不同的专业重复在看。这个表还是很重要的，安装图也可以用。

吴晓：

你们 2 个专业关注的东西不一样，工艺是去看设备的长宽高、支脚尺寸、工艺接口，他不会关注你们的仪表接口的。

那么设备接口先只考虑非标设备的仪表接口，工艺定的时候就先把它定掉。定型设备没办法只能后端读入。

按照我之前的想法，不可能 100% 的仪表能够选型出来，剩下有疑问的仪表要能拎出来。无论是设计人员还是校审人员都不希望全部去看么。如果有 60% 的表根据规则是没有问题的（不可能有变化的），那么这批仪表是可以直接 pass 的，不用看。去核那剩下的 40%。我说的 60% 只是一个说法，不一定是这个数值，当然，我希望是越高越好。比如说你装在管道上的温度计是可以定掉的。不用看的比如全部标成绿色的。再接下去看看剩下还有哪些可以放心的往下做。

再下去，如果是我们的非标设备，接口是我们自己定死的，这个也可以做到一次性成型。而且还能把你的接口数据返回到工艺提条件的那个阶段去，他往后面提的工程图条件也就定死了。

华雷：

我理解吴总的意思了。仪表接口区分非标设备和定型设备。仪表涉及的设备接口，非标设备的接口按统一规定的来，定型设备后期录入。在统一规定里，我也对我们自己定义设备上仪表接口做了规定，但有些设备不是我们来做的，能做的话我们就可以自己定义好，这个接口数据也是提给工艺专业的，我们也是按这个来提的。

赵志明：

现在跟非标设备关联是不是太复杂了。

吴晓：

不复杂的，只是把华雷的统一规定引用过去而已。

华雷：

如果是非标设备，我先根据我的逻辑初步选型，选型后在根据选型后的仪表的接口返给工艺专业（可以给设备做工程图的）。如果是定型设备，我需要根据设备接口来确定仪表类型，是反过来的。

沈奕锋：

标准的建设程序，我认为是不反的。正常的都应该是我仪表来提条件的，无论是定型设备还是非标设备，然后厂家返回。

标准流程都是我们提，设备专业按我们要求的规格提给设备厂家。设备厂家的装配图做好，会返资给我们，是按照我们的接口做的，还是某些有修改。设备厂家返资后的，如果有修改的，我只能人工改了。我们只能拿到自己提出条件的数据。

1『我目前理解的步骤：工艺提的非标条件里，最开始仪表口是仪表定。是仪表专业选型后定的仪表口子，同时返给工艺专业和设备专业。工艺专业会把仪表口子更新到最后的管口方位图里，设备专业是拿仪表口子做设备工程图。工程图提供给设备厂家去加工，加工时会有一个设备装配图。对于非标设备，这个装配图说到底，其实是根据我们设计院的数据来做的。（2022-09-22）』

华雷：

无论是标准设备还是非标设备，最终都是要厂家来确认的。

沈奕锋：

如果是自己的 EPC，那么是很容易要到对方的确认表的。如果是业主自己买的，那就没办法了，供应商不会按你的格式填表的。

大龙：

确认下，其实我这边应该是要给仪表生成一个仪表提给设备专业（或设备厂家）的条件表，这样非标设备的仪表口子我这边才能拿到。

吴晓：

大龙你这个时间上就错位了，我的意见是你直接拿仪表专业的统一规定去匹配获得，非标设备的仪表口子。工程可能刚刚提出仪表条件，这边已经开始提非标设备条件了，仪表肯定来不及返回的。

华雷：

我们以前靠人工的，仪表口子修改好后，厂家那边都制造完了。

1『吴晓、华雷上面的意思，仪表选型滞后，仪表选型后才能定非标设备条件的仪表口子，但往往这个时间点太晚了，设备厂家都已经制造设备了。（2022-09-22）』

沈奕锋：

温度计与套管之间的连接关系。

华雷：

统一规定里有的。

沈奕锋：

那你前面用不用卡套的话，取决于你用不用法兰喽。

华雷：

是的，所以这个勾选以后，然后再根据前面的判断，设备是带套管还是设备不带套管的形式。在统一规定的前提下，如果不带套管的话，直接匹配。

沈奕锋：

统一规定是自己加个逻辑么。如果你管道上的套管已经决定用法兰连接了，那么就不需要用卡套了是吧。

华雷回复：是的。

沈奕锋：

其实这个连接形式是可以定死的，比如一律是 DN40 的法兰连接，特殊的在项目统一规定里开个口子可以修改。

吴晓回复：能定死的越多越好。

#### 压力表

华雷：

也是分远传仪表和就地仪表。先看远传表。

压力变送器的外壳材质：如果项目是在海边，那么外壳是选 S31608 不锈钢的，否者是常规的铸铝。

压力变送器形式的选择：

1、带隔离元件的压力变送器。如果介质中有结晶、堵塞、粘稠及腐蚀性；或者管道材质和设备材质，用非金属、衬力；或者管道是伴热、夹套管形式；或者高洁净度场合。那么选用带隔离元件的压力变送器。

填充液。会从高温场合和低温场合来看，到时会给大龙一个填充液的表供选择。如果介质里包含氯气、硝酸、过氧化氢等强氧化剂的场合和洁净区场合，那么填充液更换采用惰性液，比如氟碳润滑剂或卤烃等惰性液。如果压力变送器，高真空的场合下，那么会更改为绝对隔膜压力变送器，同时下面的量程要更改为绝对压力量程。如果是高真空场合，根据我提供给大龙的那张表，还要再查对应压力下面的温度适应情况，还要再进一步筛选填充液。
变送器
隔离元件。1）隔离元件形式。要看工艺条件里带不带结晶、颗粒，还有氯乙烯这种可能自聚的介质，如果有的话，那么采用的隔离元件是要带冲洗环的元件。当工艺管道是带夹套管的，夹套管用来判断它是高粘度的，那么压力变送器不但要配置隔离元件，而且要选择凸膜片型变送器，膜片突出 200mm。2）隔离元件的材质。隔离元件的材质要根据介质来选择合适的隔离材质，介质腐蚀性；或管道、设备是非金属材质或衬里，开始默认采用坦材（Ta），特殊的介质会进行改选。改选逻辑汇总：如果含 Cl- 的 HF，要选择哈氏合金 C；发烟硫酸，要选择哈氏合金 C；对于强碱性介质，要选择哈氏合金 C；对于纯 HF/氟化物，优先选择 Mon400/其次哈氏合金 C；盐水介质，选择钛材。

过程连接规格和材质。1）如果根据管道等级号判断是薄壁管，或者设备接口为卡子接口，那么采用卫生型连接-卫生型卡子连接 DIN32676，我在统一规定上做了卡箍的大小尺寸规定。用卡箍肯定是给卫生级用，不可能用特殊材料了，只能用不锈钢 S31603，同时抛光处理，不能用其他材质了。2）如果采用法兰连接。统一规定里定了口径统一为 DN50；法兰等级和密封面形式参见管道特性表和设备接口要求；法兰本体材质选择 304 材质。

前面是说的隔膜压力变送器，如果是在之前的筛选条件之外的，那么就是普通压力变送器。

2、普通压力变送器。普通压力变送器会去区分几种场合。1）接触氢气。如果接触到不同浓度的氢气，那么可以对其膜盒材质进行不同程度的处理，比如镀金。如果介质里没有氢气，那么根据压力来区分。2）根据压力。如果压力大于 15kPa，那么采用直接安装的压力变送器（大于 20kPa），要么压力采用引远安装的压力变送器（小于等级 20kPa），同时修正精度。3）如果压力不是太高真空，而且小于等于 15kPa，那么选用差压变送器。接着把低压侧取压口规格改为通大气，精度也修正。4）如果真空度很高，那么需要根据工艺条件来区分。如果是氮气置换，那么选用普通压力变送器。如果是精馏/脱水/反应时的真空，那么选用绝对压力变送器。同时根据统一规定，定义它的电气接口、信号类型和防爆等级要求。

就地压力表：

1、隔膜形式。隔膜形式跟压力变送器一样的判断条件。1）但与压力变送器不同的是，一旦小于 60kPa，那么就需要选择膜片压力表。2）如果量程上限大于等于 0.1MPa，那么就需要跟压力变送器一样选带隔膜元件。要判断是否在泵/压缩机出口，如果是的话选用隔膜抗震压力表，否则为隔膜压力表。过程连接跟压力变送器一样的。

2、非隔膜的普通压力表。如果不需要采用隔膜元件，那么就是普通压力表，要根据量程来区分。1）小于 60kPa，那选用膜盒压力表。2）如果量程上限大于等于 0.1MPa，那么就需要跟压力变送器一样选带隔膜元件。要判断是否在泵/压缩机出口，如果是的话选用不锈钢抗震压力表，否则为不锈钢压力表。3）如果所在管道的尺寸小于 DN15，那么连接规格更改为 M14x1.5，表头更改为 60，精度更改为 2.5。改成这种小口径的压力表。4）如果工艺条件为消防泵试验压力，表头要改成 150，精度改为 0.4。5）如果从工艺条件判断出是爆破片出口压力表，是在安全阀和爆破片之间，那么压力表同时要备注带记忆指示功能。

沈奕锋：

我们有多种介质混合的，你的逻辑有先后顺序的话，优先级是怎样的（怎么办），比如又有氢气又有硫化氢。

华雷：

确实漏考虑这种情况，只要有氢气的都应该镀金。其实也比较简单，只要工艺条件里判断有氢气，不管是普通压力表还是隔膜压力表，我都需要镀金。膜片镀金也好，普通压力表镀金也好，都能够防氢气，而且镀金是万能防腐（金可以防一切腐蚀）。

需要提醒哪些是有逻辑重复，需要人工干预的。

赵志明：

反应釜肯定是多种介质的，就怕介质列不全。

华雷：

我这边其实是设置了优先级，因为考虑到多种工况，一般优先是采用坦材（Ta），对我们来说坦是防腐能力最强的金属。在这些逻辑里是选了一些坦材不能适用的条件，哪些介质坦材不行，一旦碰到这些介质，那么就会换材质。坦材就怕氟化物，比如氟化氢。碰到腐蚀就特别麻烦。

吴晓：

沈总，我估计你们仪表里有些材质是没有的。我想想，我们设备能扛得住，你们仪表怎么会扛不住呢。

沈奕锋：

像温度计我们不太关心，因为可以隔离腐蚀源。但压力表是靠弹簧形变的，耐不住腐蚀。压力变送器相对来说判断最麻烦。

绝压不能这样。真空度很大时，压力变送器是测不准的。如果要测真空，就跟上次我们说的，你要在带微正压的情况下也要用绝压变送器。但是如果判断出我确实需要准确的测量出真空度。一个反应釜在高真空度和微正压的情况下会偏的，反应过程中有的时候是高真空度有的时候是微正压，高真空度又要准确知道它的真空度，你还得回到绝压变送器。

华雷：

但是在条件里如何判断真空是给谁用的，真空度要不要测量准确，是很难判断的。我们现在是直接问工艺的，这个反应釜是不是给脱水用或者是给精馏用的。

沈奕锋：

有些工况，只要有真空就行，具体真空度的数值它不关心，比如甲类介质的氮气置换。关键是判断是是否需要准确测量高真空度数值的。

还有，你现在压力表是不管「xx 连接」的么？需不需要是带散热器的那种呢。

华雷：

是的，目前全部是直连。不对，角形连接的也有，只要是垂直方向的，就用角形连接。至于散热器，是没考虑。

沈奕锋：

挂装和嵌装，就地压力表也有跟温度计一样的问题，要不要考虑，如果不考虑，温度计那边是不是也不用考虑。比如毛细管引出来的，也有的。我们是很少遇到，现场操作才有。

隔膜的规格是留着的吧，如果是毛细管的话。

华雷：

毛细管的长度没法写的，要根据平面图来写。我们现在很多碰到塔上的压力，塔下面的塔座非常高，要拉十几米长才能拉到地面上，只能根据安装高度来定。

赵志明：

压力表，现在很多业主想把就地的压力表取消掉，你们有没有依据的。集中表有了，就地表要取消，现在一堆这种联系单发过来。就地表，本来是巡检的人过去记录的，怕什么东西失灵了。

华雷回复：我们喜欢这么做。

沈奕锋：

就是因为读数不一样。很多时候检测发现读数不一样，会问你现场读数为什么与控制室的读数不一样。

华雷：

说到这个，我也给工艺提个意见。工艺条件里，工作温度、工作压力，未必是它涉及到的全部压力。比如说要压料的情况，工艺一般不提的。还有氮气置换，一般工艺也不提的。他们只考虑工作压力，氮气置换的真空、压料下氮气的吹扫压力，全部不管的，就填个几千帕。那么我们压力变送器按这个量程一选，吹扫、氮气置换的时候根本看不到，我们就没有这个量程。

吴晓：

应该要给你们极限量程的。

沈奕锋：

条件里就有的，操作压力和设计压力。操作压力是什么，如果吹扫是你不关心这个压力，那么操作压力就不要填氮气吹扫，而是反应过程的实际操作压力，比如微正压。如果你关心的是吹扫压力，那么吹扫压力的 0.3MPa 也要填在操作压力里。这个时候，设计压力最好要填这个系统里安全阀的起跳压力，安全阀的起跳压力往往低于管道（法兰）的设计压力。


1『终于找到新版仪表条件里设计压力的来源了，应该是沈奕锋定的新版仪表条件模板，他理解的「设计压力」跟我们工艺理解的不是一个概念。这个知识点又跟前几天 CDMO 验收汇报时，吴晓提出仪表条件里为啥会有设计压力的问题，挂钩上了。知识的链接产生这种心流状态真爽。（2022-09-22）』

华雷：

之前不是说量程不覆盖设计压力么。

沈奕锋：

是的，不覆盖，但是我要耐压的。关键是看工艺关心的只是反应过程中的微正压，还是包括吹扫过程中的 3 公斤压力。如果操作压力不填 0.3MPa，那么表示他不关心这个压力。压力变送器不用关心这个的，但压力表要关心，压力表的量程要覆盖到设计压力。

吴晓：

这个理念是要传递给工艺专业的。

华雷：

仪表的量程选择，是要区分，就地和远传仪表来考虑，覆盖不覆盖设计温度和设计压力。但工艺有时候是不该提的提了，该提的不提。

沈奕锋：

控制（DCS）是不关心我消毒的压力的，但是我是发酵罐的，那么就要关心了，意味这我 DCS 也要关心消毒时发酵罐的压力了。以前发酵罐的压力变送器是不关心消毒时压力的，因为那时候是纯手工操作，全是手工去打开蒸汽。如果 DCS 要关心，那么量程就不一样了。如果两者相差很大，那么误差就很大了，这是要权衡的。

吴晓：

我觉得你们刚刚说的很多情况应该是来自于业主的 SOP，是基于 SOP 上你对巡检的要求。巡检要求你去看现场温度计的，那么就安装。如果要安装，你让业主把他们 SOP 拿过来。

沈奕锋：

赵总刚刚说的取消就地压力表的问题慢慢扩大化了，之前我们一般最先暴露的是称重，同样的问题。称重典型的，因为现场的称重是数字化的，精度高，是模拟量传到 DCS 的，就这造成 2 个表显示不一样。这没办法，要么你改成数字通信，要么你去解释。现在越来越倾向于控制室控制自控，发现现场的读数跟控制室的对不牢了，两者就争议。就要看业主理不理解这个事情，之前称重是解释的，能接受就接受。

同样，现在现场取消就地表，同样是看那个压力变送器上的读数，但那个真的很不起眼的。

华雷：

之前有项目真空要求比较高，我也不太想选绝对压力变送器，就是因为它只有一个变送器，那么在正压情况下，我的绝对压力表早就爆掉了，我膜盒只有 10kPa 的容量，但是还要看到常压，那么这时候我选择普通压力变送器我还能覆盖一下，他想调量程还能调，选绝压的话就调不了了。

沈奕锋：

如果操作压力跨度大的，一个是微正压的，一个是吹扫的，甚至是中压蒸汽吹扫的，误差肯定达不到要求，得用 2 个压力变送器了。

华雷：

在补充一下。压力表的隔膜元件我想统一为 DN25，统一成 DN25，不管是膜片压力表还是隔膜压力表，全部配工字型法兰。工字型法兰还多一个材质的修改，隔膜元件的材质它是不锈钢的，那么工字型法兰材质等同它。如果隔膜元件是非不锈钢的，比如钢衬的、哈氏合金的，那么工字型法兰材质统一为钢衬四氟。

沈奕锋：

我倒是觉得我们现在的数据表改一下就行了。过程连接法兰继续选 304 或者 316 的，把隔膜改成触液部分材质，不要写隔膜材质。

钢衬四氟反过来又要有温度和压力的限制条件了，要限制一下。

#### 流量计

仪表型号 => 仪表口径 => 仪表材质。

华雷：

先区分就地和远传。

就地表。1）如果功能代号里只有 I，那么选择转子流量计。2）如果只有 Q，那么选择水表。

1『选型逻辑里为什么这里是「只有」，按这么说工艺提的条件里应该就只能填 FI 或 FG。（2022-09-23）』

远传仪表：

在开始选型之前，统一规定里与其他仪表相比（电气接口、信号类型、防爆等级），多了一项设置：分体式附件的选型。

根据工艺条件先进行总的类别筛选。这个筛选可以根据流体最低雷若数进行限制，确保选型后一些类型的仪表超出了其雷若数的要求。不能最后选出来一个仪表，它的雷若数不符合要。

沈奕锋补充：这对工艺条件的要求就更高了。

是的，工艺的流量计条件里目前是有管径、流量的，缺的是粘度数据。

1、判断工艺条件中是否要求使用质量流量计或用途为装车/装置进出交接，比如来自罐区流量计、去罐区流量计（认为这个就是需要交接的），先设为质量流量计。质量流量计，对于非氢气介质，我们会在数据表内备注科里奥力式质量流量计，精度要求小于等于千分之二。

如果是氢气等相对分子质量比较低的或量程比宽的分子，那么选择热式质量流量计，精度为 1%。介质典型有氢气、一氧化碳。

2、如果工艺介质为天然气，根据相关规范要求，直接选用涡轮流量计了，涡轮的精度全部定为千分之五。

3、如果工艺介质中有悬浮物、易洁净的，接着判断管道里有没有衬里，有衬里的（腐蚀性介质）为导电介质，类型选为电磁流量计。管道为非腐蚀性介质，选用楔形流量计。

1『补充，导电介质的判断逻辑：要么是腐蚀性介质要么是水，腐蚀性介质根据管道等级号来判断，还有介质是硫酸、盐酸的。（2022-09-23）』

4、如果工艺介质为高粘度介质，体现在工艺条件里是介质粘度大于 200 倍水的粘度，即大于 200cp，那么接着判断：1）导电介质（根据等级号或介质为水），直接选电磁流量计。2）如果是不导电介质，且量程比小于 10 的话选容积式流量计；如果量程比大于 10，类型选择超声波流量计。

补充：高粘度的选型这里，硫酸、盐酸虽然是导电介质，但他们不是高粘度的，上面的逻辑中不体现。

5、如果上面都没有命中的话走这条逻辑。

1『上面的信息比较关键，这里的选型逻辑类似于一个保底的手段，优先按前面的选型逻辑匹配，匹配出来的话走前面的。如果都没匹配到的话我理解按这里的逻辑是肯定会匹配出来一个的。（2022-11-25）』

前面没命中已经排出掉了导电的介质、质量流量计的介质、高粘度的介质，剩下的介质：

先去判断那些管道材质是非金属或者耐腐蚀金属（哈氏合金/钛等）的。1）如果介质为液相，那么在流量大于等于 1m3/h 且压力大于 0.1MPa 时选择电磁流量计。2）介质为液相，正常流量小于 1m3/h，类型选为转子流量计。3）如果介质为气相，量程比小于 10 的话选择转子流量计；量程比大于 10 选择超声波流量计。这里的超声波是外持式超声波，夹持式的，因为可能有耐腐介质。

对于管道材质为碳钢/不锈钢的。管道口径大于 800 的直接选择外贴式超声波流量计。管道尺寸小于 800 的：1）是不是公用工程的介质（导电介质），比如循环水、冷冻水、自来水等。选择电磁流量计：如果口径大于 250 的选插入式，同时增加附件（焊接套管、球阀），精度设为 2.5%；如果安装在管道井中，后期人工筛选出来改成分体型安装、传感器防护等级 IP68。2）介质为液相，介质不导电。如果流量大于等于 1m3/h，且压力大于 0.1MPa，选择涡街流量计。如果流量小于 1m3/h，或者压力小于 0.1MPa，选择转子流量计。3）介质为气相，流量大于等于 20Nm3/h，且压力大于 0.1MPa，选择涡街流量计，配一体化压力补偿。如果流量小于 20Nm3/h，且压力大于 10kPa，选择转子流量计，数据表附件增加气阻尼。如果流量小，压力更小（小于 10kPa），选择文丘里流量计，配一体化压力补偿。4）介质为蒸汽。管道口径小于 250，选择涡街流量计，配一体化温度压力补偿；管道口径大于 250，类型选择压差式流量计，配一体化温度压力补充，根据压力来判断是角接取压孔板（低压）还是流量喷嘴（中压/高压）。

选型定好后，再来确定仪表口径。1）电磁流量计等同管道口径。2）转子流量计需要公式计算，核实口径。Excel 计算书已经提供给大龙。3）涡街流量计，优先缩径一档，然后根据样本核实。4）质量流量计，工艺条件中是要补充最大允许压损条件的，根据流量和最大允许压损来复核口径，而且是要让厂家来复核，我们样本上是没法复核的。

仪表口径定好后再定仪表材质。

1、电磁流量计。1）当管道材质为钢衬、非金属时，电极、接地环优先为哈氏合金 C。2）如果管道材质为耐腐蚀金属，比如哈氏合金、钛材等，电极不低于管道材质（等同或者更高），接地环不配。3）如果管道材质为碳钢或不锈钢，那么去判断介质：介质为浓硫酸，因为有钝化不导电，电极、接地环材质选择哈氏合金 C；介质为浓硝酸，电极、接地环材质选择 Ta，因为坦材不耐浓硫酸但耐浓硝酸的，而哈氏合金耐浓硫酸不耐浓硝酸；介质含 Cl-，比如 NaCl，电极材质选择哈氏合金 C、接地环不配。

除去以上三种情况，如果管道材质为碳钢、不锈钢，建议默认仪表材质按不锈钢，同时接地环不配。

2、差压流量计。1）管道为非金属材质，根据前面的逻辑会选楔形流量计，仪表材质为钢衬四氟。2）如果管道为碳钢/不锈钢，不管是什么类型的孔板流量计，包括限流流量计，材质统一选择 S31608，统一规范里有个最低限，统一选择 316 的。

3、转子流量计。仪表材质根据管道材质选择 S30408、S31603、钢衬，优先来说默认是等同的，没有的话高选。

4、质量流量计。仪表材质默认选择 S31603，如果有腐蚀性介质就选择 HC。有腐蚀性介质的情况，如果根据前面的选型逻辑已经匹配到质量流量计，管道材质是钢衬的，那么只能选哈氏合金，因为没有其他的可选了。

5、涡街流量计。与质量流量计相同。

吴晓：

根据样本选的口径，逻辑是怎样的。

华雷：

我会给你一个表，什么样的口径、什么样的压力，适用于的一个量程范围。

沈奕锋：

华雷这个流量计选型，就好比工艺选数据泵，离心泵、磁力泵、转子泵等等，我的第一个问题，这种做法合不合适，我是觉得不合适的。

吴晓：

泵有多少台，流量计又有多少台，量不一样的。

沈奕锋：

仪表流量计是没多少台的。

吴晓：

那么流量计可以放到最后再开发。

沈奕锋：

如果真的要这么选的话，思路要不要再规整一下，先气相和液相来分。我听下来，华雷的逻辑是先梳理好这种流量计适用于什么介质、适用于什么工况，碰到了就只选这种流量计。

思路能不能换一下。气相，如果是干净的用涡街，不干净的用什么。再液相，再蒸汽。

华雷：

流量计是比较复杂，先说下我的思路。先选型筛一遍，单类表的筛选，一种表它只能测气体或只能测液体，那么把这个表筛出来。所以先筛选掉了质量流量计，再把天然气流量计筛选掉，然后再把高粘度介质（要么只能用容积式的要么只能用电磁的）筛选掉，这种都筛选完之后就剩下了那些常规的流量计：电磁、涡街、转子。

沈奕锋：

所以工艺条件的要求就高了，什么叫高粘度，动力粘度到多少算高粘度。

华雷回复：这边我写了，到 200cp 算高粘度，但工艺条件里要提出来。如果粘度没有，我雷若数都没法算。

吴晓：

沈总刚刚的意思，你不要穷举所有的仪表，把能干的流量计先干掉，不能干的你自己人工去选。我们的目的不是解决所有问题，是要解决多的问题。比如说你把水、天然气，这种是确定掉的。

沈奕锋：

第三个问题是有些我们单位现在是不能算的，比如流量计的压损，无从算起。因为我看你反过来，压损是有限制条件的。压损质量流量计和差压流量计是要算的。

1『按沈奕锋的提醒，质量流量计管径的核对逻辑里，包括差压流量计那边，是需要压损来计算东西，但我们这边压损一般算不出来。（2022-11-25）』

天然气，因为我们平常用的天然气是那种几十千帕的天然气，我们没考虑。为什么要用涡轮就是被它的压损限制住了，因为它压力太低了。同样，其他也有这个情况，压损无从输入。

吴晓提问：你们现在是通过厂家反馈的么？

是的，或者一开始就加规则，看到压力小于 0.1MPa 的，就用涡轮。因为测气体的主要就 2 种，管道里的就转子和涡街，除非外夹式的超声波，其他的压损太大。像热电的话，它用 GE 型，或者阿里巴的，都是为了避免压损。

华雷：

我理解沈总的思路。是按某种类型的介质，什么什么条件，是某个类型的仪表。是各个选型共同判断来确定一个仪表。我现在是的思路是一个一个筛选，到最后就剩几个萝卜几个坑了。

吴晓：

刚沈总说的，你的这条路走起来难度会比较大，性价比从现在来看不一定高。

沈奕锋：

你们现在这边流量计大部分是不是用的多孔（平衡式）流量计。

华雷回复：是的，但扬农用的是普通的喷嘴，看业主有没有钱，还有看直管段够不够长，如果够长就不用平衡式的，平衡太贵了，一个平衡可以抵五六个，所以我这里没写平衡流量计。

沈奕锋：

其实可以再缩小范围，节流流量计就定死为平衡式的。逻辑简单多了，而且平衡式流量计压损比较低，只是平衡流量计不能钢衬。

其实流量计的压损不光是流量计的压损，涡街流量计一缩径的话，还要算管道减损，两个要相加的。

吴晓：

缩径更麻烦，缩进完前面的直管段还是要的，直管段的压损是工艺的，工艺还得要把直管段的压损提给仪表。管道多产生的压损是工艺要考虑进去的。

沈奕锋：

我们一般低压的时候，0.1MPa 以下才会去关心压损，比如尾气、市政天然气。

赵志明：

工艺大部分流量计都是用泵送的，自流滴加用的流量计的情况很少的。

沈奕锋：

滴加的时候流量很小，压损也很小的。

高粘度还有一种判断方法，根据它前面泵的选型，是看齿轮泵就是高粘度。

#### 液位计

室外罐区：

先看室外罐区，根据规范要求，我先做区分常压储罐和压力储罐。

常压储罐：

1、要求至少两套不同类型的液位计。这个是精细化规范要求的。其中一套为连续测量仪表或液位开关，用于高高液位联锁。液位开关会优先选择音叉液位开关，液位开关的判断是看工艺条件里液位功能代号里，不带 I 的。

液位开关这边，如果业主有另外要求：1）如果介质粘度小于 0.8cp，可以选浮球液位开关，价格便宜。2）如果介质容易刮料（含固体颗粒），介电常数大于 2μm/s，那么选用电容式液位开关或射频导纳液位开关。像液氯储罐，它不建议设备有开口，会选外贴式超声波液位开关。3）如果介质密度大于 0.8，粘度低于 8000cp，选用音叉液位开关。

2、如果低低液位涉及到安全联锁要求，工艺条件里会提要求的，跟容积率、周转率有关系的。那么也要设置独立的液位连续测量仪表或液位开关，用于低低液位联锁。

压力储罐：

1、要求至少两套不同类型的液位计，跟常压储罐是一样的。

液化烃球罐：

1、大型球罐。根据规范要求要设置 2 套液位计，而且液位计的类型是锁死的，比如现在做的海科项目，一套伺服一套雷达。同时还要设置高高、低低液位开关，这 4 个液位计，对于大型球罐，液位计的配置就定死了：1 个伺服、1 个雷达、1 个高液位开关、1 个低液位开关。其中液位开关优先选用超声波外贴式或音叉液位开关，如果项目统一规定是要音叉那么就音叉，如果没有统一规定，我自己是用外贴式超声波，因为少开口。

再来看顶部定死的伺服和雷达。1）都需要配置隔离阀，同时雷达液位计备注里写：专用液化烃雷达液位计。2）就地液位计可采用雷达或伺服液位计的罐旁指示仪。两套液位计只要有一套选就行了，我们一般是伺服配罐旁指示仪。

2、小型储罐。小型储罐规范上没有要求要设置 2 套远传仪表，那么配一套远传仪表和一套就地仪表就行了，液化烃必须要配就地液位计的。就地液位计可以采用磁翻板液位计、玻璃板液位计，数据表的备注里填需要采用保温防寒结构，纯就地液位仪表前面项目里其实可以统一定掉。远传液位计可以采用外贴式超声波液位计、雷达液位计或伺服液位计，三选一。

小罐这边只需一个高高液位开关，不像上面的大罐要求一个高高和一个低低，液位开关的选型可以采用超声波、音叉、浮球、电容式液位开关等。

再重申下：小型储罐需要配置独立就地液位计，大型储罐就地液位计是通过罐旁指示仪，不需要配磁翻板液位计了。

液氯储罐：

在氯碱规范里有要求，液面应采用两种不同的方式，采用现场显示和远传液位显示各一套，而且液位计型号也定死了。远传的要采用外测式液位计，即超声波液位计。现场液位计要选磁翻板的，规范里定死了。

就地液位计：

首选根据工艺条件里的量程范围来判断它的量程，现在给工艺提的要求，我们一般的量程范围即工艺填的最大值与最小值的差值，即液位计法兰的间距值。

就地液位计量程应覆盖整个液位计测量范围并包括高低报警及联锁点，使用多台液位计串联时，可视重叠区至少为 50mm。

1、优先采用磁翻板液位计或玻璃板液位计（设备侧面开口的）。1）磁翻板液位计，如果介质是易冻、易凝固、易结晶，那么选用伴热套管或电伴热并带保温罩。2）玻璃板液位计：低温防结霜；带色的介质不适用；长度有限制，单台玻璃板液位计不应大于 2000mm，当介质温度大于 200℃ 时，不应超过 1400mm。超了长度限制后要增加液位计，并增加设备开口；不得用于剧毒介质的测量。

2、设备要求顶部开口。优先选用顶装液位计，顶装的液位计只有顶装磁翻板液位计和钢带浮子液位计，因为这两个纯就地是不需要供电的。顶插的长度过长，才会选用钢带液位计。

远传液位计：

1、计量级储罐。目前还没想好如何判断是计量储罐，比如共用罐区的储罐是有计量要求的。首先选择计量式雷达液位计，精度要求不高于 1mm。

2、非计量型储罐。

设备高度大于 4500，优先选用差压式液位计：

常压储罐。常压的储罐选单法兰，膜片形式默认选平法兰形式（因为是单法兰差压变送器）。对于高结晶、高粘度、结胶性、沉淀性的液体，要选插入式法兰差压仪表，插入深度统一定 200。如果温度大于 100℃，隔离液要选用高温硅油。

带压设备。首先区分高度，如果小于 10m 高度，首选选用隔膜差压，但要选双法兰了。如果高于 10m，用差压的话要选电子差压系统，或者去判断如果液位计是顶部开口，那么选用雷达液位计（脉冲式）。总结就是侧装选电子差压，顶装选雷达。因为雷达比较贵，尽量选差压变送器。

设备高度小于 4500，又是清洁液体的话，选用磁翻板液位计。考虑到环境低温会结冻的介质，到时会给大龙一个表，哪些介质在低温下回结晶，那么就改用隔膜差压变送器，参照前面大于 4500 的选型逻辑。如果介电常数满足要求，采用雷达液位计，其他场合均采用磁翻板液位计。

设备高度小于 1000，又是清洁液体的话，选用浮筒液位变送器，优先选用外浮筒液位计。1）对于操作温度下不结晶、不粘稠，但在环境温度下可能结晶或粘稠的液体对象，选用内浮筒。这种工况是，因为设备里有伴热等措施，介质不会凝固，但没有保温加热设备的话就凝固，那么液位计就需要从顶部插到里面，不能从外部旁路了，所以是采用内浮筒，因为有一段是不接触介质的。2）如果介质粘度本来就很高，大于 150cp，或易结晶，或高温的液体对象，也选择内浮筒。3）其他情况下，采用磁致伸缩液位计。

还是在设备高度小于 1000 时，不采用浮筒液位计的话。如果液位测量精度要求不高，还是优先采用磁翻板液位计。1）粘度比较高，大于 150cp，改用射频导纳式液位计。2）介质温度大于 100℃，磁性液位计需要做绝热层。3）介质温度大于 250℃，磁性液位计采用高温型。

上面的都是针对清洁液体的，如果是非清洁液体，含结晶、固体颗粒，介电常数满足要求时，采用导波雷达液位计或电容式变送器。这两种液位计都要求是顶插的，要在设备顶部开口。

3、带搅拌的反应釜。选用控制级雷达液位计，连续调频波。在备注里注明。

4、不带搅拌桨的槽。1）精度要求不高，不参与控制回路时优先选用磁翻板液位计。2）涉及到回路控制，即功能代号里含有 C。如果液位范围小于 1000，改用磁致伸缩液位计。如果液位范围大于 1000，正常工况下液体密度稳定时，比如沉静槽、原料槽，采用差压变送器。正常工况下液体密度有明显变化时，比如中转槽、精馏塔回流罐，采用雷达液位计/导波雷达液位计。

5、水池。有污水池、消防水池、清水池。1）首选非接触雷达液位计。2）如果水池特别深，比如深度为 5000-10000mm 的供水池、水井、水库的液面，改用投入式液位变送器。3）如果业主对价格上有控制，要高性价比的，采用顶插内浮子液位计，备注需要配平稳套管。

6、大型储罐，如浮顶罐，还有有毒液体的连续测量，只能选用雷达液位计。

7、高压的，界面的，其他选型没法用了，那么只能采用核辐射式液位计，要根据不同的壁厚来选择放射源。

界面测量液位选型：

碰到测界面的，要根据密度差来区分，是否采用浮筒或磁浮子液位计。如果 2 个都无法满足，那么选用导波雷达液位计，它是三个中最贵的。

液位计接口：液位计接口在同一规定里已经有要求了。导图这里又补充了一些需要调整的场合。

液位计材质：

1、磁性液位计。根据设备材质来选择的，选择不锈钢材质或钢衬四氟。

2、差压液位计。跟前面差压变送器的选择是一样的。

3、雷达液位计。不锈钢或者四氟。

4、液位开关。跟雷达一样，不锈钢或者四氟。

之前海科项目，就是业主后来自己加了液位计。

液位计选型是根据介质的粘度，介质常压、带压的情况，介质是不是有控制操作和精度，测量范围，综合这些因素来判断。

吴晓：

有个问题，你起步就是储罐，要有 2 种不同规格的液位计。我们常规的逻辑是工艺给你提条件，而不是你自己看 PID 图。华雷你把储罐和容器分开的，但我们工艺的条件表里是分不开的。

华雷：

球罐在仪表条件里是可以看出来，规格就写的 φ 多少的。大储罐和容器，是一个约束条件。

吴晓：

罐区单体的好区分，按单体判断掉。车间里的，放在中间罐组的就没法区分了。

华雷：

那么对于车间内的中间罐组，大储罐的 2 台液位计就工艺人员提条件时把控，条件里 2 台（2 行），不放到自动判断逻辑里。

补充一下：大型储罐的标准是根据直径来判断，直径 5000 以上的为大型储罐。

#### 开关阀

开关阀选型首先在统一规定里把电气接口、电磁阀的类型统一掉。电磁阀类型主要是定采用低功耗、高功耗，电磁阀是否单独选用隔爆型的，防爆类型跟整个结构不一样。

开关阀是 SIS 回路的，备注 SIL2 认证，修改电磁阀线圈类型。当前当阀门是 SIS 阀门时，其动作时间要小于等于 10s（阀门的动作时间是查表获得的）。

故障位（气开气关）根据工艺条件。

开关阀的口径，同管道的口径。

1、如果判断阀门用途为：泵压缩空气开关阀，那么不选开关阀直接选型为电磁阀了。

2、如果阀门的用途为装车，那么选型为两段式装车开关阀，改成双电磁阀。

3、其他用途。填料默认为 PTFE，阀门形式默认为 O 型球阀，阀座默认为软密封。

接着根据管道等级调整参数：

1、调整法兰等级和密封面类型。阀门过程密封大于等于 PN40，填料改为柔性石墨，阀座形式改为硬密封。

2、根据管道等级调整阀体、阀芯的材质。尽量跟管道等级表统一。开关阀材质还有一个限制条件：当开关阀的上游下游设备材质高于管道材质时，阀门材质要根据设备材质来选。尤其是一些根部阀和出料阀。

接着再根据温度来调整参数：

1、温度核对。1）设备的进出口阀门，介质温度和设备内温度选择最大值。2）夹套进出口冷热媒阀门，介质温度选择冷热媒最大值。比如一个夹套里有蒸汽、循环水、冷冻水，那么阀门的温度应该按照蒸汽的最高温度来考虑。

1『上面的第一小点，又是华雷和林骏经常提到的，比如反应釜的进料管开关阀，阀门的温度、压力应该按反应釜那边更苛刻的条件靠。（2022-09-24）』

2、温度大于 100℃ 且小于 180℃，阀座改为 RPTFE；温度大于 180℃，阀座改为硬密封；介质为蒸汽或导热油，或温度大于 200℃ 或低于 -35℃，填料改为柔性石墨。

3、当管道带夹套，且工艺阀门要求为就夹套球阀时，那么开关阀配夹套，夹套介质同工艺伴热介质，补充夹套接口说明（比如统一都是 15/16 的夹套接口）。

开发阀比较简单，主要是开关阀形式、阀内件、材质的修正。

沈奕锋：

那么怎么去找出上下游条件呢。

一只压缩空气管上的开关阀，它收到上有压缩空气条件的限制，但它同时也有下游有没有配止回阀的限制（因为有止回阀，它可以不用考虑下游管道，介质返不回来嘛）。

1『华雷提到的开关阀受上下游限制，即之前提了很多次的那种反应釜进料管开关阀，好多人没有按反应釜那边更苛刻的条件来提。这个问题可以做改善，就是统一要求工艺专业在做仪表条件的时候把管道的来去向都刷掉，开关阀找所在的管道，管道找来去向定位到设备位号块，然后再拿设备里的参数。管道块里的温度压力与设备块里的温度压力取做对比。（2022-09-24）』

华雷：

我这边漏掉了一个东西，开关阀的压力也是要根据上下游的压力核对，如果设备的管道压力很高，进料管的压力又很低，要按设备那边的压力。

沈奕锋：

固体料，粉料怎么办。粉料是不能用 O 型球阀的。粉料用什么阀门更麻烦了，跟它的粘度、颗粒度都有关系的。现在很多固体粉料的开关阀是工艺提条件过来的。

华雷：

O 型球阀粉料是会被磨坏，那我到时补一下粉料阀门的选择。分析仪选型太困难了，只能手动选择，那么就剩下最后一个调节阀了。

#### 调节阀

先说下整体思路：默认认为调节阀的入口前面是有开关阀的，所以调节阀的选型只考虑到本管道内的温度压力参数以及管道等级，没有考虑上下游的，因为前面有切断阀了。

阀门材质的选择：

1、填料默认选聚四氟乙烯（PTFE），阀门形式默认为单座。柔性石墨材料还是存在各类问题的。

2、根据管道等级表调整。跟开关阀那边一样的，先根据管道等级号做调整。1）调整法兰压力等级。阀门过程密封大于等于 PN40，填料改为柔性石墨，阀座形式改为硬密封。2）调整阀体材质、阀芯材质。如果管道等级是钢衬、非金属的，那么阀体、阀内件的材质也要改成钢衬的。材质改钢衬后，阀门形式要改成波纹管密封单座，波纹管材质要改成 PTFE，原来没波纹管材质的，要加一个波纹管材质。

3、如果管道是夹套管。介质是粘稠的，阀门形式不能是单座的了，阀体改为 V 型球阀或者偏心旋转阀。

4、如果工艺介质接触水之后腐蚀性高，不接触时没啥腐蚀性的，比如氟化氢。那么阀体、阀芯要改为 S31603（项目经验），波纹管材质也改为 S31603。

1『不锈钢牌号 S31603 即为原来老叫法的 316L。（2022-09-24）补充：后来专门查了下，S30408 对应于原来的 304，S30403 对应于原来的 304L，S31608 对应于原来的 316，S31603 对应于原来的 316L。（2022-11-25）』

5、如果介质非腐蚀性介质但有毒，比如氨气、硫化氢，还是要波纹管密封，但波纹管材质用 304 就行了，阀体阀内件的材质等同工艺管道的等级表。

6、如果介质为导热油。阀门形式为波纹管密封单座，波纹管密封为 304。

7、如果为闪蒸介质，比如 1 公斤下，温度大于 100℃ 的水，或者是进闪蒸罐的进料根部阀，那么阀芯要加硬处理。

8、如果是蒸汽介质的话，阀芯也要加硬处理。同时填料要修改，跟开关阀一样，填料改为柔性石墨。

9、温度大于 200℃ 或者介质是导热油，或者温度低于 -35℃，填料改为柔性石墨。

10、温度低于 -20℃ 时，备注低温型；温度高于 220℃ 时，备注高温型。

11、阀门两端压差大于 1.5MPa，阀芯也要硬处理。

12、如果阀门的入口压力为真空，即入口压力小于 0.1MPa(A)，阀门形式要改成波纹管密封单座。

总结一下：无论是高温、真空场合，或剧毒介质或腐蚀性介质，都需要采用波纹管密封的阀门，波纹管的材质根据前面的介质条件来判断。

后面是一些计算模块。

阀门 CV 值计算（来自于样本）：

我们调节阀的条件里压力要求是绝压的，但我核对条件时发现很多工艺人员提的还是表压。

计算完 CV 值后，对于高粘度介质要去查表修正的。

拿到 CV 值之后进行公称通径的选择：

是根据最大流量下和正常流量下一个开度值去计算，要算到最大流量时的阀门开度在 85% 左右。正常开度在 40-80 之间。表里，统一口径下有很多 CV 值，我们缩径尽量值缩进一档，统一的口径选择最接近于阀门口径的那一档。

阀门口径选完后需要进行修正。1）如果算出的 CV 值小于 0.16，那么需要对阀芯硬处理，避免小阀芯磨损后对流通能力产生极大的影响。2）如果阀门口径算出来大于等于 150，那么阀门类型改为套筒阀。

调节阀是没法带夹套的，如果碰到工艺的夹套管，那么我们只能改变阀门形式来适用这种工况，比如改为偏心旋转或 V 型球阀。

突然想到，如果是高粘度的介质，那么直接用偏心旋转阀，不需要用那些公式去计算了。

沈奕锋：

华雷你这是简化后的工况，柱塞流你怎么办。

还有恐怕参数提不全的，对工艺的条件要求比以前高多了。

阀门的流量特性，等百分比的你怎么选。

华雷回复：我目前都是按等百分比去选的。

偏心旋转阀、蝶阀的阀门流量特性都不是等百分比的。

是用等百分比还是线性的，你好像没有相关逻辑算法。根据差压值在整体管道的压损，这个算法条件数据不全的。你是不可能知道整体压损的。正常的调节阀的选型流程里是有流量特性选择这一项的，调节阀的流量特性那么还是人工来选，根据流量特性再去算开度。

华雷：

我现在那个 S 型已经提给工艺要求了，让他们根据那个要求来选最合适的压损，来确保它的 S 特性在 0.3。

沈奕锋：

特别是滴加，压损都在你的阀门上，压损是避免不了的。如果工艺提出条件是避免的，你反而要怀疑是假的。滴加是典型的，上下压力全吃在调节阀上的。除了流量计，如果流量计没有的话，它上面是靠称重来计量的话，那么压损是 100% 吃在调节阀上。

现在很多滴加调节不好，我现在都怀疑是因为流量特性选的是等百分比。现在很多业主反馈，现在滴加的调节阀性能很不好。我怀疑那些设计院的人根本没考虑调节阀的流量特性。比如天辰院、美阳院那边不懂，选的时候根本不管差压，也不知道要根据压差来改选流量特性，他们无从知道。

天辰院、美阳院他们流程上有个典型的错误，往往把调节阀画在开关阀的下面。看到他们的这个错误我不会指出来的，除非特殊情况。这是小诀窍，一教大家就会了。如果调节阀在下游，滴加结束后，如果反应釜里有腐蚀性介质或者又有压力，那么靠着调节阀的，全部是调节阀在承担，其实应该是开关阀在承担的，因为开关阀是切断那条界面的。他们调节阀选型是不考虑下游的事，我们在说开关阀要考虑下游，调节阀不考虑，这个是基于调节阀下游有开关阀（切断阀）挡着的前提下的。明显小院是不注意这个细节的。

华雷补充：还有流量计和调节阀的顺序不能反，一定是先流量计再阀门，我现在看到很多把阀门放在流量计的上游，这是错误的。刚刚说的怎么来判断闪蒸，还有一种方式，去看这个设备（闪蒸罐）的进出口的管道，差一级或一级以上。

沈奕锋：

外面还是认天正的。你看前段时间徐学民去临海讲课，讲的是什么，就是他在代理艾默生的那个电子发布线。为什么会让他去，实际是源头是我们院提出机柜间这个理念导致的。但我们也没想到，艾默生后来是让徐学民去讲的。新规范出来后，机柜间不让放甲类厂房。我们引导的机柜间不合适，但 IO 间是合适的，当时提到了电子发布线。现在电子发布线用的越来越多，万华就在用。我们当时会上说中控没实现，现在听说中控那边也快要实现了。

徐学民的知识肯定是从艾默生来的，他代理艾默生的。临海仙琚那边跟徐学民关系很好的，他挤进他们的生态圈了。但说到底，最开始是被我和华雷引荐的，给他做了一次嫁衣。这就说明，设计不能光做服务，得有「产品」。

当时还没分一二单元的时候，绍兴一个项目，华雷是分项，包晓跃是项目经理，业主在二楼讨论，控制室不能设在甲乙类房间的，来问，把我也叫下去一起讨论。当时我们出了个注意，钻了个空子，说把 IO 留在车间，然后一个小诀窍，其他院全部学会了。我们没有任何好处，除非审查被打回来问为什么，那么我就不去解释了。你的知识没有得到价值体现。

我之前问过和利时，和利时说是环球院问他们的，说跟他联合开发。说为什么不做这个东西，说通用布线可以放在现场。现在都在提这个联合开发，比如设计院跟设备厂家。是环球院建议和利时开发的。

孔总：

现在老板不是也在说要从第三产业转为第二产业么。

沈奕锋：

老板应该是另外的想法，现在杭州市，第二产业非常容易拿地。很大一块地，可以造个总部大楼。当时滨江就是这个政策，给企业造个总部大楼，企业就跑不掉了。

## 20230317华雷讲解电缆逻辑

### 记录

电气和仪表桥架不能走并排的，要上下走。

如果桥架横平竖直的这种，是可以按你说的这种方式做的。但如果桥架的走向不是规则的，是弯弯曲曲的。

我后面要做的一个模块就是根据现场仪表做电缆表，我遇到的难题就是电缆桥架是弯弯曲曲的时候，如何去计算里面的电缆长度。比如桥架是 Z 字形，旁边的集中仪表如果还是按就近原则的话，我怎么去算这个长度。现在水平和垂直是好做的，按 X/Y 的绝对差就行了。

大龙：路线一旦定下来后，是可以直接拿这根线的长度属性的（类似于 CAD 的 PL 线的实体对象）。问了下墨菲，他现在是一段一段重复调函数计算出来的，效果跟拿长度属性差不多。

电缆表其实就 2 个关键东西，一个是长度，还有一个是进线密封。进线密封是要读取仪表数据表里的接口，也不能算是从仪表数据表那边，我们这个电气接口最原始的数据是从统一规定那边来的。

既然是固定的模板，那你们循环水站的仪表选型应该也是固定的。也不用纠结于你的仪表是否要供电，因为你定型你的这些一般就是要供电的。但其实你这个是偷懒的办法，并不是你这个固定模板打通了其他的也打通。本质上还是要读取你数据表上的信息来生成电缆表的，而你现在是反过来的，直接先生成电缆表。不过也没关系，我们原来自己做，也是先生成电缆表，后面数据表再人工自己修改的。

1『找华雷确认，每个大类的仪表具体是什么类型，温度、压力、流量、液位。（2023-03-20）』

大龙：电缆的型号和规格是固定的么？

不一样的，可以在一开始的同一规定里定掉。列表我邮件发你了（我之前业务建设整理好的）。

统一规定里现在只有电气接口之类的，电缆类型也直接打勾定掉。

看右边的表，K 开头的，除了后面的那个 KVV22，是用于埋地的，其他的并不是说哪个更有优势，只是范围统一的问题。后面还有 D 开头的，也是任选的。

SC 的标准信号电缆，对应的型号都是 D 开头的，是计算机软电缆。一个项目里不要出来不同的型号，用一个就行了。

EC 的电源电缆，对应的型号都是 K 开头的，是控制软电缆。也是一样的，一个项目里不要出现不同的型号。

再补充一下，你这里 K 开头的电缆，因为有部分是供电用的，供电用的电缆，型号不需要用那种 P 结尾的型号，带 P 的只能给仪表用，供电的都是不带 P 的。所以不带 P 的型号只剩 3 种了，KVV、KVVR、KYJVR，这三种里任选一个就可以。这些型号都是看项目的，没有特别的优劣之分。

还有电缆表生成的时候，前缀和后缀，比如 SC、SE 最好不要改它，省得麻烦。

## 20230405华雷仪表选型逻辑修改

选型根据逻辑，在数据表原有默认参数下一步步修正

01 工艺仪表条件处理

1.1 逻辑中相关字段数值来源：

1、液位范围

条件列：差压 / 流量 / 物（界）位 / 分析 / 重量 - 最大（max）和差压 / 流量 / 物（界）位 / 分析 / 重量 - 最小（min），这两个字段的差值。

2、设备高度。

尺寸规格提取字符串 [x] 或 [X] 或 [×] 后面的数字。如尺寸规格为：φ1200/1300x1200（h），那么设备高度为：1200。

3、最大操作温度

对温度 - 操作字段进行处理：

1）常温，替换为 30。

2）填写的是温度范围，提取范围里的最大值。如：15-120，或 15~120，提取的最大操作温度为：120。

4、最小操作温度

对温度 - 操作字段进行处理：

1）常温，替换为 30。

2）填写的是温度范围，提取范围里的最小值。如：-20~-10，或 -20~20，或 -20-20，提取的最小操作温度为：-20。

5、最大操作压力

对操作压力字段进行处理：

1）常压，替换为 0。

2）填写的是压力范围，提取范围里的最大值。如：0.1-0.3，或 0.1~0.3，提取的最大操作压力为：0.3。如果压力是带 kPa 单位的，如 10-15kPa 或 10~15kPa，提取的最大操作压力为：15kPa。

6. 量程比

差压 / 流量 / 物（界）位 / 分析 / 重量 - 最大（max）和差压 / 流量 / 物（界）位 / 分析 / 重量 - 最小（min），这两个字段的比值。如果 max 和 min 这两个字段，有一个为空值，那么就不走此逻辑了。

1.2 仪表数据表内直接复制工艺条件对应的相关数据

用途 / 管道 / 设备 / 编号尺寸 / 材质 / 介质 / 温度 / 压力

1.3 仪表数据表中仪表位号根据条件中回路号编写：

当集中代码为 L 时，同回路号，

当集中代码为 LP 时，仪表位号前缀为 xT-

当集中代码为 P，且仪表类型包含「温度」时，仪表位号前缀为 xE-

当集中代码为 LP，且仪表包含「液位开关」时，仪表位号前缀为 xS-

如果回路号的前缀包含字母 [Z]，那么仪表位号的第二位增加 [Z]

1.4 成品数据表与统一规定的对应数据

1、电气接口尺寸（NPT/M）

2、输出信号 (4~20Ma+Hart/FF/ 开关量)

1.5 备注

如果回路号包含字母 [Z]，那么数据表备注填充：SIL2 认证。

02. 压力表选型逻辑汇总

2.1 压力表选型类型初步分类

满足下面任意一个条件的，仪表类型匹配为 [差压变送器]，后续生成 [差压变送器] 的成品数据表。

1、回路号是 PD 或 PZD 开头的。

2、操作压力带有 kPa 单位，且前面的数值小于 15。

2.2 压力表隔膜元件判断

满足下面任意一个条件的，按带隔膜元件的压力仪表选型

1. 备注包含字符串 [高粘度]、[易结晶] 、[固体颗粒]。

2. 备注包含字符串 [腐蚀]。

3. 材质为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、聚丙烯、聚乙烯、316L、PTFE、PFA、PP、PE 和特殊材质如钛、哈氏合金等

4 . 介质中包含常见的强腐蚀介质：氟化物、氯气 、盐酸、硫酸、氢氟酸等

2.3 压力表测量元件类型判断

带隔膜元件同时量程 MPa, 那么该字段更改为：隔膜

带隔膜元件同时量程 kPa,, 那么该字段更改为：膜片

不带隔膜元件同时量程 kPa, 那么该字段更改为：膜盒

2.4 匹配到仪表类型之后部分参数的修正

01. 所有类型仪表的参数调整

1、测量元件密封液 - 前提条件是：带隔膜元件

如果组分及名称内包含字符串 [氯气] 或 [硝酸] 或 [过氧化氢]，测量元件密封液修改为 [氟碳润滑剂]。

2、测量元件材质 - 前提条件是：带隔膜元件

如果组分及名称内包含字符串 [发烟硫酸] 或 [HF] 或 [氟化物]，测量元件材质修改为 [哈氏合金 C]。

如果组分及名称内包含字符串 [盐水] 同时不含 [冷冻盐水]，测量元件材质修改为 [钛材]。

3、测量范围

01 最大压力大于等于 0.1 的量程获取

如果压力全部为正值的情况：

步骤一：获取用于匹配量程的 [量程压力]。量程压力的获取逻辑仅与 [设计压力] 和 [操作压力] 有关。

1、如果设计压力有值，直接取设计压力，乘以 1.1 倍，即为量程压力。

2、如果设计压力为空，且操作压力是单个值（不是一个范围），如 0.35MPa，那么取操作压力，乘以 1.5 倍获得量程压力。

3、如果设计压力为空，且操作压力是一个范围，如 0.2~0.4MPa，那么通过取操作压力范围拿到最大的压力 0.4，然后乘以 1.1 倍获得量程压力。

步骤二：根据量程压力匹配量程。

将量程压力与压力量程表匹配出最合适的量程范围中

0~0.16M/0.25M/0.4M/0.6M/1.0M/1.6M/2.5M/4.0M/6M/10M/16 M/25 M/40 M/60 M

如果压力有负值的情况：

如果压力的最大值是正值，那么走下面的逻辑。

步骤一：获取用于匹配量程的 [量程压力]。

1、如果设计压力有值且为正值，直接取设计压力，乘以 1.1 倍，即为量程压力。

2、如果设计压力为空，且操作压力是一个范围，如 - 0.098~0.4MPa，那么通过取操作压力范围拿到最大的压力 0.4，然后乘以 1.1 倍获得量程压力。

步骤二：根据量程压力匹配量程。

最终要匹配的量程区间汇总：

"-0.1~0.06M"

"-0.1~0.15M"

"-0.1~0.3M"

"-0.1~0.5M"

"-0.1~0.9M"

"-0.1~1.5M"

"-0.1~2.4M"

02 最大压力小于 0.1 的量程获取

如果压力全部为正值的情况：

步骤一：获取用于匹配量程的 [量程压力]。逻辑完全参考压力大于 0.1 的场景。

步骤二：根据量程压力匹配量程。

现在的量程压力的单位是 MPa，需要先转为 kPa，然后再去匹配量程区间。

最终要匹配的量程区间汇总：

"0~1.6kPa"

"0~2.5kPa"

"0~4kPa"

"0~6kPa"

"0~10kPa"

"0~16kPa"

"0~25kPa"

"0~40kPa"

如果压力全部为负值的情况：

步骤一：获取用于匹配量程的 [量程压力]。

1、如果设计压力有值且为负值，直接取设计压力，乘以 1.1 倍，即为量程压力。

2、如果设计压力为空，且操作压力是单个值且为负值（不是一个范围），如 - 0.05MPa，那么取操作压力，乘以 1.5 倍获得量程压力。

3、如果设计压力为空，且操作压力是一个范围且最大最小都为负值，如 - 0.098~-0.05MPa，那么通过取操作压力范围拿到最左侧最大的负值，如举例中的 - 0.098，然后乘以 1.1 倍获得量程压力。

步骤二：根据量程压力匹配量程。

现在的量程压力的单位是 MPa，需要先转为 kPa，然后再去匹配量程区间。

最终要匹配的量程区间汇总：

"-1.6~0kPa"

"-2.5~0kPa"

"-4~0kPa"

"-6~0kPa"

"-10~0kPa"

"-16~0kPa"

"-25~0kPa"

"-40~0kPa"

如果压力既有正值又有负值的情况：

步骤一：获取用于匹配量程的 [量程压力]。此时要分别拿到正值的量程压力和负值的量程压力，分别取匹配量程范围的最小值和最大值。

符合这种情况的时候，操作压力肯定是一个范围值，最小值是负值，最大值是正值。

如 - 0.098~0.2MPa，取最小值（负值）乘以 1.1 获取负值的量程压力；取最大值（正值）乘以 1.1 获取正值的量程压力。

步骤二：根据负值量程压力和正值量程压力匹配量程。

现在的量程压力的单位是 MPa，需要先转为 kPa，然后再去匹配量程区间。

负值量程压力和正值量程压力，取绝对值大的取匹配量程。

最终要匹配的量程区间汇总：

"-0.8~0.8kPa"

"-1.2~1.2kPa"

"-2~2kPa"

"-3~3kPa"

"-5~5kPa"

"-8~8kPa"

"-12~12kPa"

"-20~20kPa"

02. 隔膜压力表 / 隔膜抗震压力表 / 膜片压力表的参数调整

1、过程连接相关参数的调整

所在管线或设备是管道，根据管道编号的形式来判断，如上图所示。

步骤一：根据管道编号获取管径。如上图中的 FN340603-15-2F1，获取管径为 15。

步骤二：如果管径小于 25。

1）过程连接规格更改为：20-16RF。

2）过程连接方式更改为：工字型法兰。

03. 不锈钢压力表 / 不锈钢抗震压力表 / 膜盒压力表的参数调整

1、过程连接相关参数的调整

如果所在管线或设备是管道，根据管道编号的形式来判断。

步骤一：根据管道编号获取管径。如上图中的 FN340603-10-2F1，获取管径为 10。

步骤二：如果管径小于 15。

1）过程连接规格更改为：M14x1.5 (M)。

2）表头直径更改为：60。

3）精度更改为：2.5。

如果仪表用途为：消防泵试验压力。那么，

1）表头直径更改为：150。

2）精度更改为 0.4。

备注：此修正的优先级比所在位置是管道且管径小于 15 的优先级更高。

04. 压力变送器的参数调整

1、安装方式及精度修正

如果操作压力带有 kPa 单位，且前面的数值小于等于 20，那么：1）安装方式（更改为：引远安装。2）精度更改为：±0.055。

2、测量元件形式

备注：以下条件逻辑的优先级依次增高。

逻辑 1：参考就地压力表那边的逻辑判断隔离元件的形式是：隔膜、膜片、膜盒中的一个。

如果匹配出来的是隔膜压力表，那么该字段更改为：隔膜。

如果匹配出来的是膜片压力表，那么该字段更改为：膜片。

如果匹配出来的是膜盒压力表，那么该字段更改为：膜盒。

3、隔膜压力表相关参数的修正

对于压力变送器和差压变送器，如果测量元件形式为 [隔膜]，那么：

1、密封液字段更改为：硅油

2、测量元件连接该字段更改为：直接连接

3、过程连方式该字段更改为：法兰

4、过程连标准 ', 该字段更改为：HG/T20592

5、 过程连规格 ', 该字段更改为：50-16RF

05. 就地压力表的参数调整

1、备注修正

如果就地压力表的仪表用途包含字符串：爆破片出口。那么，备注更改为：带高限压力记忆指示功能。

03. 温度计选型逻辑汇总

3.1 温度计类型匹配逻辑

就地温度计最终匹配出来的仪表类型汇总：双金属温度计、液体压力式温度计。

集中温度计最终匹配出来的仪表类型为：一体化温度变送器、热电阻、热电偶。

1.1 就地温度计类型匹配

如果回路号是 TG，说明此仪表为就地温度计，仪表名称直接设为：双金属温度计。

1.2 远传温度计类型匹配

如果回路号不是 TG，说明此仪表为远传温度计，TT - 为：一体化温度变送器。TE - 为热电阻、热电偶。

3.2 匹配到仪表类型之后部分参数的修正

01. 双金属温度计的参数调整

1、套管插入深度

如果所在管线或设备是管道，根据管道编号的形式来判断

步骤一：根据管道编号获取管径。如上图中的 FN340603-65-2F1，获取管径为 65。当管径小于 100，备注：管径扩径至 DN100, 套管插入深度赋值为：U=200

步骤二：如果所在管线或设备不是管道。

如果备注不包含字符串 [插入深度] 直接返回为空。如果包含，那么取紧跟着 [插入深度] 后的数字，举例，插入深度 600mm，那么取值 600。然后将数字拼接为字符串 [U=600]。

2、套管材质

如果测量介质为腐蚀性介质，那么修正为：钢衬四氟。符合如下任何一个条件的即为腐蚀性介质：1）备注包含字符串 [腐蚀]。2）仪表条件表中，材质为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯、PTFE、PFA、PP、PE。

3、套管相关的其他参数

备注包含字符串 [设备带套管]。

进行如下操作：1）套管型号更改为：设备带套管。2）传感器形式更改为：卡套 M27x2 (M)。3）套管形式、套管材质、套管直径、过程连接方式、过程连接材质、过程连接规格，上述字段全部置为空。

02. 一体化温度变送器的参数调整

1、套管插入深度

完全参考双金属温度计参数调整的逻辑。

2、套管材质

完全参考双金属温度计参数调整的逻辑。

3、套管相关的其他参数

完全参考双金属温度计参数调整的逻辑。

4、分度号

如果温度 - 操作大于 600，或者仪表用途包含字符串 [泵出口]、[风机出口]。那么：分度号更改为：K。

03. 测量范围获取逻辑

如果温度全部为正值的情况：

步骤一：获取用于匹配量程的 [量程温度]。量程温度的获取逻辑仅与 [操作温度] 有关。

1、如果操作温度是单个值（不是一个范围），如 25，那么取操作温度乘以 1.5 倍获得量程温度。

2、如果操作温度是一个范围，如 28~121，那么通过取操作温度范围拿到最大的温度 121，然后乘以 1.1 倍获得量程温度。

步骤二：根据量程温度匹配量程（测量范围）。

量程温度往上靠量程区间，如量程温度是 140，那么匹配出来的量程区间为：0~150。

最终要匹配的量程区间（测量范围）汇总：

0~50

0~100

0~150

0~200

0~300

0~400

0~500

0~600

0~700

0~800

3. 当操作温度在 0~5 之间，温度量程定为 - 40~80℃

如果温度有负值的情况：

1、如果操作温度是单个值且为负值（不是一个范围），如 - 15，那么取操作温度除以 0.5 获得量程温度为 - 30。

2、如果操作温度是一个范围，如 - 15~10，那么通过取操作温度范围拿到最左侧最大的负值，如举例中的 - 15，然后除以 0.9 获得量程温度。

如 - 15~10，获得的量程温度为：-17。

步骤二：根据量程温度匹配量程（测量范围）。

量程温度往大了靠量程区间，如量程温度是 - 17，那么匹配出来的量程区间为：-40~80。

最终要匹配的量程区间（测量范围）汇总：

-80~40

-40~80

04. 液位计选型逻辑汇总

4.1 液位计类型匹配逻辑

就地液位计最终匹配出来的仪表类型汇总：磁性液位计、玻璃板液位计。

集中液位计最终匹配出来的仪表类型汇总：液位开关、差压变送器、雷达液位计、伺服液位计、超声波液位计、电浮筒液位计、磁致伸缩液位计。

备注：液位范围，是公用逻辑中处理后得到的字段。

1.1 就地液位计类型匹配

如果回路号是 LG，说明此仪表为就地液位计。

仪表名称默认设为：磁性液位计。

如果同时满足下面 2 个条件的话，更改为：玻璃板液位计。

1）如果备注包含字符串 [玻璃板]。

2）液位范围小于等于 2000。

1.2 集中液位计类型匹配

如果回路号不是 LG，说明此仪表为远传液位计。

首先看回路号里是否含有字符串 [I]，如果包含，那么仪表名称默认设为：磁性液位计。否则，仪表名称设为：液位开关。

满足下面任何一个条件的，仪表名称更改为：差压变送器。

条件 1：备注包含字符串 [压差液位计] 或 [差压液位计]。

条件 2：最大操作温度大于 250。

条件 3：回路号中包含字符串 [C] 且液位范围大于 1000 小于 10000。

条件 4：备注包含字符串 [高粘度]、[易结晶]。

满足下面任何一个条件的，仪表名称更改为：雷达液位计。

条件 1：备注包含字符串 [雷达] 或 [顶插]。

条件 2：测量控制点名称（包含字符串 [水池液位]、[计量罐]、[反应釜液位]。

条件 3：设备高度大于 10000。

满足下面任何一个条件的，仪表名称更改为：电浮筒液位计。

条件 1：备注包含字符串 [电浮筒液位计]。

条件 2：设备高度小于 1000。

条件 3：备注包含字符串 [易汽化] 或 [宜汽化]。

满足下面任何一个条件的，仪表名称更改为：磁致伸缩液位计。

条件 1：备注包含字符串 [磁致伸缩]。

条件 2：回路号中包含字符串 [C] 且液位范围小于等于 1000。

4.2 填充仪表数据表初版数据

填充直接来自工艺条件的参数，见 1.2 仪表数据表内直接复制工艺相关数据

4.3 匹配到仪表类型之后部分参数的修正

01. 磁性液位计的参数调整

1、指示器触液材质

如果测量介质为腐蚀性介质，那么更改为：钢衬四氟。

符合如下任何一个条件的即为腐蚀性介质：1）备注包含字符串 [腐蚀]。2）仪表条件表中，材质含下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯、PTFE、PFA、PP、PE。

02. 液位开关的参数调整

1、探头材质

如果测量介质为腐蚀性介质，那么更改为：钢衬四氟。

符合如下任何一个条件的即为腐蚀性介质：1）备注包含字符串 [腐蚀]。2）仪表条件表中，材质含下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯、PTFE、PFA、PP、PE。

03. 雷达液位计的参数调整

1、过程连接规格

如果操作压力为：常压，那么更改为：100-16RF。

2、指示器触液材质

如果测量介质为腐蚀性介质，那么更改为：PTFE。

符合如下任何一个条件的即为腐蚀性介质：1）备注包含字符串 [腐蚀]。2）仪表条件表中，材质含下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯、PTFE、PFA、PP、PE。

04. 差压变送器的参数调整

1、安装方式

更改为：

毛细管：LP:5mxHP:5m

2、附件

更改为：配不锈钢支架。

05. 开关阀选型逻辑汇总

5.1 阀门类型匹配逻辑

最终匹配出来的阀门类型汇总：开关阀、电磁阀。

仪表名称默认设为：开关阀。测量控制点名称（包含字符串 [压缩空气开关阀] 或 [压缩空气管道开关阀]，那么仪表名称更改为：电磁阀。

5.2 填充仪表数据表初版数据

01. 开关阀的参数调整

1、过程连接规格

开关阀所在管线或设备肯定是管道，根据管道编号获取管径。如上图中的 FN340603-65-2F1，获取管径为 65。那么过程连接规格更改为：65-16RF。

2、阀芯阀座材质

最大操作温度大于 100 且小于等于 180，那么更改为：304/RPTFE。

3、阀体填料材质

满足下面任意一个条件的话，那么更改为：柔性石墨。

1）最大操作温度大于 200。

2）最小操作温度小于 - 35。

3）组分及名称内包含字符串 [蒸汽] 或 [导热油]。

4）温度、压力线在阴影部分外

4、阀门失能位置

直接取仪表条件表里的阀门失能位置。

5、阀体形式仪表条件表

默认为 O 型球阀，如果仪表条件表备注有上展式釜底阀，改为上展式釜底阀，如果阀门口径大于 200，那么更改为：双偏心蝶阀。

如果仪表条件表备注有卫生型，改为卫生型隔膜阀

6、执行机构关闭时间仪表条件表

1、首先判断是否为 SIS 仪表。是否是 SIS 仪表前面逻辑做过，直接调用。

判断逻辑：回路号包含字母 [Z] 即为 SIS 仪表。

如果为 SIS 仪表，该字段直接设为：≤10s

2、如果不是 SIS 仪表，需要根据管径来匹配。

开关阀所在管线或设备肯定是管道，根据管道编号获取管径。如 FN340603-65-2F1，获取管径为 65。（这个逻辑之前很多地方用到，直接调用）

管径与执行机构关闭时间的对应关系汇总如下：

25：≤2s

40：≤2s

50：≤5s

65：≤5s

80：≤5s

100：≤10s

125：≤10s

150：≤20s

200：≤20s

250：≤20s

300：≤25s

400：≤40s

500：≤40s

600：≤50s

1000：≤60s

7、阀门附件修改

直接取仪表条件表里的阀门失能位置。

回路号包含字母 [Z] 即为 SIS 阀门。电磁阀 - 工作电压修改为【24VDC (3.7W) , 耐高温（H 级）绝缘线圈，长期励磁型】

阀门失能位置为 FL 时，电磁阀 - 形式改为【二位五通 / 单电控 / 电开】

06. 调节阀选型逻辑汇总

6.1 阀门类型匹配逻辑

仪表名称默认设为：调节阀。

6.2 填充仪表数据表初版数据

填充直接来自工艺条件的参数，见 1.2 仪表数据表内直接复制工艺相关数据

6.3 匹配到仪表类型之后部分参数的修正

1、过程连接规格

等同开关阀那边的逻辑。

2、阀体形式仪表条件表

备注：以下条件逻辑的优先级依次增高。

条件逻辑 1：符合下面任何一个条件的，那么更改为：波纹管密封单座。

1、仪表条件表中，材质含下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

2、组分及名称内包含字符串 [HF] 或 [氟化氢]。

3、组分及名称内包含字符串 [NH3] 或 [氨气] 或 [H2S] 或 [硫化氢] 或 [导热油] 或备注里标注【剧毒】。

4、操作压力有值，且小于 0.1。

条件逻辑 2：所在管道为夹套管，那么更改为：偏心旋转阀。夹套管的获取逻辑：所在管道的编号形式与工艺专业的自定义管道编号里夹套管的编号形式相同。

3、阀体波纹管材质

备注 1：以下 if 条件逻辑的优先级依次增高。备注 2：此字段，默认为空，只在阀体形式仪表条件表字段更改为 [波纹管密封单座] 才会走下面的逻辑赋值。

1、仪表条件表中，材质含下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。此字段更改为：PTFE。

2、当管道材质为金属，且组分及名称内包含字符串 [HF] 或 [氟化氢]。此字段更改为：PTFE。

3、组分及名称内包含字符串 [NH3] 或 [氨气] 或 [H2S] 或 [硫化氢] 或 [导热油]。此字段更改为：S30408。

4、阀体材质仪表条件表

备注：以下 if 条件逻辑的优先级依次增高。

1、仪表条件表中，材质含下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯、PTFE、PFA、PP、PE。此字段更改为：WCB+F46。

2、组分及名称内包含字符串 [HF] 或 [氟化氢]。此字段更改为：S31603。

5、阀芯阀座材质

备注：以下 if 条件逻辑的优先级依次增高。

1、仪表条件表中，材质含下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。此字段更改为：304+F46。

2、组分及名称内包含字符串 [HF] 或 [氟化氢]。此字段更改为：S31603。

3、组分及名称内包含字符串 [蒸汽]。此字段更改为：S304+ST。

4、阀前阀后压差大于 1.5。此字段更改为：S304+ST。阀前阀后压差的获取逻辑：仪表仪表条件表里，阀前压力字段和阀后压力字段的差值。

6、阀体填料材质

满足下面任意一个条件的话，那么更改为：柔性石墨。

1）最大操作温度大于 200。

2）最小操作温度小于 - 35。

3）组分及名称内包含字符串 [蒸汽] 或 [导热油]。

4）管道等级号的首个数字大于等于 4。管道等级号的获取逻辑：开关阀所在管线或设备肯定是管道，根据管道编号结合工艺专业那边的自定义管道编号形式，获取管道等级号。如管道号 FN340603-65-4J1，管道等级号为 4J1，管道等级号的首个数字为 4。

7、备注

备注：以下 if 条件逻辑的优先级依次增高。

1、最小操作温度小于 -20。1）如果此字段为空值。此字段更改为：低温型。1）如果此字段有值，如为：SIL 认证。那么此字段需要在原值后面拼接字符串 [；低温型]，更改为：[SIL 认证；低温型]。

2、最大操作温度大于 220。1）如果此字段为空值。此字段更改为：高温型。1）如果此字段有值，如为：SIL 认证。那么此字段需要在原值后面拼接字符串 [；高温型]，更改为：[SIL 认证；高温型]。

备注：因为在前面的逻辑 [01. 所有类型仪表共用逻辑汇总> 1.2 成品数据表内工艺相关数据填充] 会对备注字段进行处理，如果回路号包含字母 [Z]，那么备注填充：SIL 认证。所以备注字段此时可能有值，有值的话不能被覆盖掉，所以有值和空值的情况分开考虑。

6.4. 公称流通能力相关值的获取逻辑

2.1 最大阀门 Cv 值和正常阀门 Cv 值计算

看组装相态是液体、蒸汽、气体 3 种情况：

如果 [组装相态] 是 [液态] 或 [L]，那么：

Cv=Q*1.17*SQRT(ρ/((P1-P2)*10*1000))

Q：最大流量或者正常流量，字段 [max] 和 [nomal]

P1：最大 / 正常 / 最小流量时绝压 (MPaA)- 阀前压力

P2：最大 / 正常 / 最小流量时绝压 (MPaA)- 阀后压力

ρ：密度仪表条件表

t：温度 - 操作

如果 [组装相态] 是 [汽态] 或 [S]，那么：

如果 P1<2P2

如果 P1≥2P2

备注：过热温度先按 0 考虑，后续再补充查表的逻辑。

如果 [组装相态] 是 [气态] 或 [G]，那么：

如果 P1<2P2

如果 P1≥2P2

通过上面的计算公式，使用最大流量算出来的是最大阀门 Cv 值，使用正常流量算出来的是正常阀门 Cv 值。

最大阀门 Cv 值和正常阀门 Cv 值，填到数据库表里的下面位置，举例：26.63/38.89。

2.2 计算最大和正常阀门开度

1、获得计算可调比 R

如果阀体形式仪表条件表包含 [单座]，那么取值 50，否则取值 100。

2、查表获得公称流通能力。

通过：1）调节阀所在管道尺寸（很多地方用到此逻辑，如开关阀所在管道的尺寸）；2）阀体形式仪表条件表。这 2 个数据查表调节阀公称流通能力（ks_valve_rated_Cv） 获得公称流通能力。

[ks_valve_rated_Cv.xlsx]

通过计算最大阀门开度校验公称流通能力。

最大阀门开度计算：

LOG：数学上的对数，以 10 为底。

公称流通能力：查表获得的。

Cv：前面逻辑计算获得的最大阀门 Cv 值。

如果算出的最大阀门开度在 0.7-0.9 之间，满足条件终止。

如果算出的最大阀门开度小于 0.7，那么查表的时候缩小一档，缩档后还是无法满足小于 0.7，那么取最后一档的值。

如果算出的最大阀门开度大于 0.9，取算出来值。（后续逻辑迭代）

公称流通能力确定后，还是用同样的公式计算正常阀门开度计算：

LOG：数学上的对数，以 10 为底。

公称流通能力：前一步确定的。

Cv：前面逻辑计算获得的正常阀门 Cv 值。

最大阀门开度和正常阀门开度，需将小数转为百分比，如 0.84 转化为 84%，填到数据库表里的下面位置，举例：62%/84%。

07. 流量计选型逻辑汇总

7.1 流量计类型匹配逻辑

就地流量计最终匹配出来的仪表类型汇总：转子流量计、水表。

集中流量计最终匹配出来的仪表类型汇总：电磁流量计、转子流量计、质量流量计、涡街流量计、旋涡流量计、容积式流量计、差压流量计、超声波流量计。

1.1 就地流量计类型匹配

仪表类型仪表条件表为流量，且仪表类别为：L，那么此仪表为就地流量计。

仪表名称默认设为：转子流量计。

如果回路号为：FQ，那么更改为：水表。

1.2 集中流量计类型匹配

除就地流量计以外的流量计均为远传量计。

那么仪表名称默认设为：电磁流量计。但如果 [组装相态] 是 [液态] 或 [L]，那么默认流量类型是电磁流量计，否则默认的流量类型为旋涡流量计。

满足下面任何一个条件的，仪表名称更改为：质量流量计。

条件 1：备注包含字符串 [质量流量计]。

条件 2：组分及名称内包含字符串 [氢气] 或 [一氧化碳]。

满足下面任何一个条件的，仪表名称更改为：涡街流量计。

条件 1：组分及名称内包含字符串 [天然气]。

条件 2：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 250。3）同时，状态仪表条件表为字符串 [气态] 或 [气相] 或 [G]；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值大于等于 20，且工作压力仪表条件表的值大于 0.1。

条件 3：1）组分及名称内包含字符串 [蒸汽] 2）同时，所在管道的管径小于等于 250。

满足下面任何一个条件的，仪表名称更改为：涡轮流量计。

条件 1：备注包含字符串 [涡轮流量计]。

条件 2：组分及名称内包含字符串 [天然气]。

满足下面任何一个条件的，仪表名称更改为：差压式流量计。

条件 1：备注包含字符串 [差压式流量计]。

条件 2：1）组分及名称内包含字符串 [蒸汽]。2）同时，所在管道的管径大于 250。

满足下面任何一个条件的，仪表名称更改为：容积式流量计。

条件 1：备注包含字符串 [容积式流量计]。

条件 2：备注包含字符串 [高粘度] 同时量程比小于等于 10。

满足下面任何一个条件的，仪表名称更改为：超声波流量计。

条件 1：备注包含字符串 [超声波流量计]。

条件 2：1）备注包含字符串 [高粘度]。2）同时，量程比大于 10。

条件 3：1）所在管道为金属。2）同时，状态仪表条件表为字符串 [气态] 或 [气相] 或 [G]；3）同时，量程比大于 10。

条件 4：1）所在管道为金属。2）同时，所在管道的管径大于等于 800。3）介质为水

满足下面任何一个条件的，仪表名称更改为：转子流量计。

条件 1：备注包含字符串 [转子流量计]。

条件 2：1）所在管道为非金属管道或耐腐蚀金属；2）同时，状态仪表条件表为字符串 [液态] 或 [液相] 或 [L]；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 1。

条件 3：1）所在管道为非金属管道或耐腐蚀金属；2）同时，状态仪表条件表为字符串 [气态] 或 [气相] 或 [G]；3）同时，量程比小于 10。

条件 4：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 100。3）同时，状态仪表条件表为字符串 [液态] 或 [液相] 或 [L]；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 1 或者工作压力仪表条件表的值小于 0.1。

条件 5：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 100。3）同时，状态仪表条件表为字符串 [气态] 或 [气相] 或 [G]；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 20，且工作压力仪表条件表带有单位 kPa，值大于 10。

满足下面任何一个条件的，仪表名称更改为：电磁流量计。

条件 1：备注包含字符串 [电磁流量计]。

条件 2：所测量的介质导电。介质导电的判断逻辑：组分及名称内包含字符串 [循环水]、[冷却水]、[自来水]。

条件 3：1）所在管道为非金属管道或耐腐蚀金属；2）同时，状态仪表条件表为字符串 [液态] 或 [液相] 或 [L]；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值大于等于 1；4）同时工作压力仪表条件表的值大于 0.1。

7.2 填充仪表数据表初版数据

填充直接来自工艺条件的参数，见 1.2 仪表数据表内直接复制工艺相关数据

7.3 匹配到仪表类型之后部分参数的修正

00. 所有流量计的参数调整（除转子流量计之外）

1、测量范围

步骤一：获取量程流量。

流量 1：正常流量（nomal）乘以 1.5 倍。

流量 2：最大流量（nomal）乘以 1.12 倍。

比较流量 1 和流量 2 哪个大，大的即为量程流量。

步骤二：圆整量程流量。

小于等于 10 的，往上取整数。如 8.3 取整为 9。 大于 10 小于等于 1000 的，往上取整为 5 的倍数。如 123 取整为 125。 大于 1000 的，往上取整为 50 的倍数。如 1243 取整为 1250。

步骤二：获得测量范围。

测量范围：0~ 圆整量程流量。

如圆整量程流量为 1250，那么测量范围为：0~1250。

01. 质量流量计的参数调整

1、精度

如果组分及名称内包含字符串 [氢气] 或 [一氧化碳]，那么更改为：1。

2、测量元件材质

所在管道为非金属管道或耐腐蚀金属，那么更改为：哈氏合金 C。

02. 涡街流量计的参数调整

1、备注

备注：以下条件逻辑的优先级依次增高。

符合条件逻辑 1，那么更改为：一体化压力补偿。

条件逻辑 1：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 250。3）同时，状态仪表条件表为字符串 [气态] 或 [气相] 或 [G]；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值大于等于 20，且工作压力仪表条件表的值大于 0.1。

符合条件逻辑 2，那么更改为：一体化温度压力补偿。

条件逻辑 2：1）组分及名称内包含字符串 [蒸汽] 2）同时，所在管道的管径小于等于 250。

3、过程连接规格

根据所在管道编号获取管径，再缩小一档。如 FN340603-65-2F1，获取管径为 65，缩小一档为 50。那么过程连接规格更改为：50-16RF。

备注：管径缩档的逻辑详见发酵模块那边匹配管径时写的逻辑。

02. 涡轮流量计的参数调整

1、精度

更改为：0.5% of reading。

03. 电磁流量计的参数调整

1、过程连接规格

根据所在管道编号获取管径。如 FN340603-65-2F1，获取管径为 65。那么过程连接规格更改为：65-16RF。

2、电极材质、接地环材质

备注：以下条件逻辑只要匹配到一个直接跳出。

符合条件逻辑 1 或条件逻辑 2，那么电极材质、接地环材质更改为：哈氏合金 C。

条件逻辑 1：所在管道为非金属材质。

管道为非金属材质的判断逻辑：仪表条件表中，材质含下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

条件逻辑 2：1）所在管道为碳钢 / 不锈钢。2）同时，组分及名称内包含字符串 [浓硫酸]。

符合条件逻辑 3，那么电极材质、接地环材质更改为：Ta。

条件逻辑 3：1）所在管道为碳钢 / 不锈钢。2）同时，组分及名称内包含字符串 [浓硝酸]。

符合条件逻辑 4，那么电极材质更改为：哈氏合金 C。接地环材质更改为：N/A。

条件逻辑 4：1）所在管道为碳钢 / 不锈钢。2）同时，组分及名称内包含字符串 [Cl-]、[NaCl]、[氯离子]、[氯化钠]。

3、电磁流量计口径大于 250 时的参数调整

如果流量计所在管道的尺寸大于 250，那么：1）村里材质更改为：聚醛树脂（探头绝缘环）。2）过程标准置为空值。3）过程规格更改为：插入式。4）精度更改为：2.5。2）附件更改为：焊接套管、球阀。

04. 转子流量计的参数调整

1、附件

备注：以下条件逻辑的优先级依次增高。

符合条件逻辑 1，那么更改为：气阻尼。

条件逻辑 1：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 800。3）同时，状态仪表条件表为字符串 [气态] 或 [气相] 或 [G]；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 20，且工作压力仪表条件表带有单位 kPa，值大于 10。

2、转子流量计材质

转子流量计材质按 S30408 S31608 S31603 钛钢衬四氟选择，材质不低于管道材质，这个可以人工选择

3. 转子流量计的计算

转子流量计的口径和量程等参数计算通过自动计算数据表实现

05. 差压式流量计的参数调整

符合条件逻辑 1，那么备注增加：一体化温度压力补偿。附件增加：带冷凝器

条件逻辑 1：1）组分及名称内包含字符串 [蒸汽]。

符合条件逻辑 2，那么备注增加：一体化压力补偿。

条件逻辑 2：1）组分及名称内包含字符串 [空气]、[氮气]

## 20230523仪表中控室机柜间方案评审

### 会议纪要

可以直接先发送 pdf 的链接。

请通过以上这份文档（会议录音文字）写一份会议纪要。要求：1）首先总结本次会议的主要内容，本次会议的主题是数智设计动力车间模块方案评审。2）接着，总结参会人员发表的意见和要求。文档里每段开头字符串"："前面的是参会人员的姓名，没有姓名的段落默认为汇报人"孙亮"的发言。3）接着，总结本次会议的关键决定。4）接着，总结本次会议的后续行动项或下一步计划。

首先华雷汇报了中控室自动布置的实现逻辑。主要实现逻辑如下：1）先根据输入清单，明确各个房间的功能需求、点数要求、数量等输入数据。房间包括必选房间、根据项目条件判断设置的房间以及由业主选择设置的房间三大类。2）根据这些需求计算出各个房间的最小面积。长宽可以调整，但最小面积要满足要求，方便后面的自动排布。3）根据总图条件确定电缆入口池和人员进出口的位置。4）根据电缆入口池和人员进出口划分不同的走廊分割方案。5）根据计算的房间总面积与总图条件的总面积比较，确定一层还是二层设置。6）根据房间的优先级顺序，把这些房间填充进前面根据走廊划分的大块区域里。7）最后在相关位置开门。

各技术线的领导对该模块的实现方案做了初步审查和补充。提出以下建议和要求：

1、数智设计开发团队调研考虑技术上实现房间拼接的逻辑。

2、考虑满足约束条件后生成多个方案的选择问题。如果满足条件的方案出来很多种，需要考虑如何筛选，如何保留最核心的几个推荐给业主。

### 记录

华雷：因为机柜间比控制室少很多房间，这次的评审只要以控制室为主。

华雷：控制室这边，业主先填写我提供的需求清单。总共有 3 类房间。第一种是必填的房间，比如说：机柜间、操作间、工程师站间、UPS 间、配电间、空调机房、补风间、排风间，这些房间对中控室来说是必填的（一定要设置的）。第二类房间是根据项目条件判断的，比如气体灭火间、抗暴隔离前室。在必填的房间里，明显要填的数据有：房间的点数、房间的数据，其中这些房间的尺寸，是值它允许的最小房间尺寸。第三类房间是由业主来选择的，主要业主填了数据，说明有这个房间，数量不填说明无需设置该房间。最后还有一些其他要求，比如：操作台排列风格、参观要求、进线方式、电缆进线位置、门的位置、层数、分控室。

华雷：首先确定机柜间的进线位置。进线位置，有些外部条件也是要根据总图来定的。首先，电缆入口池的位置要靠近外管架。另外，人员入口是不能朝着甲乙类装置的。所以电缆池入口和人员入口，目前是考虑认为选择的。这 2 个输入信息在前面的需求表里也有的，是用户打勾东南西北四个方向。

华雷：选完这 2 个位置之后，后面通过一系列逻辑判断，对各类房间来进行计算的。

华雷：机柜间。输入总点数和房间数据后，通过一些逻辑（主要是数学方法）来得出这些机柜间的尺寸要求。

华雷：操作间，前面的输入清单，要求输入电脑的台数，因为电脑台数跟人员数量相关，需要用户给定。电脑台数给定后，通过选择是直行排列还是弧形排列，然后计算出不同排列形式下，操作间最优化的面积大小。最优面积的获取逻辑：在特定的排布形式下，特定数量的操作台，并且满足规范的要求。规范的要求包括：1）操作台正面距离房间墙的净距离 4m。2）操作站背面距房间墙的净距离 1.5m。3）操作站侧面距房间墙的净距离 2m。4）多排操作站之间的间距 2m。5）当设置大屏幕显示器时，操作站背面距大屏幕的水平净距离 4m。这些间距要求都是规范里的数据。另外，控制室面积需要根据控制室内操作台的数量及布置形式确定控制室的面积, 并留有 20% 的未来扩建面积。

华雷：工程师室。因为没有大屏幕，它的计算逻辑就会考虑到这一点。工程师站只考虑直形排布，同时房间没有大屏幕。

华雷：UPS 间。根据我们现有规范，像江苏的项目，UPS、SIS、DCS 要分开，每套系统需要冗余 SIS。UPS 间，4 套及以下的，根据项目总结，给出了尺寸 5500x5800。如果所有系统，使用冗余的 2 套及以下 UPS，那么尺寸为 3900x5800。这些尺寸其实已经考虑比较大的容量了，可以直接定死。

华雷：空调机房。空调机房需要跟暖通专业确定。1）长和宽是有最小尺寸限制的，不能小于 6000。2）同时与建筑面积相关。建筑面积，就是我这边一开始，总图条件里的外轮廓尺寸。比如说，总图上给控制室的面积是 30mx15m，那我就按这个面积来算。根据建筑面积会给出空调机房最小的面积要求。同时要满足前面长宽的最小限制。

华雷：补风机房和排风机房，也是根据逻辑给出的。同时双层建筑和单层建筑，我后面是有逻辑判断出来的。单层、双层不同层数的建筑，房间的尺寸是有不同的最小尺寸要求的。

华雷：气体灭火间。当机柜间/操作间/UPS室/配电间内任何一个房间的面积≥500m，就需要布置一个机柜。这里的机柜就跟前面机柜间尺寸逻辑一样考虑，根据机柜数量可以得出一个合理的房间尺寸。

华雷：抗暴隔离前室。当爆炸冲击波峰入射超压 >21kPa，人员通道配置抗爆隔离前室。作为方案阶段可能没有这个报告，那么先全部统一配置，只需要隔离前室面积≥6m2。

华雷：总图的前置条件前面已经说过，主要是确定电缆池入口和人员入口。

华雷：各个房间的最小面积计算出来后，我需要把这些面积拼接起来，然后再跟总图外轮廓面积的 85% 做比较。因为考虑到走廊、通道的面积，所以留了 15% 的余量。如果小于 85%，可以考虑控制室为单层，开始走单层的逻辑。如果大于 85%，那么就需要双层，走双层的逻辑。

华雷：先说单层控制室逻辑。

华雷：1、根据总图中规划的中控室的外形尺寸，作为中控室外形尺寸。

华雷：2、前面已经定了电缆入口池和人员出入口，考虑到左右对称的问题，可以给出下面 6 种方案，不考虑上下对称。

华雷：3、我是要在电缆进口侧布置机柜间。UPS 和配电间要靠近机柜间。机柜间布置区不仅仅只有机柜间的，其他房间也有的。同时在距离它的远侧（对侧）来设置空调机房布置区，使空调机房原理机柜间，尽量远离噪音、振动敏感区。中间作为核心区，主要考虑控制室，工程师站间，这种人员进出频繁的场所。核心区布置以后，再结合核心区位置和人员进出口位置，来考虑各个走廊通道方案。根据不同的走廊通道方案，再把大区域划分为小区域，用走廊进行划分。每个走廊是以 3000 距离来划分的。

华雷：4、对于北侧的机柜间布置区域，我是考虑到规范的要求以及电缆进出方便，我是要求 UPS 间和机柜间必须相邻的。如果有条件的话，UPS 间和配电间最好也相邻，这个需要根据面积来定的。所以我给了 2 个方案，如果面积满足的话，将 UPS 间和配电间都贴邻机柜间。如果面积不满足的话，优先确保 UPS 间与机柜间贴邻。

华雷：5、贴邻以后，在机柜间边附近中控室外墙，增加排风机房。

华雷：6、如果是两层设置。操作室位于中控室中心，挑空，四周一圈设置二层，空调机房设置在二楼的一边，不在机柜间的正上方。同时增加去二楼的楼梯间，数量要求两个，尺寸为 6800x3000。

华雷：7、休息室、就餐间等辅助房间设置在人员进出口附近，以方便员工休息和生活。

华雷：8、因为我们现在的方案，走廊都定死了。接着把电信间贴邻在机柜间的一层，消控室也贴邻在控制室的另一层（走廊另一层）。这些重要房间贴好后，然后依次布置更衣间、休息间、值班室，每一个都有位置的要求。比如卫生间在中控楼的一角。比如如果二楼有空调机房，卫生间在空调机房的正下方。空调机房贴临位置加入补风机房。

华雷：9、最后还有位置的话，放气体灭火间，就餐间和值班室。

华雷：10、房间排布后的空隙按房间的优先级别来调整，低优先级的房间面积保证后，增加高优先级的房间长/宽，利用剩余面积。优先级由低到高：1）辅助功能房间（办公室、会议室、更衣间等）。2）生产调度室、工程师站间。3）配电间/UPS 间。4）空调机房。5）机柜间。

华雷：11、最后增加房间门。1）人员入口设置对外门。2）与机柜间相邻的房间设置内通的门。3）房间设置走廊侧的门（空调机房除外）。4）空调机房设置对外门。5）消控室设置对外门。

华雷：12、最后再考虑柱网。

华雷：这个模块只适用于做方案布置用，里面的各个专业的图纸是下个模块的事情。

华雷：总结下我的逻辑。1）先根据输入清单，明确各个房间的功能需求、点数要求、数量等输入数据。房间包括必选房间、根据项目条件判断设置的房间以及由业主选择设置的房间三大类。2）根据这些需求计算出各个房间的最小面积。长宽可以调整，但最小面积要满足要求，方便后面的自动排布。3）根据总图条件确定电缆入口池和人员进出口的位置。4）根据电缆入口池和人员进出口划分不同的走廊分割方案。5）根据计算的房间总面积与总图条件的总面积比较，确定一层还是二层设置。6）根据房间的优先级顺序，把这些房间填充进前面根据走廊划分的大块区域里。7）最后在相关位置开门。

吴晓：现在的问题是，大龙你怎么根据华雷提供的逻辑去拼房间。

孔敏：华雷这边的拼接如果实现了，那么动力车间那边得自然也实现了。华雷这边的更难，他的房间更新、更多，比动力车间那边复杂。

吴晓：从华雷的需要来看，会排出不止一个方案。但满足条件的不会太多，因为限制还是比较多的。而且已经先把走廊划好了，这样就剔除很多种可能了。但要考虑多个方案时你怎么选。

华雷：是的，我的约束很多的。比如，有些房间只能在人员入口，就是走廊旁边，这样就那么几个房间了。

吴晓：柱网是最后再定是吧，是机器定还是人定。

华雷：人定。因为除了中控室中间不能有柱子，其他房间里都可以有柱子。其实柱网，很多时候都在房间里面走，影响不大。如果机柜间有柱子的话，那么就避开柱子。

华雷：拼接房间的难点，是我只要求房间的最小面积，所以房间面积是不定的，有很多种，只要比最小的大就行，那么拼接的组合就多很多。我之前自己的思路是：利用优先级，优先级低的就按最小的房间面积，那些组合后多余出来的面积都给那些优先级高的房间，拉大那些房间。

孔敏：如果满足条件的方案出来很多种，你要考虑如何筛选，保留最核心的几个推荐给业主。

华雷：我们可以根据第一次反馈的意见，做一个筛选逻辑，把明显很不合理的剔除掉，相当于迭代。

大龙：我感觉这个拼装的实现后，应该会成为一个通用的逻辑技术，其他模块里涉及到平面相关的，可能也会用到。

思维导图里的逻辑：

1、根据总图中规划的中控室的外形尺寸，作为中控室外形尺寸。

2、根据房间需求表中确定的进线位置和人员入口位置，来确定入口位置，进线口和人员通道在不同侧，不同的人员通道在不同侧，并考虑到对称的问题，方案数为 6 种。

3、单层：根据不同的进线和人员入口位置，给出不同的走廊和核心区/普通区的分区方案。走廊按 2.5m 间距。核心区的房间为人员经常操作房间，例如，操作间、工程师站间，位于中控室的核心区域，以便于实时监控和操作。在电缆进线侧，布置机柜间布置区。在对侧作为空调机房布置区，使得空调机房尽量远离噪音、振动敏感区。

3、双层：操作室位于中控室中心，挑空，四周设置二层，空调机房设置在二楼的一边，不在机柜间的正上方。

4、在电缆进线侧，布置机柜间，UPS 和配电间也应靠近电缆进线位置，以减少电缆长度，提高系统稳定性。1）UPS 间和机柜间相邻（必须）。2）UPS 间和机柜间、配电间相邻。

5、在机柜间边附近中控室外墙，增加排风机房。

6、如果有二楼，增加去二楼的楼梯间，数量要求两个，尺寸为 6800x3000。

7、休息室、就餐间等辅助房间设置在人员进出口附近，以方便员工休息和生活。

8、操作室的布置，在核心区内布置的操作室在贴近走廊侧居中布置，满足参观需求，剩余的区域布置工程师室，如果剩余的区域面积不足以布置房间，那操作室就贴临边布置。

9、电信间贴临在机柜间一侧，布置在机柜间布置区，满足进线需求。

10、消控室贴控制室的一边布置，在走廊的一侧。

11、办公室和会议室：设置在中控室的一侧或者二楼，以减少生产区域的干扰。同时，方便工作人员进入。

12、更衣室：更衣室通常设置在中控室的人员入口边。

13、休息室、卫生间和饮用热水房：设置在人员进出口附近，以方便员工在休息时间使用。卫生间和饮用热水房贴临。1）如果二楼有空调机房，卫生间在空调机房的正下方。2）卫生间在中控楼的一角。

14、值班室：靠近操作间。

15、交接班室和生产调度室：靠近中控室的核心区域，生产调度室与操作间相邻或者。

16、空调机房贴临位置加入补风机房。

17、剩余的位置加入，气体灭火间，就餐间和值班室。

18、房间排布后的空隙按房间的优先级别来调整，低优先级的房间面积保证后，增加高优先级的房间长/宽，利用剩余面积。优先级由低到高：1）辅助功能房间（办公室、会议室、更衣间等）。2）生产调度室、工程师站间。3）配电间/UPS 间。4）空调机房。5）机柜间。

19、最后增加房间门。1）人员入口设置对外门。2）与机柜间相邻的房间设置内通的门。3）房间设置走廊侧的门（空调机房除外）。4）空调机房设置对外门。5）消控室设置对外门。

## 20230821与华雷交流安装图改材料逻辑

###  语音整理

李云祥：对于美标，目前仍处于不确定的状态。

大龙：如果你看美标的等级库里，其材料等级表是肯定就是美标的了。你可以搜一个对照一下，因为现在接口并不具备，你需要找一个项目是美标的。我会跟华为沟通，询问一个项目目标，并用接口查看美标的数据是什么样子的。

李云祥：另外，只要名称里面包含对焊、成钢焊或无缝钢管的描述，那么就需要进行修改，但是如果是描述接头的，还需要另外考虑。

大龙：华雷，我们现在遇到一个问题。用公司的材料等级表数据，匹配出来的等级号下面，垫片有 2 个规定，不知道取哪个。

华雷：

工艺的材料等级表有问题。现在就是这种情况，一个公司他们并没有使用一个统一的等级库，不同的项目可能都会使用同一个等级号，但同一个等级号对应的垫片是固定的。所以每个等级只有一种垫片。

以前他们一直想建一个统一的库。号子一直顺延往后，比如到 2J20 都没问题。

大龙：去年林俊就尝试过建一个，但是没有成功。

华雷：

你知道为什么项目进展不下去吗？大家都直接拷旧的模板，稍微修改下就行了，这样方便。

一个等级好下面，不能有多个垫片的。

如果温度不同，会影响到这个垫片，例如一个项目的温度非常高，就不能使用这个垫片，他应该区分等级号。

垫片类型与安装目的息息相关，因为每种垫片类型可能要求特定的安装方法。所有垫片类型都有标准的安装方法。

常用的基本上是 3 大类：非金属平垫片、聚四氟乙烯包覆垫片和缠绕垫，绿皮书（HG/T 20592-20635）里有的。而且可以按规范规范来匹配。

实际上，你不需要在细节上纠结。每种垫片类型均根据不同的标准编号对应。比如，606 型号表示非金属垫片，而 607 型号表示四氟包覆垫，去材料等级表里找。只需要根据其标准找对应的类型就好。

1『华雷后来补了一个垫片规格的逻辑说明。（2023-08-21）』

李云祥：在模板修改时，我们考虑对焊，还有那种强插焊。

华雷：不要改动，那是针对材质的修改，里面的说明都无需修改，那主要是改材质的问题。我原来是直接改材质。对，还有一种，如果压力较高，那时候就需要改无缝钢管的规格，对，我们需要分两档来处理。

李云祥：对材质的这一块修改，我是不是可以这样去判断，如果里面带有对焊成承插焊，或者是无缝钢管，这三个条件存在就可以直接进行材质的修改。

华雷：你应该是这样理解，这个东西其实是匹配设备和管道的材质。

李云祥：设备或管道的材料，对，就把他的设备和管道的材质写到对应的类别里面，因为我要对这个名称进行筛选，这个名称是否含有对焊、承插焊或者无缝钢管，这些都需要修改。刚才我还看到了管接头，这种管接头需要改吗？

华雷：

他们都需要修改，包括空单我都进行了修改。无缝钢管如果需要修改成不锈钢，那就需要修改为不锈钢的标准号。其他他的东西不能叫标准号，除了无缝钢管以外，其他那些都是叫型号。

他们这个号是固定死的，不受它的材质影响。无缝钢管它有标准号，碳钢或不锈钢的他需要标准化时会进行变动，同时如果压力等级较高，它无缝钢管的规格也需要进行变动。

其实很好理解。除了属于紧固件的那三部分，其他的材质应该都跟着设备或管道的要求来。这里面的材质肯定都是确定的，不需要我们再改动。

一些特殊情况需要单独处理，比如说有十字连接处。如果一个地方改错了，整个图都会出现错误。（思维导图的逻辑里有）

已经单独标注出需要修改的部分，这就给你省了很多事情。那些阀门和管件的材质，也就是说管路和阀门。钢管的部分，比如无缝钢管号，需要改为无缝钢管的标准号。

还有一个最麻烦的就是压力等级。如果压力等级高到一定程度，不仅需要改规格，还需要改压力等级。比如以 63 兆帕为分界，超过的话就得改。可能这个信息在一些地方有标出，有的地方却没标出。比如这里就写了 PN63，那么只要大于 PN63 的都要改为 PN160。你需要把所有标有 PN63 的地方，都改为 PN160。

你必须清楚你的思路，不要混淆。我担心你到最后可能会弄错等级。比如你知道管子的等级，但是写出来的却是阀门的。

该如何确定每个部分的等级呢？你需要根据材料等级表来确定。表上可能会标明有 40 有 25。

1『

思维导图里的几个内容：

1、法兰根部阀、紧固件选择：根据管道等级表来选择安装图中的法兰根部阀、垫片、螺栓，如果是安装在设备上接口 的，需要参考与设备相连的最高等级的管道来设置。同时，根据仪表工况的工作温度来判断选择高温型还是普通型的法 兰根部阀。

2、管路阀门、管件和钢管材质定义：承插焊、对焊的阀门、 管件和无缝钢管的材质应等同于仪表所在管道/设备的材质。

3、无缝钢管标准号选择：如果无缝钢管的材质是不锈钢，标西瓜 准号为 GB/T14976；如果是碳钢，标准号为 GB/T8163。

4、压力等级设置判断：如果仪表所在管道/设备压力等级 <PN63, 模板中的压力等级原默认为 (PN63)。如果对应的压力等级大于 PN63，且 < PN160, 则对应的安装图模板中标注 PN63 的材料，都统一标为 PN160。

5、设备规格匹配：安装图模板中的根部阀和垫片的尺寸需要和仪表规格接口一致匹配，螺栓和螺母的规格和数量需要和垫片规格匹配。

』

大龙：最后确认一下，现在我给你发送这 4 个字段，包含规范号、垫片名称（只为方便我查看）、管径和压力等级。

华雷：

说个例子。比如，垫片类型，d 是代表垫片类型，ABCD 垫片类型，但是在你提供的材料中我没有看到你提及垫片类型。xxxx 代表它的外层填充内层，还有内版的 4 种材质，这部分信息也没有。

不完全是。这种材料件的话分 ABCD 四种垫片，分别对应的是凹凸面法兰或者凸面法兰，然后正法兰还它分别有内环、外环材质、填充材质，还有一个外表壳的材质，所以它要综合考虑材质。后面 2525 就对应的 4 种材质的代码，它就 4 种材料组合起来的。

李云祥：我有个疑问，NPT 是从哪个地方获取的？

华雷：

NPT 其实代表的是一种过程连接，螺纹连接，并不涉及尺寸。我现在理解的逻辑是这样的，如果是法兰的话，我需要填入的是 HGT，如果是螺纹的，我需要填入的是 M27。

在数据表上，连接的标准和连接尺寸是分开的，而我之前将它们混淆了。其中套管过程连接和仪表过程连接也是分开的，一部分是仪表过程连接，另一部分是套管过程连接，我之前可能混淆了这两个概念。

关于连接，本应有两部分，但我之前可能写错了。对于仪表的连接，只有一个仪表过程连接。如果有标准号，这个标准号也应该被写在里面，比如法兰的话，会先写 HGTxx。我的表述没有问题，将标准化过程都统一写在一行里就行。而对于套管，它需要分为两部分，我之前可能将两者写在一起了。

关于法兰的问题，因为口径和压力等级的不同，不能通过一个简单的标记就判断出它，我只能通过标准化来判断。比如，如果是 ISO 的话，那就意味着是焊接，如果是 HG，那就是法兰连接。可以通过查阅两个字段来判断，一个是连接尺寸，另一个是连接标准。

1『

对于温度计，总结下：1）对于连接的方式，要么是法兰（HG/T）要么是螺纹（M27x2）要么是焊接（ISO）。2）对于不带套管的仪表，其连接方式和连接标准号（有的话），是写在一个字段：仪表过程连接（Process_material）。比如：HG/T 20592'\n'40-16 RF。

娄妙树补充（2023-10-20）：

华雷提供的安装图匹配模板条件里，套管形式是直管式和锥管式，其实都是一种形式的「整体钻孔式保护管」。仪表选型模块生成的一个双金属温度计，套管配的是整体钻孔式保护管，就是因为华雷安装图匹配模板条件里没有整体钻孔式保护管，导致匹配不出来模板，其实可以匹配出来，只是没跟我说清楚这几个概念间的关系。

温度计数据表里，上面的一整块是仪表的数据，包括仪表连接规格，具体其实是仪表和套管间的连接形式和规格。下面一整块是套管的数据，包括套管连接规格，具体其实是套管和设备间的连接形式和规格。

如果设备带套管，设计人员目前数据表里的常规写法是，套管结构形式那边填「N/A」，套管数据那边有个过程连接的形式、标注、规格都是空的。我们仪表选型模块目前的逻辑是，如果设备带套管，套管结构形式那边填「设备带套管」。

』

接下来我们讨论一下套管的问题。

套管的信息是从数据表获取的。数据表上如果某个设备有套管，那么在套管结构形式（well_style）会写明「设备带套管」。你可以看一下，仪表过程连接如果注明是 NPT 的话，那么套管一定不会写。

设备有两种情况，一种是设备带套管，根据你给的信息，设备带套管，套管的过程连接空着（N/A），仪表的过程连接一定是 M27×2 的卡套螺纹。还有一种是仪表本来就不需要带套管，它就是过程连接那边的 NPT 接口或者螺纹（M27×2）或者焊接（ISO）。

另外一个特别要注意的点：模板匹配的条件，每一个模板只拿我列的对应的条件列。比如温度变送器里，直管法兰套管固定的一体化温度变送器安装图，条件列是套管结构形式和套管过程连接这 2 个，而法兰固定&设备带套管的一体化温度变送器安装图，条件列是套管结构形式和仪表过程连接这 2 个，每个模板要匹配的条件列不一样的，只关注自己的即可。

1『之前李云祥整理的时候有误，他一个类型的仪表，按同样的条件列（取各模板条件列的并集）去处理的。好在余高枫做的时候自己按正确逻辑实现的，他模板表里空的条件列没有实例化那个字段，碰巧做对了。（2023-08-21）』

1『

2023-10-20

来自你的消息：

你是一位在勘察设计行业从事多年的仪表工程师专家。我想让你充当指导老师，指导我学习工程设计中仪表设计的相关工作。我的第一个问题是

来自 ChatGPT 的消息：

很高兴你选择我作为你的指导老师。请问你的第一个问题是什么？

来自你的消息：

双金属温度计中，{整体钻孔式保护管} 是什么意思，请结合具体案例讲解

来自 ChatGPT 的消息：

双金属温度计是一种常见的温度测量仪器，它的工作原理是利用两种不同金属或合金焊接在一起，因为温度变化会产生热膨胀，但两种不同的金属或合金的膨胀系数不同，所以会产生弯曲。这种弯曲可以通过机械装置转化为温度读数。

而你提到的「整体钻孔式保护管」，这是一种专门用于保护双金属温度计的装置。这个保护管通常是由坚硬的材料制成，如不锈钢或其他耐腐蚀的金属，以防止环境中的物质对温度计造成损害。「整体钻孔式」是指这个保护管是由一整块材料钻孔加工而成的，而不是由多个部分组合而成。这样可以确保保护管的强度和密封性。

举个具体的例子，假设你在一个化工厂工作，你需要测量一个反应器内的温度。这个反应器内可能有腐蚀性的化学物质，如果直接将双金属温度计插入，可能会损坏温度计。这时，你就可以使用一个整体钻孔式保护管，将双金属温度计放入保护管内，然后将保护管插入反应器。这样，温度计就可以安全地测量反应器内的温度，而不会被反应器内的化学物质损坏。

来自你的消息：

整体钻孔式保护管，与设备相连的话，有哪些连接形式或者说连接方式

来自 ChatGPT 的消息：

整体钻孔式保护管与设备相连主要有以下几种方式：

1. 螺纹连接：这是一种常见的连接方式，通过螺纹将保护管直接连接到设备上。这种方式适用于压力不高，且需要经常拆卸或者更换的场合。

2. 法兰连接：法兰连接是一种常用的固定连接方式，通过法兰和螺栓将保护管与设备连接起来。这种连接方式适用于压力较高的场合。

3. 焊接连接：对于需要长时间使用，且不需要更换的情况，可以选择将保护管直接焊接到设备上。这种方式的连接强度高，密封性好，但是不方便拆卸。

4. 快速接头连接：这种连接方式方便快捷，适用于需要频繁更换保护管的场合。

在选择具体的连接方式时，需要考虑设备的工作条件（如压力、温度等）、保护管的材质、以及是否需要经常更换保护管等因素。

来自你的消息：

请详细解释仪表的过程连接是 NPT 的情况。

来自 ChatGPT 的消息：

NPT（National Pipe Thread，全称美国国家标准管螺纹）是一种常见的螺纹接口标准，主要用于管道的连接。在仪表工程中，NPT 螺纹常用于连接各种流体处理设备，如泵、阀门、压力表、温度计等。

NPT 螺纹有两种类型：NPT（F）和 NPT（M），分别代表内螺纹（Female）和外螺纹（Male）。NPT 螺纹是 60° 锥螺纹，螺纹的牙顶和牙根都是有棱角的。

在进行过程连接时，如果仪表的过程连接是 NPT 的，那么该仪表的连接口会有特定的 NPT 螺纹。例如，如果你有一个双金属温度计，其整体钻孔式保护管的接口是 NPT 螺纹，那么你就需要一个配套的 NPT 螺纹接口（如果保护管是内螺纹，那么设备接口就需要是外螺纹，反之亦然）来将温度计连接到设备上。

此外，NPT 螺纹连接需要使用密封材料（如聚四氟乙烯（PTFE）带）来确保连接处的密封性，防止流体泄漏。

总的来说，如果仪表的过程连接是 NPT 的，那么在安装时就需要找到匹配的 NPT 螺纹接口，并使用适当的密封材料来确保连接的密封性。

来自你的消息：

请详细给我讲解下仪表过程连接的知识，并结合工程设计中的实际案例。越详细越好，请一步步来讲解

来自 ChatGPT 的消息：

在工程设计中，仪表过程连接是一个重要的环节，它涉及到仪表与过程管道或设备之间的连接方式，直接影响到仪表的工作性能和使用寿命。

一、过程连接的基本知识

1. 连接方式：过程连接的方式主要有螺纹连接、法兰连接、焊接连接和快速接头连接。选择哪种连接方式，主要取决于设备的工作条件、仪表的特性以及安装和维护的需求。

2. 连接标准：过程连接的标准通常由国家或行业规定，例如 NPT（美国国家标准管螺纹）、BSPT（英国标准管螺纹）、DIN（德国工业标准）、JIS（日本工业标准）等。

3. 密封性：过程连接需要保证良好的密封性，防止流体泄漏。通常会使用密封材料（如聚四氟乙烯（PTFE）带）或密封垫片（如金属垫片、非金属垫片）来增强密封性。

二、过程连接的工程设计实例

假设我们在设计一个化工生产线，需要安装一台压力表来监测某一段管道的压力。这台压力表的过程连接需要满足以下几个条件：

1. 连接方式：由于这段管道的压力较高，且不需要频繁更换压力表，因此我们选择法兰连接。

2. 连接标准：由于这个化工生产线采用的是 DIN 标准的管道，因此我们选择 DIN 标准的法兰。

3. 密封性：在法兰连接处，我们使用金属垫片来增强密封性，防止压力表工作时的流体泄漏。

在实际的工程设计中，过程连接的设计需要综合考虑各种因素，包括但不限于设备的工作条件、仪表的特性、安装和维护的需求、成本、安全性等。同时，也需要遵循相关的设计规范和标准，以确保过程连接的安全和可靠。

来自你的消息：

温度计的套管，直管式套管和锥管式套管有何区别，它们各有何优点和缺点。请结合工程设计中的实际案例讲解，越详细越好，请一步步来讲解

来自 ChatGPT 的消息：

温度计的套管，也称为热电阻套管或热电偶保护管，是用于保护温度传感器（如热电阻、热电偶）的一种设备。根据形状，它们主要分为直管式套管和锥管式套管。

1. 直管式套管：如其名，直管式套管的内外直径在整个长度上都是一致的。这种设计简单，制造容易，成本较低。直管式套管在大部分应用中都能满足需求，尤其是在对响应速度要求不是非常高的场合。

2. 锥管式套管：锥管式套管的直径在长度上是逐渐变小的，形状类似于锥形。这种设计可以提高套管对温度变化的响应速度，因为热量可以更快地传递到套管的尖端。但是，锥管式套管的制造难度和成本都比直管式套管要高。

下面我们来看一个工程设计的实际案例。

假设我们正在设计一个化工反应器的温度控制系统。反应器内的化学反应非常剧烈，温度变化非常快，因此对温度控制的响应速度要求非常高。在这种情况下，我们可能会选择锥管式套管。

首先，我们需要选择一个合适的热电阻或热电偶作为温度传感器。然后，我们选择一个与反应器内部环境（例如腐蚀性、温度、压力等）相匹配的锥管式套管来保护传感器。锥管式套管的尖端部分会被插入到反应器内部，而宽端部分则连接到温度计。

这样，当反应器内部的温度发生变化时，这种变化可以快速地传递到套管的尖端，然后通过套管传递到温度传感器。因此，我们可以实时监测到反应器内部的温度变化，并快速调整温度控制系统，以保证化学反应的正常进行。

总的来说，直管式套管和锥管式套管各有优缺点。在选择时，需要根据具体的应用需求和环境条件来决定。

』

## 20131219仪表数据表测试BUG汇总

### 20221130仪表数据表测试 BUG 汇总

华雷

01. 压力表

1.1 压力表量程获取逻辑修改（已放入第二次迭代的需求文档）【已修改】

1.1.1 最大压力大于等于 0.1 的量程获取

如果压力全部为正值的情况：

步骤一：获取用于匹配量程的「量程压力」。量程压力的获取逻辑仅与「设计压力」和「操作压力」有关。

下面的逻辑命中一个即可跳出。

1、如果设计压力有值，直接取设计压力，乘以 1.1 倍，即为量程压力。

2、如果设计压力为空，且操作压力是单个值（不是一个范围），比如 0.35MPa，那么取操作压力，乘以 1.5 倍获得量程压力。

3、如果设计压力为空，且操作压力是一个范围，比如 0.2~0.4MPa，那么通过取操作压力范围拿到最大的压力 0.4，然后乘以 1.1 倍获得量程压力。

步骤二：根据量程压力匹配量程。

匹配逻辑与老逻辑相同。最终要匹配的量程区间汇总： UPPER_LIMIT_PRESSURE_01 (0.1, "0~0.1M"), UPPER_LIMIT_PRESSURE_016 (0.16, "0~0.16M"), UPPER_LIMIT_PRESSURE_025 (0.25, "0~0.25M"), UPPER_LIMIT_PRESSURE_04 (0.4, "0~0.4M"), UPPER_LIMIT_PRESSURE_06 (0.6, "0~0.6M"), UPPER_LIMIT_PRESSURE_1 (1, "0~1M"), UPPER_LIMIT_PRESSURE_16 (1.6, "0~1.6M"), UPPER_LIMIT_PRESSURE_25 (2.5, "0~2.5M"), UPPER_LIMIT_PRESSURE_4 (4, "0~4M"), UPPER_LIMIT_PRESSURE_6 (6, "0~6M"), UPPER_LIMIT_PRESSURE_10 (10, "0~10M"), UPPER_LIMIT_PRESSURE_160 (16, "0~16M"), UPPER_LIMIT_PRESSURE_250 (25, "0~25M"), UPPER_LIMIT_PRESSURE_40 (40, "0~40M"), UPPER_LIMIT_PRESSURE_60 (60, "0~60M");

如果压力有负值的情况：

如果压力值全部是负压，那么量程直接匹配出：-0.1~0。

如果压力的最大值是正值，那么走下面的逻辑。

步骤一：获取用于匹配量程的「量程压力」。

1、如果设计压力有值且为正值，直接取设计压力，乘以 1.1 倍，即为量程压力。

2、如果设计压力为空，且操作压力是一个范围，比如 - 0.098~0.4MPa，那么通过取操作压力范围拿到最大的压力 0.4，然后乘以 1.1 倍获得量程压力。

步骤二：根据量程压力匹配量程。

最终要匹配的量程区间汇总：

"-0.1~0.06M"

"-0.1~0.15M"

"-0.1~0.3M"

"-0.1~0.5M"

"-0.1~0.9M"

"-0.1~1.5M"

"-0.1~2.4M"

1.1.2 最大压力小于 0.1 的量程获取

如果压力全部为正值的情况：

步骤一：获取用于匹配量程的「量程压力」。逻辑完全参考压力大于 0.1 的场景。

步骤二：根据量程压力匹配量程。

现在的量程压力的单位是 MPa，需要先转为 kPa，然后再去匹配量程区间。

最终要匹配的量程区间汇总：

"0~1.6kPa"

"0~2.5kPa"

"0~4kPa"

"0~6kPa"

"0~10kPa"

"0~16kPa"

"0~25kPa"

"0~40kPa"

如果压力全部为负值的情况：

步骤一：获取用于匹配量程的「量程压力」。

1、如果设计压力有值且为负值，直接取设计压力，乘以 1.1 倍，即为量程压力。

2、如果设计压力为空，且操作压力是单个值且为负值（不是一个范围），比如 - 0.05MPa，那么取操作压力，乘以 1.5 倍获得量程压力。

3、如果设计压力为空，且操作压力是一个范围且最大最小都为负值，比如 - 0.098~-0.05MPa，那么通过取操作压力范围拿到最左侧最大的负值，如举例中的 - 0.098，然后乘以 1.1 倍获得量程压力。

步骤二：根据量程压力匹配量程。

现在的量程压力的单位是 MPa，需要先转为 kPa，然后再去匹配量程区间。

最终要匹配的量程区间汇总：

"-1.6~0kPa"

"-2.5~0kPa"

"-4~0kPa"

"-6~0kPa"

"-10~0kPa"

"-16~0kPa"

"-25~0kPa"

"-40~0kPa"

"-100~0kPa" 转成 "-0.1~0Mpa"@常恃豪【已修复】

如果压力既有正值又有负值的情况：

步骤一：获取用于匹配量程的「量程压力」。此时要分别拿到正值的量程压力和负值的量程压力，分别取匹配量程范围的最小值和最大值。

符合这种情况的时候，操作压力肯定是一个范围值，最小值是负值，最大值是正值。

比如 - 0.098~0.2MPa，取最小值（负值）乘以 1.1 获取负值的量程压力；取最大值（正值）乘以 1.1 获取正值的量程压力。

步骤二：根据负值量程压力和正值量程压力匹配量程。

现在的量程压力的单位是 MPa，需要先转为 kPa，然后再去匹配量程区间。

负值量程压力和正值量程压力，取绝对值大的取匹配量程。

最终要匹配的量程区间汇总：

"-0.8~0.8kPa"

"-1.2~1.2kPa"

"-2~2kPa"

"-3~3kPa"

"-5~5kPa"

"-8~8kPa"

"-12~12kPa"

"-20~20kPa"

1.3 选型为差压变送器，膜盒出现对应了法兰连接的情况，方式和规格都应该为内螺纹 / 1/2「NPT（F），所有的差压变送器，都缺少低压侧连接：单侧取压，应该是「接大气」，双侧取压，应该是「同高压侧」【待转化】@冯大龙

1.4 选型为差压变送器，管道钢衬，匹配为隔膜差压，测量形式膜盒错误应该为隔膜 ，且测量材质错误，和管道材质不匹配，且隔膜差压，精度应该是 0.2, 同时隔膜差压需要有填充液参数【待转化】@冯大龙

1.5 仪表量程不满足要求，正常值 1.5 倍，再上选获取量程，比如第一个应该是 0~10kPa，第二个 0~0.6M【已修复】

点击图片可查看完整电子表格

压力表的量程问题，除了量程上限偏低，还有量程缺少情况

微压的量程，出现问题比较多，很多匹配不了条件

1.6 压力变送器：选型为隔膜压力变送器，压力变送器法兰应该都是 S31603, 存在大部分缺密封液的情况，默认是硅油，发烟硫酸应该是氟碳润滑剂【待转化】

压力表选型为隔膜压力表的，除了法兰以外，问题同压力变送器

1.7 选型为压力变送器，匹配为普通类型出现对应了法兰连接的情况，方式和规格都应该为内螺纹 / 1/2「NPT（F）【待转化】

1.8 选型为压力变送器，低一些衬设备未能识别，应该选型为隔膜压力变送器，备注为设备自带的，不应该出数据表，测量元件，不是为隔膜就是膜盒，不能空白【待转化】

1.9 条件中特材没有识别

哈氏合金没有识别，没有按膜片压力表选型

条件中钛不识别

1.10 选型为压力变送器，未能识别条件中一些含固体颗粒情况，如固体产品粉碎，需要隔膜压力变送器【待转化】

1.11 选型为膜盒 / 膜片压力表的测量元件形式需要改为膜盒同时精度应该为 2.5 隔膜法兰只有直接连接，没有角型连接

1.12 泵入口的压力都需要考虑负压量程从 - 0.1 起，应该为 - 0.1~0.9M【已修复，同属于压力量程范围 bug】

1.13 压力表选型 DN15 的管子未能选择 M14X1.5 60 表盘 2.5 精度【已修改】

1.14 消防泵试验压力未按逻辑选型

选型逻辑

大龙：

1.13 和 1.14 的问题，第一次需求逻辑里都有。（2023-01-16）@常恃豪

1.15 爆破片出口压力未加备注【已修改】

选型逻辑

大龙：

已补充到二次需求迭代文档里。（2023-01-16）

02. 温度计

2.1 条件材质为非金属的特材，不能识别，套管材质不匹配【待转化】

2.2 管道小于 DN100 备注需要加上「管道扩径至 DN100」【已修改】

2.3 插入深度等未定项，需要写 hold, 用来以后核对，同时套管的插入深度应该是 U=【已修改】

2.4 温度变送器的测量范围全部缺失【已修改】

2.5 统一规定中的法兰接口 DN40 ，数据表没有反映【已修改】

2.6 温度高于 500 的未能选型热电偶

2.7 热电阻数据表，测量元件数量缺失默认为 1 结构形式缺失默认铠装

2.8 双金属温度计，直径缺少，与套管对接的过程连接错误，分别为 8 / 活动外 M20X1.5 (M), 同时缺少量程范围

03. 液位计

3.1 差压变送器逻辑修正【已修改】

原逻辑：

修正为：

3.2 磁性液位计的过程连接尺寸修正逻辑修改【已修改】【已回测确认】

原逻辑：

修正为：

3.3 液位计位号问题【已修复】

液位开关位号要改为 LS-

大龙（2023-01-15）：

原逻辑是集中液位计位号设为 LT - 开头，现逻辑：集中液位计里，类型为液位开关的，其位号设为 LS - 开头的。

3.4 液位开关缺失原理，根据选型逻辑确定

选型逻辑：

大龙：

先默认音叉液位开关，型式修改的逻辑验收后修改。（2023-01-15）

3.5 液位开关的过程连接丢失，同时钢衬的探头，法兰也需要钢衬四氟

大龙：

验收后修改。（2023-01-15）

3.6 磁性液位计和液位开关的密度参数都丢失【已修复】

3.7 磁性液位计的触液材质低于设备材质

大龙：

验收后修改。（2023-01-15）

3.8 磁性液位计都备注，排污阀配盲板【已修复】

3.9 雷达液位计缺少量程范围，根据工艺条件的液位范围确定，同时备注缺少测量原理，默认脉冲型，反应釜，用连续调频波

大龙：

液位计范围已修复，反应釜改为连续调频波验收后修改。（2023-01-15）

04. 开关阀

4.1 阀门作用形式缺失（FC FO FL），开关时间要按口径选择 ，阀门泄漏等级丢失，其他多处参数丢失【已修改】

大龙：

1、阀门事故开关 FO/FC 是因为工艺条件里的数据没填，填了这边就有了。

2、其他缺失的数据已补齐，下图是新导出来的（验收用的发酵模块数据）。

4.2 开关阀的阀门材质没有按逻辑要求选择，包括高温不低于管道材质等要求（验收后修复）

大龙：

逻辑待补充。（2023-01-14）

05. 调节阀

5.1 多处参数丢失，没有开度计算缺工艺条件参数【已修复】

06. 流量计

6.1 质量流量计匹配逻辑修改【已修改】

原逻辑：

逻辑更改为：

6.2 涡街流量计匹配逻辑修改【已修改】

原逻辑：

逻辑更改为：

同理，后面参数修正时用到此逻辑的地方也需要同步修改：

6.3 转子流量计匹配逻辑修改【已修改】

修改逻辑：

6.4 电磁流量计，未体现流量条件，缺电极材质 / 接地环材质和量程，其中接地环材质和电极材质的要求，请根据选型逻辑要求【已修复】

选型逻辑

6.5 电磁流量计判断逻辑错误，逻辑上空气不可能用电磁【已修复】

选型逻辑：

大龙（2023-01-15）：目前将气体和蒸汽的默认流量计设为了旋涡流量计，已补充到二次迭代的需求里。

6.5 DN250 以上的的电磁用逻辑上应该是插入式规格【已修复】

选型逻辑：

大龙（2023-01-15）：此项修改内容已补充到仪表选型的二次迭代需求里了。

07. 其他

7.1 输出信号和电气接口尺寸 2 个字段的数据取统一规定里的数据【已修复】

导出的数据表没有统一规定要求的信号和电气接口。

原需求文档里有相关逻辑的：

7.2 仪表的防爆等级缺少设备保护等级，隔爆要加 Gb 本安要加 Ga

大龙（2023-01-15）：添加后的形式是什么样的，逻辑待补充。验收后再做。

7.3 所有的仪表缺少显示方式，应该是写 LCD【已修改】【已回测确认】

大龙补充（2023-01-15）：基础库里很多远传仪表显示方式没填 LCD 导致的，目前已补充。

7.4 过程连接规格和标准号没有对应，如法兰是 HG/T 20592 1/2「NPT 是 GB/T12716  M20X1.5 是 GB/T 193, 目前错配，或者缺少【已修改】【已回测确认】

大龙（2023-01-15）：M20x1.5 (M) 没有标准号是因为基础库里没填标准号，目前已补充。

7.5 设备上的仪表接口希望能根据设备接口核对表匹配，括号里的插入深度，法兰间距可以匹配到数据表对应的规格里【已增加】【已回测确认】

7.6 数据表中温度压力流量条件抬头有 MAX/NOR/MIN 数据表的条件应该也有 / 区分条件状态

大龙：已补充到二次迭代需求（2023-01-15）。如果工艺人员填的仅仅有 - 0.098-0.3，最小最大值有，但正常值缺信息。待确认。

7.7 数据表的一些行需要设置分行缩径，不然无法全显

大龙补充（2023-01-15）：先把上图中涉及的字段 Excel 表里格式更改为分行的，后续遇到还需要分行的再单独加。字段包括：1）用途。2）编号，即仪表所在位置。3）介质。@常恃豪

冯大龙

01. 压力表

1.1 压力表 / 压力变动器 / 差压变动器测量原件的材质没有填充基础库里的默认值【已修复】【已回测确认】

按逻辑，成品数据表里，应该先匹配基础库（ks_measure_types）里的数据作为默认值。基础库里压力表的测量元件材质都是有值的。

1.2 压力表 / 压力变动器 / 差压变动器测量原件的材质逻辑有误【已修复】

需求里的逻辑如下：

导出的成品结果如下：

1.3 过程连接尺寸的修正没有用需求里的新逻辑【已修复】

成品表导出的结果如下：

这个结果是按老版逻辑走的：

需求里的逻辑：满足条件后，是修改过程连接方式为「工字型法兰」，而不是在备注里体现。需求截图如下：

02. 温度计

2.1 判断设备自带套管的判断逻辑优化（优化项）【已修复】

原逻辑：备注（assembly_comment）包含字符串「设备带套管」。

更改为：备注（assembly_comment）包含字符串「设备带套管」或「设备自带套管」。

2.2 一体化温度变送器的输出信号和电气接口尺寸没有填充基础库里的默认值【已修复】【已回测确认】

按逻辑，成品数据表里，应该先匹配基础库（ks_measure_types）里的数据作为默认值。基础库里温度计这 2 个字段是有值的。

2.3 设备带夹套时参数修正逻辑修改（原需求文档里字段写错）【已修复】

上图中的第 2 点：传感器形式（sensor_style）更改为：卡套 M27x2 (M)。

应该是修改过程连材质（process_material），而非传感器形式（sensor_style）。同时，下面置空的字段里把过程连材质（process_material）剔除，否则又会被覆盖。

03. 液位计

3.1 液位开关没有匹配【已修复】【已回测确认】

需求文档里：

功能代号不包含 I 的集中液位计，型号直接匹配为液位开关的。

3.2 磁性液位计变送器的形式 / 输出信号 / 电气接口未匹配基础表中的数据【已修复】

基础表（ks_measure_types）需要增加液位计字段变送器形式，默认值为「干簧管」。

3.3 雷达液位计的显示方式 / 输出信号 / 电源未匹配基础表中的数据【已修复】

问题同 3.2。

3.4 差压变动器逻辑匹配有误【无需修复】

需求文档里的条件 5，要 2 个条件同时满足才是差压变送器。

输入数据如下：

匹配出来的型号有误，设备高度超了 4500 了，不应该匹配出来差压变送器。

3.5 此致伸缩液位计逻辑匹配有误【已修复】

匹配结果如下：

3.6 液位计的差压变送器参数修正有误【已修复】

需求文档里的修正参数，只是针对液位计的差压变送器修正的，压力表那边的差压变送器无需修正，现在全部修正了。

3.7 成品数据表里温度和压力的单位要剔除的【已修复】

所有类型的仪表数据表里，温度和压力都要剔除单位的。

3.8 雷达液位计压力显示不出常压并且接口尺寸没有修正【已修复】

需求文档：

输入数据：

输出数据：

问题 1：压力「常压」没有到成品表来。

问题 2：连接的规格尺寸没有修正。

04. 开关阀

4.1 阀座阀芯材质 / 阀门填料材质未匹配基础表中的数据【已修复】【已回测确认】

4.2 阀门作用形式没有数据【已修复】【已回测确认】

需求文档：

输入数据：

上图中的阀门失能位置，要填到成品表里的阀门作用形式。

输出数据：

05. 调节阀

5.1 成品表后面数据的格式有问题【已修复】

5.2 增加钢衬四氟的全名：钢衬聚四氟乙烯【已修复】

搜索代码的逻辑，所有使用钢衬四氟的地方，要兼容它的全名：钢衬聚四氟乙烯。

比如：

5.3 阀体材质 / 阀芯阀座材质 / 阀门填料材质未匹配基础表中的数据【已修复】

5.4 根据阀前阀后压差来修正阀芯阀座材质有误【无需修复】

需求文档：

输入数据：

输出数据：

06. 流程计

6.1 转子流量计型号匹配有误【已修复】

原始需求文档：

输入数据：

上面的输入数据无法命中需求里的 5 个条件的。

6.2 质量流量计型号匹配逻辑修改【已修改】

6.3 质量流量计精度没有修正【已修复】

原需求文档：

输出数据：

6.4 涡街流量计导出的 Excel 表无法打开【未提供涡街流量计模板】

6.5 未匹配到差压流量计【无需修复】【已回测确认】

需求文档如下：

输出结果如下：

6.6 未匹配到超声波流量计【已修复】【已回测】

需求文档如下：

输出结果如下：

07. 其他

7.1 导出来的临时仪表数据表文件名后缀多了一个点 @余开毅【已修复】

7.2 无某个类型仪表时，导出数据时无需提示表述修改 @余开毅

如上图所示，我选了 6 个类型的液位计导出来，可能只有 2 个液位计有数据可以导成品表，另外 4 个没数据。这种情况是正常的，只需提示哪几个液位计没数据即可，无需现在显示的「导出失败」。

李云祥

1、导出成品压力表，未能获取到数据。【已修复】@常恃豪

2、成品表位号含有 Z , 确认备注是否填充：SIL 认证。【已修复】

3、仪表部分数据未完善【已修复】

4、确认 TZG-40302 属于哪一类？【已修复】

5、assembly_comment 列填写插入深度但是后面没有跟数字，结果未 I=0，插入深度后加了数值，结果为 I = 插入深度。【已修复】

6、差压变送器的未修正。【已修复】

7、如下图，此条件满足后没有修改为涡街流量计【已修复】

8、如下图，此条件满足后没有修改为容积式流量计【已修复】

9、如下图，此条件满足后没有修改为超声波流量计【已修复】

10、两类条件相同，分类不同【已修复】

11、逻辑 3 逻辑 4 无法按要求修改【已修复】

12、超声波流量计、超声波流量计无法导出【已修复】

13、仪表临时表修改在仪表专业上传后，修改不了数据库的数据。【已修复】

14、工艺临时表中，功能代码为 TG，仪表类别为 location，但导出的仪表临时表为一体化温度变送器【已修复】

15、如下图，将测量控制点名称改为压缩空气管道开关阀后，仪表名称还是开关阀【已修复】

改为压缩空气开关阀，仪表名称可改为电磁阀。

16、阀门失能位置对应开关阀数据表的哪条数据？@冯大龙

17、导出电磁阀报错【已修复】

18、调节阀阀体材质没有填写。【已修复】

19、修改部分参数后，条件阀导出，报错。【已修复】

[20221205092700_Excel 临时仪表数据表.xlsx]

20、容积式、超声波流量计的数据表数据完善。

需要求正的逻辑

20221104 仪表选型模块汇总

## 2023129仪表选型模块汇总

### 需求迭代汇总 - 上传条件数据（2023-05-15）

#### 01. 新增上传条件数据页面 @余开毅 @戴强 @常恃豪

仪表作业线新增卡片：仪表条件上传。卡片的位置在「仪表选型统一规定」之后。

01 仪表上传

显示 2 张表：上面的是仪表条件数据表，下面的是阀门条件数据表。

前置工作：gs_instrument_finished 和 gs_instrumentv_finished 这两个表增加一个专业字段（profession）。

上传工艺仪表条件和工艺阀门条件

点击上传工艺仪表条件按钮后，弹出上传面板：

用户将 Excel 拖进上传框或者点击上传框打开文件上传。

1、上传工艺仪表条件时，后端将数据更新进数据库表 gs_instrument_finished，专业（profession）默认为 gs。

2、上传工艺阀门条件时，后端将数据更新进数据库表 gs_instrumentv_finished，专业（profession）默认为 gs。

备注：每次更新按专业覆盖数据，参考电气专业的用电负荷表模块的上传逻辑。

上传其他专业仪表条件和其他专业阀门条件

点击上传工艺仪表条件按钮后，弹出上传面板（使用场景完全参考电气专业的用电负荷表模块）：

1、上传其他专业仪表条件时。点下载模板后，打开 Excel 模板表，用户将数据填充后，数据库表 gs_instrument_finished，专业（profession）以模板表里用户填的专业为准。

2、上传其他专业阀门条件时。点下载模板后，打开 Excel 模板表，用户将数据填充后，数据库表 gs_instrumentv_finished，专业（profession）以模板表里用户填的专业为准。

备注：每次更新按专业覆盖数据，参考电气专业的用电负荷表模块的上传逻辑。

在 Excel 表打开仪表条件和其他专业阀门条件数据

点击按钮后打开一张临时性 Excel 表供用户查看，用户无法在这里修改数据，仅查看用。

02 其他修改 @常恃豪

1、工艺专业那边导出成品仪表条件时，不入库成品表。否则工艺导一次成品仪表条件就会把仪表这边上传的数据覆盖一次。

2、工艺成品仪表数据和阀门数据表，增加一行隐藏行字段，定位数据的。

需求迭代汇总（2023-01-12）

01. 温度计选型逻辑汇总

01. 双金属温度计和一体化温度变送器的测量范围获取逻辑 @常恃豪【已发测试】@冯大龙【已回测确认】

备注：此逻辑跟压力表的量程获取逻辑很像。

如果温度全部为正值的情况：

步骤一：获取用于匹配量程的「量程温度」。量程温度的获取逻辑仅与「操作温度」有关。

1、如果操作温度是单个值（不是一个范围），比如 25，那么取操作温度除以 0.5 获得量程温度为 50。

2、如果操作温度是一个范围，比如 28~121，那么通过取操作温度范围拿到最大的温度 121，然后除以 0.9 获得量程温度。

步骤二：根据量程温度匹配量程（测量范围）。

量程温度往上靠量程区间，比如量程温度是 140，那么匹配出来的量程区间为：0~150。

最终要匹配的量程区间（测量范围）汇总：

0~50

0~100

0~150

0~200

0~300

0~400

0~500

0~600

0~700

0~800

如果温度有负值的情况：

1、如果操作温度是单个值且为负值（不是一个范围），比如 - 15，那么取操作温度除以 0.5 获得量程温度为 - 30。

2、如果操作温度是一个范围，比如 - 15~10，那么通过取操作温度范围拿到最左侧最大的负值，如举例中的 - 15，然后除以 0.9 获得量程温度。

比如 - 15~10，获得的量程温度为：-17。

步骤二：根据量程温度匹配量程（测量范围）。

量程温度往大了靠量程区间，比如量程温度是 - 17，那么匹配出来的量程区间为：-40~80。

最终要匹配的量程区间（测量范围）汇总：

-80~40

-40~80

02. 开关阀选型逻辑汇总

01. 开关阀的执行机构关闭时间（cylinder_close_time）获取逻辑 @常恃豪【已发测试】@冯大龙【已回测确认】

1、首先判断是否为 SIS 仪表。是否是 SIS 仪表前面逻辑做过，直接调用。

判断逻辑：功能代码（function）包含字母「Z」即为 SIS 仪表。

如果为 SIS 仪表，该字段直接设为：≤10s

2、如果不是 SIS 仪表，需要根据管径来匹配。

开关阀所在管线或设备（pipe_num）肯定是管道，根据管道编号获取管径。比如 FN340603-65-2F1，获取管径为 65。（这个逻辑之前很多地方用到，直接调用）

管径与执行机构关闭时间的对应关系汇总如下：

25：≤2s

40：≤2s

50：≤5s

65：≤5s

80：≤5s

100：≤10s

125：≤10s

150：≤20s

200：≤20s

250：≤20s

300：≤25s

400：≤40s

500：≤40s

600：≤50s

1000：≤60s

03. 调节阀选型逻辑汇总

01. 调节阀数据库中流量的 3 个字段修改 @常恃豪【已修改】

`liquid_flow` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 液体流量 ',

`steam_flow` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 蒸汽流量 ',

`gas_flow` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 气体流量 ',

更改为：

`max` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 流量 - 最大 ',

`nomal` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 流量 - 正常 ',

`min` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 流量 - 最小 ',

02. 公称流通能力相关值的获取逻辑 @常恃豪

2.1 最大阀门 Cv 值和正常阀门 Cv 值计算【已发测试】

看组装相态是液体、蒸汽、气体 3 种情况：

如果「组装相态」是「液态」或「L」，那么：

Cv=Q*1.17*SQRT(ρ/((P1-P2)*10*1000))

Q：最大流量或者正常流量，字段「max」和「nomal」

P1：最大 / 正常 / 最小流量时绝压 (MPaA)- 阀前（assembly_valve_before_press）

P2：最大 / 正常 / 最小流量时绝压 (MPaA)- 阀后（assembly_valve_after_press）

ρ：密度（density）

t：操作温度（assembly_temp）

如果「组装相态」是「汽态」或「S」，那么：

如果 P1≤2P2

如果 P1>2P2

备注：过热温度先按 0 考虑，后续再补充查表的逻辑。

如果「组装相态」是「气态」或「G」，那么：

如果 P1≤2P2

如果 P1>2P2

通过上面的计算公式，使用最大流量算出来的是最大阀门 Cv 值，使用正常流量算出来的是正常阀门 Cv 值。

最大阀门 Cv 值和正常阀门 Cv 值，填到数据库表里的下面位置，举例：26.63/38.89

2.2 计算最大和正常阀门开度【已发测试】

1、获得计算可调比 R

如果阀体形式（valve_type）包含「单座」，那么取值 50，否则取值 100。

2、查表获得公称流通能力。

通过：1）调节阀所在管道尺寸（很多地方用到此逻辑，比如开关阀所在管道的尺寸）；2）阀体形式（valve_type）。这 2 个数据查表调节阀公称流通能力（ks_valve_rated_Cv） 获得公称流通能力。

[ks_valve_rated_Cv.xlsx]

通过计算最大阀门开度校验公称流通能力。

最大阀门开度计算：

LOG：数学上的对数，以 10 为底。

公称流通能力：查表获得的。

Cv：前面逻辑计算获得的最大阀门 Cv 值。

如果算出的最大阀门开度在 0.7-0.9 之间，满足条件终止。

如果算出的最大阀门开度小于 0.7，那么查表的时候缩小一档，缩档后还是无法满足小于 0.7，那么取最后一档的值。

如果算出的最大阀门开度大于 0.9，取算出来值。（后续逻辑迭代）

公称流通能力确定后，还是用同样的公式计算正常阀门开度计算：

LOG：数学上的对数，以 10 为底。

公称流通能力：前一步确定的。

Cv：前面逻辑计算获得的正常阀门 Cv 值。

最大阀门开度和正常阀门开度，需将小数转为百分比，比如 0.84 转化为 84%，填到数据库表里的下面位置，举例：62%/84%

前面获得的「公称流通能力」填到数据库表里的如下位置：

04. 流量计选型逻辑汇总

01. 电磁流量计口径大于 250 时的参数调整 @常恃豪【已修改】

对于电磁流量计：

如果流量计所在管道的尺寸大于 250，那么：1）村里材质更改为：聚醛树脂（探头绝缘环）。2）过程标准置为空值。3）过程规格更改为：插入式。4）精度更改为：2.5。2）附件更改为：焊接套管、球阀。

02. 远传流量计默认仪表类型逻辑修正 @常恃豪【已修改】

原逻辑，远传仪表直接默认是电磁流量计。

增加一个约束条件，如果「组装相态」是「液态」或「L」，那么默认流量类型是电磁流量计，否则默认的流量类型为旋涡流量计。

03. 所有流量计补充工艺条件数据 @常恃豪【已修改】

1、流量数据：

流量：最大流量 / 正常流量 / 最小流量

对应于工艺条件数据里的：

`max` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 差压 / 流量 / 物（界）位 / 分析 / 重量 - 最大 ',

`nomal` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常 ',

`min` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 差压 / 流量 / 物（界）位 / 分析 / 重量 - 最小 ',

2、粘度数据：

对应于工艺条件数据里的：

`dynamic_viscosity` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 动力粘度 (mPa.s)',

3、测量范围：

步骤一：获取量程流量。

流量 1：正常流量（nomal）乘以 1.5 倍。

流量 2：最大流量（nomal）乘以 1.1 倍。

比较流量 1 和流量 2 哪个大，大的即为量程流量。

步骤二：圆整量程流量。

小于等于 10 的，往上取整数。比如 8.3 取整为 9。

大于 10 小于等于 1000 的，往上取整为 5 的倍数。比如 123 取整为 125。

大于 1000 的，往上取整为 50 的倍数。比如 1243 取整为 1250。

步骤二：获得测量范围。

测量范围：0~ 圆整量程流量。

比如圆整量程流量为 1250，那么测量范围为：0~1250

05. 压力表选型逻辑汇总

01. 就地压力表「备注」修正 @常恃豪【已修改】

如果就地压力表的仪表用途（service）包含字符串：爆破片出口。那么，备注（remarks）更改为：带记忆指示功能。

02. 压力变送器 / 差压变送器修正 @常恃豪【已修改】

对于压力变送器和差压变送器，如果测量元件形式为「隔膜」，那么需要修改图中黄色内容：

1、`seal_fluid` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 密封液 ',

该字段更改为：低粘度硅油

2、`element_connection` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 测量元件连接 ',

该字段更改为：直接连接

3、`process_style` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 过程连方式 ',

该字段更改为：法兰

4、`process_standard` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 过程连标准 ',

该字段更改为：HG/T20592

5、 `process_size` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 过程连规格 ',

该字段更改为：50-16RF

差压变送器，低压侧连接字段设一个默认值：通大气。

06. 其他

01. 增加设备接口表上传功能 @余开毅 @常恃豪【已发测试】【已发测试】

前端

1、仪表作业线，在「仪表数据表」卡片上面增加一个卡片「仪表设备接口上传」。

2、界面参考「工艺条件数据修改」卡片的界面，但需要增加一个下载 Excel 模板的按钮。

按钮名称为：下载仪表设备接口表模板。

下载后的文件：仪表设备接口核对表.xlsx。

后端

1、做仪表设备接口核对表模板。

[20230112 华雷 - 设备接口核对表.xlsx]

2、数据库增加数据库表仪表设备接口表（ks_equipment_nozzle）。

02. 仪表索引表过程连接尺寸匹配仪表设备接口表数据【已发测试】

导出仪表索引表时需要匹配「仪表设备接口表」的数据作为其初始值。匹配逻辑如下：

首先，只有仪表所在位置是设备的才走此逻辑，所在位置是管道的无需匹配。

步骤一：获得仪表所在位置的设备位号。如果仪表所在位置是设备，获得设备位号。

步骤二：根据设备位号、仪表大类、就地还是远程，这 3 个信息查表仪表设备接口表（ks_equipment_nozzle）获得过程连接尺寸。

备注 1：每次导出索引表的时候，走此逻辑，只要仪表所在位置的设备位号能匹配出表（ks_equipment_nozzle）的过程尺寸，都以（ks_equipment_nozzle）的数据为准。

备注 2：如果通过设备匹配表（ks_equipment_nozzle）

需求迭代汇总（2022-12-21）

备注：此次迭代需求文档的结构形式完全参考「初版需求汇总（2022-11-04）」。

02. 压力表选型逻辑汇总

2.2 匹配到仪表类型之后部分参数的修正

01. 所有类型仪表的参数调整

1、测量范围（measure_range）【已发布至测试】

详见测试文档中的「3.1 压力表量程获取逻辑修改（已放入第二次迭代的需求文档）」：20221130 仪表数据表测试 BUG 汇总 。

04. 压力变送器 / 差压变送器的参数调整 @常恃豪

1、测量元件形式（press_element_style）【已发布至测试】@冯大龙

备注：以下条件逻辑的优先级依次增高。

逻辑 1：参考就地压力表那边的逻辑判断隔离原件的形式是：隔膜、膜片、膜盒中的哪一个。

如果匹配出来的是隔膜压力表，那么该字段更改为：隔膜。

如果匹配出来的是膜片压力表，那么该字段更改为：隔膜。

大龙（2023-08-06）：做仪表安装图模块遗漏的逻辑。测量元件形式（press_element_style）匹配出来是隔膜后，在判断是不是特殊的凸膜片。如果是的修改为：隔膜 (凸膜片，H=200)

凸膜片的判断逻辑：（满足条件 1 或条件 2 即可）

条件 1：备注（assembly_comment）包含字符串「高粘度」。

条件 2：这个仪表的所在位置是管道，同时管道编号形式是自定定义管道编号形式里的自定义伴热管编号。

需求迭代汇总（2022-12-06）

01. 仪表数据处理汇总

1.1 功能代号数据源变更

所有用到功能代号（function）字段的地方，原逻辑是直接从工艺成品表里取该字段值，现改为从工艺成品表取回路号（function_tag），然后分割出里面的 function 值。

初版需求汇总（2022-11-04）

测量元件密封液（element_seal_fluid）

组分及名称（assembly_substance）

说明：紫色高亮的为数据库表 ks_instrument_snap 的字段；橙色高亮的为数据库表 ks_instrument_finished 的字段。

00. 前期工作

0.1 更新模板 Excel

以此需求提供的 Excel 模板为准。

0.2 仪表成品数据库表更改

如下图所示，去年老逻辑仪表成品数据库每个类型单独一个表，现合并为一个表，并增加字段「仪表类型」来区分。

每个类型独有的仪表字段，比如温度计独有的字段前面全部加上 temp，举例：传感器直径（sensor_diameter）更改为：temp_sensor_diameter。

各个仪表类型表新增字段汇总：

ks_temp_integrative_transmitter、ks_temp_bimetal、ks_temp_rtd 表新增字段：

1、套管型号（well_mode）

01. 所有类型仪表共用逻辑汇总

1.1 相关字段处理准备

处理获取的字段后续选型逻辑中会用到。

1、液位范围（level_range）。

对于液位计，差压 / 流量 / 物（界）位 / 分析 / 重量 - 最大（max）和差压 / 流量 / 物（界）位 / 分析 / 重量 - 最小（min），这两个字段的差值。比如最小（min）为 200，最大（max）为 4600，那么液位范围为：4400。

2、设备高度。

尺寸规格（assembly_installsize）提取字符串「x」或「X」后面的数字。比如尺寸规格为：φ1200/1300x1200（h），那么设备高度为：1200。

3、最大操作温度（max_assembly_temp）。

对操作温度（assembly_temp）字段进行处理：1）常温，替换为 30。2）填写的是温度范围，提取范围里的最大值。比如：15-120，或 15~120，提取的最大操作温度为：120。

4、最小操作温度（min_assembly_temp）。

对操作温度（assembly_temp）字段进行处理：1）常温，替换为 30。2）填写的是温度范围，提取范围里的最小值。比如：-20~-10，或 -20~20，或 -20-20，提取的最小操作温度为：-20。

5、最大操作压力（max_assembly_pressure）。

对操作压力（assembly_pressure）字段进行处理：1）常压，替换为 0。2）填写的是压力范围，提取范围里的最大值。比如：0.1-0.3，或 0.1~0.3，提取的最大操作压力为：0.3。如果压力是带 kPa 单位的，比如 10-15kPa 或 10~15kPa，提取的最大操作压力为：15kPa。

1.2 成品数据表内工艺相关数据填充

1、临时表内的部分字段直接填充到成品数据表。

成品仪表数据表中的字段与数据库表 ks_instrument_snap 中的对应关系汇总：

成品表 >> 管道 / 设备条件下面的字段：

编号：assembly_location

尺寸：assembly_installsize

材质：assembly_material

成品表 >> 操作条件下面的字段：

介质：assembly_substance

温度：assembly_temp

压力：assembly_pressure

3、备注（remarks）

如果功能代码（function）包含字母「Z」，那么备注（remarks）填充：SIL 认证。

1.3 成品数据表内统一规定相关数据修正

备注：根据统一规定的内容修改仪表成品数据表内的部分字段数据，此逻辑放到最后。

仪表选型的通用步骤：匹配仪表类型 => 填充仪表数据表初版数据 => 局部修正仪表数据表部分字段数据 => 根据统一规定内容修正仪表数据表部分字段数据。

1、电气接口尺寸（electrical_size）

如果统一规定里，仪表接口勾选了「M20x1.5」，那么电气接口尺寸（electrical_size）更改为：M20x1.5 (M)。

2、输出信号（mounting_type）

如果统一规定里，仪表接口勾选了「FF 通讯」，那么仪表型号（signal）更改为：FF。

02. 压力表选型逻辑汇总

2.1 原匹配类型逻辑核对并新增差压变送器

核对压力表原来的选型逻辑实现，是不是按照下面的逻辑图做的。

满足下面任意一个条件的，仪表类型匹配为「差压变送器」，后续生成「差压变送器」的成品数据表。

1、功能代码（function）是 PD 或 PZD 开头的。

2、操作压力（assembly_pressure）带有 kPa 单位，且前面的数值小于 15。

备注 1：成品数据表单和各类型仪表参数表单内需要新增的字段：1）低压侧取压口规格（low_pressure_connection）。

备注 2：客户端导出的成品数据表内新增「差压变送器」。@余开毅

2.2 匹配到仪表类型之后部分参数的修正

备注：过程连接规格 = 尺寸 - 压力等级和连接面形式。

压力等级和连接面形式先默认为 16RF，以后会通过其他输入字段来匹配，写逻辑时考虑此扩展性。举例：尺寸为 80 时，过程连接规格为：80-16RF。

01. 所有类型仪表的参数调整

1、测量元件密封液（element_seal_fluid）

如果组分及名称（assembly_substance）内包含字符串「氯气」或「硝酸」或「过氧化氢」，测量元件密封液（element_seal_fluid）修改为「氟碳润滑剂」。

2、测量元件材质（element_material）

如果组分及名称（assembly_substance）内包含字符串「发烟硫酸」或「HF」或「氟化物」，测量元件材质（element_material）修改为「哈氏合金 C」。

如果组分及名称（assembly_substance）内包含字符串「盐水」，测量元件材质（element_material）修改为「钛材」。

02. 隔膜压力表 / 隔膜抗震压力表 / 膜片压力表的参数调整

1、过程连接相关参数的调整

所在管线或设备（pipe_num）是管道，根据管道编号的形式来判断，如上图所示。

步骤一：根据管道编号获取管径。比如上图中的 FN340603-15-2F1，获取管径为 15。

步骤二：如果管径小于 25。1）过程连接规格（process_size）更改为：20-16RF。2）过程连接方式（process_style）更改为：工字型法兰。

03. 不锈钢压力表 / 不锈钢抗震压力表 / 膜盒压力表的参数调整

1、过程连接相关参数的调整

如果所在管线或设备（pipe_num）是管道，根据管道编号的形式来判断。

步骤一：根据管道编号获取管径。比如上图中的 FN340603-10-2F1，获取管径为 10。

步骤二：如果管径小于 15。1）过程连接规格（process_size）更改为：M14x1.5 (M)。2）表头直径（dial_diameter）更改为：60。3）精度（accuracy）更改为：2.5。

如果仪表用途（service）为：消防泵试验压力。那么，1）表头直径（dial_diameter）更改为：150。2）精度（accuracy）更改为 0.4。备注：此修正的优先级比所在位置是管道且管径小于 15 的优先级更高。

04. 压力变送器的参数调整

1、安装方式及精度修正

如果操作压力（assembly_pressure）带有 kPa 单位，且前面的数值小于等于 20，那么：1）安装方式（electrical_size）更改为：引远安装。2）精度（accuracy）更改为：±0.075。

2.3 发现的 Bug 汇总

1、量程的获取逻辑没走。

原逻辑是通过压力数据匹配压力的量程范围，上图中压力 0.3，匹配出来的范围应该是 0~4M。

2、测量元件的材质没有匹配基础库（仪表类型参数表 ks_measure_types）。

03. 温度计选型逻辑汇总

3.1 温度计类型匹配逻辑

就地温度计最终匹配出来的仪表类型汇总：双金属温度计。

集中温度计最终匹配出来的仪表类型汇总：一体化温度变送器、热电阻、热电偶。

1.1 就地温度计类型匹配

如果功能代码（function）是 TG，说明此仪表为就地温度计，仪表名称（name）直接设为：双金属温度计。

1.2 远传温度计类型匹配

如果功能代码（function）不是 TG，说明此仪表为远传温度计，仪表名称（name）直接设为：一体化温度变送器。什么情况下匹配热电偶或热电阻，逻辑后续补充。

3.2 填充仪表数据表初版数据

步骤一：填充工艺相关的数据。根据第一部分的逻辑「01. 所有类型仪表共用逻辑汇总 => 1.2 成品数据表内工艺相关数据填充」。

步骤二：填充数据表内其他的仪表参数。匹配到仪表类型后，根据仪表类型查表 ks_measure_types，获得其他字段填充到仪表数据表内。

3.3 匹配到仪表类型之后部分参数的修正

备注：过程连接规格 = 尺寸 - 压力等级和连接面形式。

压力等级和连接面形式先默认为 16RF，以后会通过其他输入字段来匹配，写逻辑时考虑此扩展性。举例：尺寸为 80 时，过程连接规格为：80-16RF。

01. 双金属温度计的参数调整

1、套管插入深度（well_insert_length）

如果所在管线或设备（pipe_num）是管道，根据管道编号的形式来判断（压力表那边修改部分参数时用到此逻辑）。

步骤一：根据管道编号获取管径。比如上图中的 FN340603-65-2F1，获取管径为 65。

步骤二：如果管径小于等于 200，套管插入深度（well_insert_length）赋值为：l=200，否则赋值为：l=250。

如果所在管线或设备（pipe_num）不是管道。

套管插入深度（well_insert_length）的获取逻辑：如果备注（assembly_comment）不包含字符串「插入深度」直接返回为空。如果包含，那么取紧跟着「插入深度」后的数字，举例，插入深度 600mm，那么取值 600。然后将数字拼接为字符串「l=600」。

2、套管材质（well_material）

如果测量介质为腐蚀性介质，那么修正为：钢衬四氟。符合如下任何一个条件的即为腐蚀性介质：1）备注（assembly_comment）包含字符串「腐蚀」。2）仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

3、套管相关的其他参数

备注（assembly_comment）包含字符串「设备带套管」。

进行如下操作：1）套管型号（well_mode）更改为：设备带套管。2）传感器形式（sensor_style）更改为：卡套 M27x2 (M)。3）套管形式（well_style）、套管材质（well_material）、套管直径（well_diameter）、过程连接方式（process_style）、过程连接材质（process_material）、过程连接规格（process_size），上述字段全部置为空。

02. 一体化温度变送器的参数调整

1、套管插入深度（well_insert_length）

完全参考双金属温度计参数调整的逻辑。

2、套管材质（well_material）

完全参考双金属温度计参数调整的逻辑。

3、套管相关的其他参数

完全参考双金属温度计参数调整的逻辑。

4、分度号（mark_graduation）

如果操作温度（assembly_temp）大于 600，或者仪表用途（service）包含字符串「泵出口」、「风机出口」。那么：分度号（mark_graduation）更改为：K。

04. 液位计选型逻辑汇总

4.1 液位计类型匹配逻辑

就地液位计最终匹配出来的仪表类型汇总：磁性液位计、玻璃板液位计。

集中液位计最终匹配出来的仪表类型汇总：液位开关、差压变送器、雷达液位计、伺服液位计、超声波液位计、电浮筒液位计、磁致伸缩液位计。

备注：液位范围，是公用逻辑中处理后得到的字段。

1.1 就地液位计类型匹配

如果功能代码（function）是 LG，说明此仪表为就地液位计。

仪表名称（name）默认设为：磁性液位计。

如果同时满足下面 2 个条件的话，更改为：玻璃板液位计。1）如果备注（assembly_comment）包含字符串「玻璃板」。2）液位范围小于等于 2000。

1.2 集中液位计类型匹配

如果功能代码（function）不是 LG，说明此仪表为远传液位计。

首先看功能代码（function）里是否含有字符串「I」，如果包含，那么仪表名称（name）默认设为：磁性液位计。否则，仪表名称（name）设为：液位开关。

满足下面任何一个条件的，仪表名称（name）更改为：差压变送器。

条件 1：备注（assembly_comment）包含字符串「压差液位计」或「差压液位计」。

条件 2：最大操作温度大于 250。

条件 3：功能代码（function）中包含字符串「C」且液位范围大于 1000 小于 10000。

条件 4：备注（assembly_comment）包含字符串「高粘度」、「易结晶」。

条件 5：备注（assembly_comment）包含字符串「易结冻」且设备高度小于等于 4500。

条件 6：设备高度大于 4500 且小于等于 10000。

满足下面任何一个条件的，仪表名称（name）更改为：雷达液位计。

条件 1：备注（assembly_comment）包含字符串「雷达」或「顶插」。

条件 2：测量控制点名称（assembly_name）包含字符串「水池液位」、「计量罐」、「反应釜液位」。

条件 3：设备高度大于 10000。

满足下面任何一个条件的，仪表名称（name）更改为：电浮筒液位计。

条件 1：备注（assembly_comment）包含字符串「电浮筒液位计」。

条件 2：设备高度小于 1000。

条件 3：备注（assembly_comment）包含字符串「易汽化」或「宜汽化」。

满足下面任何一个条件的，仪表名称（name）更改为：磁致伸缩液位计。

条件 1：备注（assembly_comment）包含字符串「磁致伸缩」。

条件 2：功能代码（function）中包含字符串「C」且液位范围小于等于 1000。

逻辑修正（2023-08-14）：@常恃豪

磁致伸缩液位计也是一种磁性液位计。修改的地方 2 处：1）上面仪表名称（name）更改为：磁性液位计。2）该液位计的参数调整那边，备注（remarks）更改为：磁致伸缩。

4.2 填充仪表数据表初版数据

步骤一：填充工艺相关的数据。根据第一部分的逻辑「01. 所有类型仪表共用逻辑汇总 => 1.2 成品数据表内工艺相关数据填充」。

步骤二：填充数据表内其他的仪表参数。匹配到仪表类型后，根据仪表类型查表 ks_measure_types，获得其他字段填充到仪表数据表内。

4.3 匹配到仪表类型之后部分参数的修正

备注：过程连接规格 = 尺寸 - 压力等级和连接面形式。

压力等级和连接面形式先默认为 16RF，以后会通过其他输入字段来匹配，写逻辑时考虑此扩展性。举例：尺寸为 80 时，过程连接规格为：80-16RF。

01. 磁性液位计的参数调整

1、过程连接规格（process_size）

如果测量范围大于 3000，那么更改为：80-16RF。

2、指示器触液材质（level_guage_material）

如果测量介质为腐蚀性介质，那么更改为：钢衬四氟。

符合如下任何一个条件的即为腐蚀性介质：1）备注（assembly_comment）包含字符串「腐蚀」。2）仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

02. 液位开关的参数调整

1、探头材质（probe_material）

如果测量介质为腐蚀性介质，那么更改为：钢衬四氟。

符合如下任何一个条件的即为腐蚀性介质：1）备注（assembly_comment）包含字符串「腐蚀」。2）仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

03. 雷达液位计的参数调整

1、过程连接规格（process_size）

如果操作压力（assembly_pressure）为：常压，那么更改为：100-16RF。

2、指示器触液材质（level_guage_material）

如果测量介质为腐蚀性介质，那么更改为：PTFE。

符合如下任何一个条件的即为腐蚀性介质：1）备注（assembly_comment）包含字符串「腐蚀」。2）仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

04. 差压变送器的参数调整

1、安装方式（mounting_type）

更改为：

毛细管：LP:3mxHP:1m

2、附件（accessories）

更改为：配不锈钢支架。

05. 开关阀选型逻辑汇总

5.1 阀门类型匹配逻辑

最终匹配出来的阀门类型汇总：开关阀、电磁阀。

仪表名称（name）默认设为：开关阀。测量控制点名称（assembly_name）包含字符串「压缩空气开关阀」或「压缩空气管道开关阀」，那么仪表名称（name）更改为：电磁阀。

5.2 填充仪表数据表初版数据

步骤一：填充工艺相关的数据。根据第一部分的逻辑「01. 所有类型仪表共用逻辑汇总 => 1.2 成品数据表内工艺相关数据填充」。

步骤二：填充数据表内其他的仪表参数。匹配到仪表类型后，根据仪表类型查表 ks_measure_types，获得其他字段填充到仪表数据表内。

5.3 匹配到仪表类型之后部分参数的修正

备注：过程连接规格 = 尺寸 - 压力等级和连接面形式。

压力等级和连接面形式先默认为 16RF，以后会通过其他输入字段来匹配，写逻辑时考虑此扩展性。举例：尺寸为 80 时，过程连接规格为：80-16RF。

01. 开关阀的参数调整

1、过程连接规格（process_size）

开关阀所在管线或设备（pipe_num）肯定是管道，根据管道编号获取管径。比如上图中的 FN340603-65-2F1，获取管径为 65。那么过程连接规格更改为：65-16RF。

2、阀芯阀座材质（valve_seat_material）

最大操作温度（max_assembly_temp）大于 100 且小于等于 180，那么更改为：304/RPTFE。

3、阀体填料材质（valve_seal_material）

满足下面任意一个条件的话，那么更改为：柔性石墨。

1）最大操作温度（max_assembly_temp）大于 200。

2）最小操作温度（min_assembly_temp）小于 - 35。

3）组分及名称（assembly_substance）内包含字符串「蒸汽」或「导热油」。

4）管道等级号的首个数字大于等于 4。管道等级号的获取逻辑：开关阀所在管线或设备（pipe_num）肯定是管道，根据管道编号结合工艺专业那边的自定义管道编号形式，获取管道等级号。比如管道号 FN340603-65-4J1，管道等级号为 4J1，管道等级号的首个数字为 4。

4、阀门失能位置（valverequestment）

直接取临时表里的阀门失能位置（valverequestment）。

5、阀体形式（valve_type）

逻辑待补充。如果 XXXX，那么更改为：双偏心蝶阀。

6、执行机构关闭时间（cylinder_close_time）

需查表，逻辑待补充。详见二次迭代的需求文档：20230112 仪表选型模块二次迭代汇总

7、电磁阀工作电压（solenoid_operate_voltage）2023-03-01 补充

如果功能代码（function）包含字母「Z」，那么修改为：24VDC (3.7W), 耐高温（H 级）绝缘线圈。

如果阀门失能位置（valverequestment）为：FL，那么修改为：二位五通 / 单电控 / 电开。

06. 调节阀选型逻辑汇总

6.1 阀门类型匹配逻辑

仪表名称（name）默认设为：调节阀。

6.2 填充仪表数据表初版数据

步骤一：填充工艺相关的数据。根据第一部分的逻辑「01. 所有类型仪表共用逻辑汇总 => 1.2 成品数据表内工艺相关数据填充」。

步骤二：填充数据表内其他的仪表参数。匹配到仪表类型后，根据仪表类型查表 ks_measure_types，获得其他字段填充到仪表数据表内。

6.3 匹配到仪表类型之后部分参数的修正

1、过程连接规格（process_size）

等同开关阀那边的逻辑。

2、阀体形式（valve_type）

备注：以下条件逻辑的优先级依次增高。

条件逻辑 1：符合下面任何一个条件的，那么更改为：波纹管密封单座。

1、仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

2、组分及名称（assembly_substance）内包含字符串「HF」或「氟化氢」。

3、组分及名称（assembly_substance）内包含字符串「NH3」或「氨气」或「H2S」或「硫化氢」或「导热油」。

4、操作压力（assembly_pressure）有值，且小于 0.1。

条件逻辑 2：所在管道为夹套管，那么更改为：偏心旋转阀。夹套管的获取逻辑：所在管道的编号形式与工艺专业的自定义管道编号里夹套管的编号形式相同。

3、阀体波纹管材质（valve_bellow_material）

备注 1：以下 if 条件逻辑的优先级依次增高。备注 2：此字段，默认为空，只有在阀体形式（valve_type）字段更改为「波纹管密封单座」才会走下面的逻辑赋值。

1、仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。此字段更改为：PTFE。

2、组分及名称（assembly_substance）内包含字符串「HF」或「氟化氢」。此字段更改为：S31603。

3、组分及名称（assembly_substance）内包含字符串「NH3」或「氨气」或「H2S」或「硫化氢」或「导热油」。此字段更改为：S30408。

4、阀体材质（valve_material）

备注：以下 if 条件逻辑的优先级依次增高。

1、仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。此字段更改为：WCB+F46。

2、组分及名称（assembly_substance）内包含字符串「HF」或「氟化氢」。此字段更改为：S31603。

5、阀芯阀座材质（valve_seat_material）

备注：以下 if 条件逻辑的优先级依次增高。

1、仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。此字段更改为：304+F46。

2、组分及名称（assembly_substance）内包含字符串「HF」或「氟化氢」。此字段更改为：S31603。

3、组分及名称（assembly_substance）内包含字符串「蒸汽」。此字段更改为：S304+ST。

4、阀前阀后压差大于 1.5。此字段更改为：S304+ST。阀前阀后压差的获取逻辑：仪表临时表里，valve_before_press 字段和 valve_after_press 字段的差值。

6、阀体填料材质（valve_seal_material）

满足下面任意一个条件的话，那么更改为：柔性石墨。

1）最大操作温度（max_assembly_temp）大于 200。

2）最小操作温度（min_assembly_temp）小于 - 35。

3）组分及名称（assembly_substance）内包含字符串「蒸汽」或「导热油」。

4）管道等级号的首个数字大于等于 4。管道等级号的获取逻辑：开关阀所在管线或设备（pipe_num）肯定是管道，根据管道编号结合工艺专业那边的自定义管道编号形式，获取管道等级号。比如管道号 FN340603-65-4J1，管道等级号为 4J1，管道等级号的首个数字为 4。

7、备注（remarks）

备注：以下 if 条件逻辑的优先级依次增高。

1、最小操作温度（min_assembly_temp）小于 -20。1）如果此字段为空值。此字段更改为：低温型。1）如果此字段有值，比如为：SIL 认证。那么此字段需要在原值后面拼接字符串「；低温型」，更改为：「SIL 认证；低温型」。

2、最大操作温度（max_assembly_temp）大于 220。1）如果此字段为空值。此字段更改为：高温型。1）如果此字段有值，比如为：SIL 认证。那么此字段需要在原值后面拼接字符串「；高温型」，更改为：「SIL 认证；高温型」。

备注：因为在前面的逻辑「01. 所有类型仪表共用逻辑汇总 > 1.2 成品数据表内工艺相关数据填充」会对备注字段进行处理，如果功能代码（function）包含字母「Z」，那么备注（remarks）填充：SIL 认证。所以备注字段此时可能有值，有值的话不能被覆盖掉，所以有值和空值的情况分开考虑。

07. 流量计选型逻辑汇总

7.1 流量计类型匹配逻辑

就地流量计最终匹配出来的仪表类型汇总：转子流量计、水表。

集中流量计最终匹配出来的仪表类型汇总：电磁流量计、转子流量计、质量流量计、涡街流量计、旋涡流量计、容积式流量计、差压流量计、超声波流量计。

1.1 就地流量计类型匹配

仪表类型（instrument_type）为：flow，且仪表类别（data_class）为：location，那么此仪表为就地流量计。

仪表名称（name）默认设为：转子流量计。

如果功能代码（function）为：FQ，那么更改为：水表。

1.2 集中流量计类型匹配

除就地流量计以外的流量计均为远传量计。

那么仪表名称（name）默认设为：电磁流量计。

满足下面任何一个条件的，仪表名称（name）更改为：质量流量计。

条件 1：备注（assembly_comment）包含字符串「质量流量计」。

条件 2：测量控制点名称（assembly_name）包含字符串「罐区流量计」。

条件 3：组分及名称（assembly_substance）内包含字符串「氢气」或「一氧化碳」。

满足下面任何一个条件的，仪表名称（name）更改为：涡街流量计。

条件 1：备注（assembly_comment）包含字符串「涡街流量计」。

条件 2：组分及名称（assembly_substance）内包含字符串「天然气」。

条件 3：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 250。3）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值大于等于 20，且工作压力（pressure）的值大于 0.1。

条件 4：1）组分及名称（assembly_substance）内包含字符串「蒸汽」2）同时，所在管道的管径小于等于 250。

条件 5：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 250。3）同时，状态（assembly_phase）为字符串「液态」或「液相」或「L」；4）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值大于等于 1，且工作压力（pressure）的值大于 0.1。5）同时，介质不导电。不导电的逻辑取反导电逻辑。介质导电的判断逻辑（电磁流量计有用到）：组分及名称（assembly_substance）内包含字符串「循环水」、「冷却水」、「自来水」。（2023-06-05）@常恃豪

满足下面任何一个条件的，仪表名称（name）更改为：差压式流量计。

条件 1：备注（assembly_comment）包含字符串「差压式流量计」。

条件 2：1）组分及名称（assembly_substance）内包含字符串「蒸汽」。2）同时，所在管道的管径大于 250。

满足下面任何一个条件的，仪表名称（name）更改为：容积式流量计。

条件 1：备注（assembly_comment）包含字符串「容积式流量计」。

条件 2：备注（assembly_comment）包含字符串「高粘度」同时量程比小于等于 10。量程比的获取逻辑：差压 / 流量 / 物（界）位 / 分析 / 重量 - 最大（max）和差压 / 流量 / 物（界）位 / 分析 / 重量 - 最小（min），这两个字段的比值。如果 max 和 min 这两个字段，有一个为空值，那么就不走此逻辑了。

满足下面任何一个条件的，仪表名称（name）更改为：超声波流量计。

条件 1：备注（assembly_comment）包含字符串「超声波流量计」。

条件 2：1）备注（assembly_comment）包含字符串「高粘度」。2）同时，量程比大于 10。量程比的获取逻辑：差压 / 流量 / 物（界）位 / 分析 / 重量 - 最大（max）和差压 / 流量 / 物（界）位 / 分析 / 重量 - 最小（min），这两个字段的比值。如果 max 和 min 这两个字段，有一个为空值，那么就不走此逻辑了。

条件 3：1）所在管道为非金属管道或耐腐蚀金属。2）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，量程比大于 10。

所在管道为非金属管道或耐腐蚀金属判断逻辑：仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯、哈氏合金、钛。

条件 4：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径大于等于 800。备注：管径信息的获取逻辑很多地方用到，参考前面的逻辑。

所在管道为碳钢 / 不锈钢的判断逻辑：仪表临时表中，材质（assembly_material）为下面任意一个的：20、S30408、S31603、碳钢、不锈钢。

满足下面任何一个条件的，仪表名称（name）更改为：转子流量计。

条件 1：备注（assembly_comment）包含字符串「转子流量计」。

条件 2：1）所在管道为非金属管道或耐腐蚀金属；2）同时，状态（assembly_phase）为字符串「液态」或「液相」或「L」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 1。

条件 3：1）所在管道为非金属管道或耐腐蚀金属；2）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，量程比小于 10。

条件 4：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 100。3）同时，状态（assembly_phase）为字符串「液态」或「液相」或「L」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 1 或者工作压力（pressure）的值小于 0.1。

条件 5：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 100。3）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 20，且工作压力（pressure）带有单位 kPa，值大于 10。

满足下面任何一个条件的，仪表名称（name）更改为：电磁流量计。

条件 1：备注（assembly_comment）包含字符串「电磁流量计」。

条件 2：所测量的介质导电。介质导电的判断逻辑：组分及名称（assembly_substance）内包含字符串「循环水」、「冷却水」、「自来水」。

条件 3：1）所在管道为非金属管道或耐腐蚀金属；2）同时，状态（assembly_phase）为字符串「液态」或「液相」或「L」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值大于等于 1；4）同时工作压力（pressure）的值大于 0.1。

7.2 填充仪表数据表初版数据

步骤一：填充工艺相关的数据。根据第一部分的逻辑「01. 所有类型仪表共用逻辑汇总 => 1.2 成品数据表内工艺相关数据填充」。

步骤二：填充数据表内其他的仪表参数。匹配到仪表类型后，根据仪表类型查表 ks_measure_types，获得其他字段填充到仪表数据表内。

7.3 匹配到仪表类型之后部分参数的修正

01. 质量流量计的参数调整

1、精度（accuracy）

如果组分及名称（assembly_substance）内包含字符串「氢气」或「一氧化碳」，那么更改为：1。

2、测量元件材质（element_material）

所在管道为非金属管道或耐腐蚀金属，那么更改为：哈氏合金 C。

02. 涡街流量计的参数调整

1、精度（accuracy）

如果组分及名称（assembly_substance）内包含字符串「天然气」，那么更改为：0.5% of reading。

2、备注（remarks）

备注：以下条件逻辑的优先级依次增高。

符合条件逻辑 1，那么更改为：一体化压力补偿。

条件逻辑 1：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 250。3）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值大于等于 20，且工作压力（pressure）的值大于 0.1。

符合条件逻辑 2，那么更改为：一体化温度压力补偿。

条件逻辑 2：1）组分及名称（assembly_substance）内包含字符串「蒸汽」2）同时，所在管道的管径小于等于 250。

3、过程连接规格（process_size）

根据所在管道编号获取管径，再缩小一档。比如 FN340603-65-2F1，获取管径为 65，缩小一档为 50。那么过程连接规格更改为：50-16RF。

备注：管径缩档的逻辑详见发酵模块那边匹配管径时写的逻辑。

03. 电磁流量计的参数调整

1、过程连接规格（process_size）

根据所在管道编号获取管径。比如 FN340603-65-2F1，获取管径为 65。那么过程连接规格更改为：65-16RF。

2、电极材质（flow_electrode_material）、接地环材质（flow_ground_ring_material）

备注：以下条件逻辑只要匹配到一个直接跳出。

符合条件逻辑 1 或条件逻辑 2，那么电极材质（flow_electrode_material）、接地环材质（flow_ground_ring_material）更改为：哈氏合金 C。

条件逻辑 1：所在管道为非金属材质。

管道为非金属材质的判断逻辑：仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

条件逻辑 2：1）所在管道为碳钢 / 不锈钢。2）同时，组分及名称（assembly_substance）内包含字符串「浓硫酸」。

符合条件逻辑 1，那么电极材质（flow_electrode_material）、接地环材质（flow_ground_ring_material）更改为：哈氏合金 C。

条件逻辑 1：所在管道为非金属材质。

管道为非金属材质的判断逻辑：仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

符合条件逻辑 2，那么电极材质（flow_electrode_material）更改为：铂铱合金，接地环材质（flow_ground_ring_material）更改为：虚拟接地。

条件逻辑 2：1）所在管道为碳钢 / 不锈钢。2）同时，组分及名称（assembly_substance）内包含字符串「浓硫酸」或者「发烟硫酸」。

符合条件逻辑 3，那么电极材质（flow_electrode_material）、接地环材质（flow_ground_ring_material）更改为：Ta。

条件逻辑 3：1）所在管道为碳钢 / 不锈钢。2）同时，组分及名称（assembly_substance）内包含字符串「浓硝酸」。

符合条件逻辑 4，那么电极材质（flow_electrode_material）更改为：哈氏合金 C。接地环材质（flow_ground_ring_material）更改为：N/A。

条件逻辑 4：1）所在管道为碳钢 / 不锈钢。2）同时，组分及名称（assembly_substance）内包含字符串「Cl-」、「NaCl」、「氯离子」、「氯化钠」。

04. 转子流量计的参数调整

1、附件（accessories）

备注：以下条件逻辑的优先级依次增高。

符合条件逻辑 1，那么更改为：气阻尼。

条件逻辑 1：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 800。3）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 20，且工作压力（pressure）带有单位 kPa，值大于 10。

05. 差压式流量计的参数调整

1、备注（remarks）

备注：以下条件逻辑的优先级依次增高。

符合条件逻辑 1，那么更改为：一体化温度压力补偿。

条件逻辑 1：1）组分及名称（assembly_substance）内包含字符串「蒸汽」。2）同时，所在管道的管径大于 250。
