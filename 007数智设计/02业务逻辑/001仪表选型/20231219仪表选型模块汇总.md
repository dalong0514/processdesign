## 2023129仪表选型模块汇总

### 需求迭代汇总 - 上传条件数据（2023-05-15）

#### 01. 新增上传条件数据页面 @余开毅 @戴强 @常恃豪

仪表作业线新增卡片：仪表条件上传。卡片的位置在「仪表选型统一规定」之后。

01 仪表上传

显示 2 张表：上面的是仪表条件数据表，下面的是阀门条件数据表。

前置工作：gs_instrument_finished 和 gs_instrumentv_finished 这两个表增加一个专业字段（profession）。

上传工艺仪表条件和工艺阀门条件

点击上传工艺仪表条件按钮后，弹出上传面板：

用户将 Excel 拖进上传框或者点击上传框打开文件上传。

1、上传工艺仪表条件时，后端将数据更新进数据库表 gs_instrument_finished，专业（profession）默认为 gs。

2、上传工艺阀门条件时，后端将数据更新进数据库表 gs_instrumentv_finished，专业（profession）默认为 gs。

备注：每次更新按专业覆盖数据，参考电气专业的用电负荷表模块的上传逻辑。

上传其他专业仪表条件和其他专业阀门条件

点击上传工艺仪表条件按钮后，弹出上传面板（使用场景完全参考电气专业的用电负荷表模块）：

1、上传其他专业仪表条件时。点下载模板后，打开 Excel 模板表，用户将数据填充后，数据库表 gs_instrument_finished，专业（profession）以模板表里用户填的专业为准。

2、上传其他专业阀门条件时。点下载模板后，打开 Excel 模板表，用户将数据填充后，数据库表 gs_instrumentv_finished，专业（profession）以模板表里用户填的专业为准。

备注：每次更新按专业覆盖数据，参考电气专业的用电负荷表模块的上传逻辑。

在 Excel 表打开仪表条件和其他专业阀门条件数据

点击按钮后打开一张临时性 Excel 表供用户查看，用户无法在这里修改数据，仅查看用。

02 其他修改 @常恃豪

1、工艺专业那边导出成品仪表条件时，不入库成品表。否则工艺导一次成品仪表条件就会把仪表这边上传的数据覆盖一次。

2、工艺成品仪表数据和阀门数据表，增加一行隐藏行字段，定位数据的。

需求迭代汇总（2023-01-12）

01. 温度计选型逻辑汇总

01. 双金属温度计和一体化温度变送器的测量范围获取逻辑 @常恃豪【已发测试】@冯大龙【已回测确认】

备注：此逻辑跟压力表的量程获取逻辑很像。

如果温度全部为正值的情况：

步骤一：获取用于匹配量程的「量程温度」。量程温度的获取逻辑仅与「操作温度」有关。

1、如果操作温度是单个值（不是一个范围），比如 25，那么取操作温度除以 0.5 获得量程温度为 50。

2、如果操作温度是一个范围，比如 28~121，那么通过取操作温度范围拿到最大的温度 121，然后除以 0.9 获得量程温度。

步骤二：根据量程温度匹配量程（测量范围）。

量程温度往上靠量程区间，比如量程温度是 140，那么匹配出来的量程区间为：0~150。

最终要匹配的量程区间（测量范围）汇总：

0~50

0~100

0~150

0~200

0~300

0~400

0~500

0~600

0~700

0~800

如果温度有负值的情况：

1、如果操作温度是单个值且为负值（不是一个范围），比如 - 15，那么取操作温度除以 0.5 获得量程温度为 - 30。

2、如果操作温度是一个范围，比如 - 15~10，那么通过取操作温度范围拿到最左侧最大的负值，如举例中的 - 15，然后除以 0.9 获得量程温度。

比如 - 15~10，获得的量程温度为：-17。

步骤二：根据量程温度匹配量程（测量范围）。

量程温度往大了靠量程区间，比如量程温度是 - 17，那么匹配出来的量程区间为：-40~80。

最终要匹配的量程区间（测量范围）汇总：

-80~40

-40~80

02. 开关阀选型逻辑汇总

01. 开关阀的执行机构关闭时间（cylinder_close_time）获取逻辑 @常恃豪【已发测试】@冯大龙【已回测确认】

1、首先判断是否为 SIS 仪表。是否是 SIS 仪表前面逻辑做过，直接调用。

判断逻辑：功能代码（function）包含字母「Z」即为 SIS 仪表。

如果为 SIS 仪表，该字段直接设为：≤10s

2、如果不是 SIS 仪表，需要根据管径来匹配。

开关阀所在管线或设备（pipe_num）肯定是管道，根据管道编号获取管径。比如 FN340603-65-2F1，获取管径为 65。（这个逻辑之前很多地方用到，直接调用）

管径与执行机构关闭时间的对应关系汇总如下：

25：≤2s

40：≤2s

50：≤5s

65：≤5s

80：≤5s

100：≤10s

125：≤10s

150：≤20s

200：≤20s

250：≤20s

300：≤25s

400：≤40s

500：≤40s

600：≤50s

1000：≤60s

03. 调节阀选型逻辑汇总

01. 调节阀数据库中流量的 3 个字段修改 @常恃豪【已修改】

`liquid_flow` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 液体流量 ',

`steam_flow` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 蒸汽流量 ',

`gas_flow` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 气体流量 ',

更改为：

`max` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 流量 - 最大 ',

`nomal` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 流量 - 正常 ',

`min` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 流量 - 最小 ',

02. 公称流通能力相关值的获取逻辑 @常恃豪

2.1 最大阀门 Cv 值和正常阀门 Cv 值计算【已发测试】

看组装相态是液体、蒸汽、气体 3 种情况：

如果「组装相态」是「液态」或「L」，那么：

Cv=Q*1.17*SQRT(ρ/((P1-P2)*10*1000))

Q：最大流量或者正常流量，字段「max」和「nomal」

P1：最大 / 正常 / 最小流量时绝压 (MPaA)- 阀前（assembly_valve_before_press）

P2：最大 / 正常 / 最小流量时绝压 (MPaA)- 阀后（assembly_valve_after_press）

ρ：密度（density）

t：操作温度（assembly_temp）

如果「组装相态」是「汽态」或「S」，那么：

如果 P1≤2P2

如果 P1>2P2

备注：过热温度先按 0 考虑，后续再补充查表的逻辑。

如果「组装相态」是「气态」或「G」，那么：

如果 P1≤2P2

如果 P1>2P2

通过上面的计算公式，使用最大流量算出来的是最大阀门 Cv 值，使用正常流量算出来的是正常阀门 Cv 值。

最大阀门 Cv 值和正常阀门 Cv 值，填到数据库表里的下面位置，举例：26.63/38.89

2.2 计算最大和正常阀门开度【已发测试】

1、获得计算可调比 R

如果阀体形式（valve_type）包含「单座」，那么取值 50，否则取值 100。

2、查表获得公称流通能力。

通过：1）调节阀所在管道尺寸（很多地方用到此逻辑，比如开关阀所在管道的尺寸）；2）阀体形式（valve_type）。这 2 个数据查表调节阀公称流通能力（ks_valve_rated_Cv） 获得公称流通能力。

[ks_valve_rated_Cv.xlsx]

通过计算最大阀门开度校验公称流通能力。

最大阀门开度计算：

LOG：数学上的对数，以 10 为底。

公称流通能力：查表获得的。

Cv：前面逻辑计算获得的最大阀门 Cv 值。

如果算出的最大阀门开度在 0.7-0.9 之间，满足条件终止。

如果算出的最大阀门开度小于 0.7，那么查表的时候缩小一档，缩档后还是无法满足小于 0.7，那么取最后一档的值。

如果算出的最大阀门开度大于 0.9，取算出来值。（后续逻辑迭代）

公称流通能力确定后，还是用同样的公式计算正常阀门开度计算：

LOG：数学上的对数，以 10 为底。

公称流通能力：前一步确定的。

Cv：前面逻辑计算获得的正常阀门 Cv 值。

最大阀门开度和正常阀门开度，需将小数转为百分比，比如 0.84 转化为 84%，填到数据库表里的下面位置，举例：62%/84%

前面获得的「公称流通能力」填到数据库表里的如下位置：

04. 流量计选型逻辑汇总

01. 电磁流量计口径大于 250 时的参数调整 @常恃豪【已修改】

对于电磁流量计：

如果流量计所在管道的尺寸大于 250，那么：1）村里材质更改为：聚醛树脂（探头绝缘环）。2）过程标准置为空值。3）过程规格更改为：插入式。4）精度更改为：2.5。2）附件更改为：焊接套管、球阀。

02. 远传流量计默认仪表类型逻辑修正 @常恃豪【已修改】

原逻辑，远传仪表直接默认是电磁流量计。

增加一个约束条件，如果「组装相态」是「液态」或「L」，那么默认流量类型是电磁流量计，否则默认的流量类型为旋涡流量计。

03. 所有流量计补充工艺条件数据 @常恃豪【已修改】

1、流量数据：

流量：最大流量 / 正常流量 / 最小流量

对应于工艺条件数据里的：

`max` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 差压 / 流量 / 物（界）位 / 分析 / 重量 - 最大 ',

`nomal` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常 ',

`min` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 差压 / 流量 / 物（界）位 / 分析 / 重量 - 最小 ',

2、粘度数据：

对应于工艺条件数据里的：

`dynamic_viscosity` varchar (128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 动力粘度 (mPa.s)',

3、测量范围：

步骤一：获取量程流量。

流量 1：正常流量（nomal）乘以 1.5 倍。

流量 2：最大流量（nomal）乘以 1.1 倍。

比较流量 1 和流量 2 哪个大，大的即为量程流量。

步骤二：圆整量程流量。

小于等于 10 的，往上取整数。比如 8.3 取整为 9。

大于 10 小于等于 1000 的，往上取整为 5 的倍数。比如 123 取整为 125。

大于 1000 的，往上取整为 50 的倍数。比如 1243 取整为 1250。

步骤二：获得测量范围。

测量范围：0~ 圆整量程流量。

比如圆整量程流量为 1250，那么测量范围为：0~1250

05. 压力表选型逻辑汇总

01. 就地压力表「备注」修正 @常恃豪【已修改】

如果就地压力表的仪表用途（service）包含字符串：爆破片出口。那么，备注（remarks）更改为：带记忆指示功能。

02. 压力变送器 / 差压变送器修正 @常恃豪【已修改】

对于压力变送器和差压变送器，如果测量元件形式为「隔膜」，那么需要修改图中黄色内容：

1、`seal_fluid` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 密封液 ',

该字段更改为：低粘度硅油

2、`element_connection` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 测量元件连接 ',

该字段更改为：直接连接

3、`process_style` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 过程连方式 ',

该字段更改为：法兰

4、`process_standard` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 过程连标准 ',

该字段更改为：HG/T20592

5、 `process_size` varchar (64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT ' 过程连规格 ',

该字段更改为：50-16RF

差压变送器，低压侧连接字段设一个默认值：通大气。

06. 其他

01. 增加设备接口表上传功能 @余开毅 @常恃豪【已发测试】【已发测试】

前端

1、仪表作业线，在「仪表数据表」卡片上面增加一个卡片「仪表设备接口上传」。

2、界面参考「工艺条件数据修改」卡片的界面，但需要增加一个下载 Excel 模板的按钮。

按钮名称为：下载仪表设备接口表模板。

下载后的文件：仪表设备接口核对表.xlsx。

后端

1、做仪表设备接口核对表模板。

[20230112 华雷 - 设备接口核对表.xlsx]

2、数据库增加数据库表仪表设备接口表（ks_equipment_nozzle）。

02. 仪表索引表过程连接尺寸匹配仪表设备接口表数据【已发测试】

导出仪表索引表时需要匹配「仪表设备接口表」的数据作为其初始值。匹配逻辑如下：

首先，只有仪表所在位置是设备的才走此逻辑，所在位置是管道的无需匹配。

步骤一：获得仪表所在位置的设备位号。如果仪表所在位置是设备，获得设备位号。

步骤二：根据设备位号、仪表大类、就地还是远程，这 3 个信息查表仪表设备接口表（ks_equipment_nozzle）获得过程连接尺寸。

备注 1：每次导出索引表的时候，走此逻辑，只要仪表所在位置的设备位号能匹配出表（ks_equipment_nozzle）的过程尺寸，都以（ks_equipment_nozzle）的数据为准。

备注 2：如果通过设备匹配表（ks_equipment_nozzle）

需求迭代汇总（2022-12-21）

备注：此次迭代需求文档的结构形式完全参考「初版需求汇总（2022-11-04）」。

02. 压力表选型逻辑汇总

2.2 匹配到仪表类型之后部分参数的修正

01. 所有类型仪表的参数调整

1、测量范围（measure_range）【已发布至测试】

详见测试文档中的「3.1 压力表量程获取逻辑修改（已放入第二次迭代的需求文档）」：20221130 仪表数据表测试 BUG 汇总 。

04. 压力变送器 / 差压变送器的参数调整 @常恃豪

1、测量元件形式（press_element_style）【已发布至测试】@冯大龙

备注：以下条件逻辑的优先级依次增高。

逻辑 1：参考就地压力表那边的逻辑判断隔离原件的形式是：隔膜、膜片、膜盒中的哪一个。

如果匹配出来的是隔膜压力表，那么该字段更改为：隔膜。

如果匹配出来的是膜片压力表，那么该字段更改为：隔膜。

大龙（2023-08-06）：做仪表安装图模块遗漏的逻辑。测量元件形式（press_element_style）匹配出来是隔膜后，在判断是不是特殊的凸膜片。如果是的修改为：隔膜 (凸膜片，H=200)

凸膜片的判断逻辑：（满足条件 1 或条件 2 即可）

条件 1：备注（assembly_comment）包含字符串「高粘度」。

条件 2：这个仪表的所在位置是管道，同时管道编号形式是自定定义管道编号形式里的自定义伴热管编号。

需求迭代汇总（2022-12-06）

01. 仪表数据处理汇总

1.1 功能代号数据源变更

所有用到功能代号（function）字段的地方，原逻辑是直接从工艺成品表里取该字段值，现改为从工艺成品表取回路号（function_tag），然后分割出里面的 function 值。

初版需求汇总（2022-11-04）

测量元件密封液（element_seal_fluid）

组分及名称（assembly_substance）

说明：紫色高亮的为数据库表 ks_instrument_snap 的字段；橙色高亮的为数据库表 ks_instrument_finished 的字段。

00. 前期工作

0.1 更新模板 Excel

以此需求提供的 Excel 模板为准。

0.2 仪表成品数据库表更改

如下图所示，去年老逻辑仪表成品数据库每个类型单独一个表，现合并为一个表，并增加字段「仪表类型」来区分。

每个类型独有的仪表字段，比如温度计独有的字段前面全部加上 temp，举例：传感器直径（sensor_diameter）更改为：temp_sensor_diameter。

各个仪表类型表新增字段汇总：

ks_temp_integrative_transmitter、ks_temp_bimetal、ks_temp_rtd 表新增字段：

1、套管型号（well_mode）

01. 所有类型仪表共用逻辑汇总

1.1 相关字段处理准备

处理获取的字段后续选型逻辑中会用到。

1、液位范围（level_range）。

对于液位计，差压 / 流量 / 物（界）位 / 分析 / 重量 - 最大（max）和差压 / 流量 / 物（界）位 / 分析 / 重量 - 最小（min），这两个字段的差值。比如最小（min）为 200，最大（max）为 4600，那么液位范围为：4400。

2、设备高度。

尺寸规格（assembly_installsize）提取字符串「x」或「X」后面的数字。比如尺寸规格为：φ1200/1300x1200（h），那么设备高度为：1200。

3、最大操作温度（max_assembly_temp）。

对操作温度（assembly_temp）字段进行处理：1）常温，替换为 30。2）填写的是温度范围，提取范围里的最大值。比如：15-120，或 15~120，提取的最大操作温度为：120。

4、最小操作温度（min_assembly_temp）。

对操作温度（assembly_temp）字段进行处理：1）常温，替换为 30。2）填写的是温度范围，提取范围里的最小值。比如：-20~-10，或 -20~20，或 -20-20，提取的最小操作温度为：-20。

5、最大操作压力（max_assembly_pressure）。

对操作压力（assembly_pressure）字段进行处理：1）常压，替换为 0。2）填写的是压力范围，提取范围里的最大值。比如：0.1-0.3，或 0.1~0.3，提取的最大操作压力为：0.3。如果压力是带 kPa 单位的，比如 10-15kPa 或 10~15kPa，提取的最大操作压力为：15kPa。

1.2 成品数据表内工艺相关数据填充

1、临时表内的部分字段直接填充到成品数据表。

成品仪表数据表中的字段与数据库表 ks_instrument_snap 中的对应关系汇总：

成品表 >> 管道 / 设备条件下面的字段：

编号：assembly_location

尺寸：assembly_installsize

材质：assembly_material

成品表 >> 操作条件下面的字段：

介质：assembly_substance

温度：assembly_temp

压力：assembly_pressure

3、备注（remarks）

如果功能代码（function）包含字母「Z」，那么备注（remarks）填充：SIL 认证。

1.3 成品数据表内统一规定相关数据修正

备注：根据统一规定的内容修改仪表成品数据表内的部分字段数据，此逻辑放到最后。

仪表选型的通用步骤：匹配仪表类型 => 填充仪表数据表初版数据 => 局部修正仪表数据表部分字段数据 => 根据统一规定内容修正仪表数据表部分字段数据。

1、电气接口尺寸（electrical_size）

如果统一规定里，仪表接口勾选了「M20x1.5」，那么电气接口尺寸（electrical_size）更改为：M20x1.5 (M)。

2、输出信号（mounting_type）

如果统一规定里，仪表接口勾选了「FF 通讯」，那么仪表型号（signal）更改为：FF。

02. 压力表选型逻辑汇总

2.1 原匹配类型逻辑核对并新增差压变送器

核对压力表原来的选型逻辑实现，是不是按照下面的逻辑图做的。

满足下面任意一个条件的，仪表类型匹配为「差压变送器」，后续生成「差压变送器」的成品数据表。

1、功能代码（function）是 PD 或 PZD 开头的。

2、操作压力（assembly_pressure）带有 kPa 单位，且前面的数值小于 15。

备注 1：成品数据表单和各类型仪表参数表单内需要新增的字段：1）低压侧取压口规格（low_pressure_connection）。

备注 2：客户端导出的成品数据表内新增「差压变送器」。@余开毅

2.2 匹配到仪表类型之后部分参数的修正

备注：过程连接规格 = 尺寸 - 压力等级和连接面形式。

压力等级和连接面形式先默认为 16RF，以后会通过其他输入字段来匹配，写逻辑时考虑此扩展性。举例：尺寸为 80 时，过程连接规格为：80-16RF。

01. 所有类型仪表的参数调整

1、测量元件密封液（element_seal_fluid）

如果组分及名称（assembly_substance）内包含字符串「氯气」或「硝酸」或「过氧化氢」，测量元件密封液（element_seal_fluid）修改为「氟碳润滑剂」。

2、测量元件材质（element_material）

如果组分及名称（assembly_substance）内包含字符串「发烟硫酸」或「HF」或「氟化物」，测量元件材质（element_material）修改为「哈氏合金 C」。

如果组分及名称（assembly_substance）内包含字符串「盐水」，测量元件材质（element_material）修改为「钛材」。

02. 隔膜压力表 / 隔膜抗震压力表 / 膜片压力表的参数调整

1、过程连接相关参数的调整

所在管线或设备（pipe_num）是管道，根据管道编号的形式来判断，如上图所示。

步骤一：根据管道编号获取管径。比如上图中的 FN340603-15-2F1，获取管径为 15。

步骤二：如果管径小于 25。1）过程连接规格（process_size）更改为：20-16RF。2）过程连接方式（process_style）更改为：工字型法兰。

03. 不锈钢压力表 / 不锈钢抗震压力表 / 膜盒压力表的参数调整

1、过程连接相关参数的调整

如果所在管线或设备（pipe_num）是管道，根据管道编号的形式来判断。

步骤一：根据管道编号获取管径。比如上图中的 FN340603-10-2F1，获取管径为 10。

步骤二：如果管径小于 15。1）过程连接规格（process_size）更改为：M14x1.5 (M)。2）表头直径（dial_diameter）更改为：60。3）精度（accuracy）更改为：2.5。

如果仪表用途（service）为：消防泵试验压力。那么，1）表头直径（dial_diameter）更改为：150。2）精度（accuracy）更改为 0.4。备注：此修正的优先级比所在位置是管道且管径小于 15 的优先级更高。

04. 压力变送器的参数调整

1、安装方式及精度修正

如果操作压力（assembly_pressure）带有 kPa 单位，且前面的数值小于等于 20，那么：1）安装方式（electrical_size）更改为：引远安装。2）精度（accuracy）更改为：±0.075。

2.3 发现的 Bug 汇总

1、量程的获取逻辑没走。

原逻辑是通过压力数据匹配压力的量程范围，上图中压力 0.3，匹配出来的范围应该是 0~4M。

2、测量元件的材质没有匹配基础库（仪表类型参数表 ks_measure_types）。

03. 温度计选型逻辑汇总

3.1 温度计类型匹配逻辑

就地温度计最终匹配出来的仪表类型汇总：双金属温度计。

集中温度计最终匹配出来的仪表类型汇总：一体化温度变送器、热电阻、热电偶。

1.1 就地温度计类型匹配

如果功能代码（function）是 TG，说明此仪表为就地温度计，仪表名称（name）直接设为：双金属温度计。

1.2 远传温度计类型匹配

如果功能代码（function）不是 TG，说明此仪表为远传温度计，仪表名称（name）直接设为：一体化温度变送器。什么情况下匹配热电偶或热电阻，逻辑后续补充。

3.2 填充仪表数据表初版数据

步骤一：填充工艺相关的数据。根据第一部分的逻辑「01. 所有类型仪表共用逻辑汇总 => 1.2 成品数据表内工艺相关数据填充」。

步骤二：填充数据表内其他的仪表参数。匹配到仪表类型后，根据仪表类型查表 ks_measure_types，获得其他字段填充到仪表数据表内。

3.3 匹配到仪表类型之后部分参数的修正

备注：过程连接规格 = 尺寸 - 压力等级和连接面形式。

压力等级和连接面形式先默认为 16RF，以后会通过其他输入字段来匹配，写逻辑时考虑此扩展性。举例：尺寸为 80 时，过程连接规格为：80-16RF。

01. 双金属温度计的参数调整

1、套管插入深度（well_insert_length）

如果所在管线或设备（pipe_num）是管道，根据管道编号的形式来判断（压力表那边修改部分参数时用到此逻辑）。

步骤一：根据管道编号获取管径。比如上图中的 FN340603-65-2F1，获取管径为 65。

步骤二：如果管径小于等于 200，套管插入深度（well_insert_length）赋值为：l=200，否则赋值为：l=250。

如果所在管线或设备（pipe_num）不是管道。

套管插入深度（well_insert_length）的获取逻辑：如果备注（assembly_comment）不包含字符串「插入深度」直接返回为空。如果包含，那么取紧跟着「插入深度」后的数字，举例，插入深度 600mm，那么取值 600。然后将数字拼接为字符串「l=600」。

2、套管材质（well_material）

如果测量介质为腐蚀性介质，那么修正为：钢衬四氟。符合如下任何一个条件的即为腐蚀性介质：1）备注（assembly_comment）包含字符串「腐蚀」。2）仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

3、套管相关的其他参数

备注（assembly_comment）包含字符串「设备带套管」。

进行如下操作：1）套管型号（well_mode）更改为：设备带套管。2）传感器形式（sensor_style）更改为：卡套 M27x2 (M)。3）套管形式（well_style）、套管材质（well_material）、套管直径（well_diameter）、过程连接方式（process_style）、过程连接材质（process_material）、过程连接规格（process_size），上述字段全部置为空。

02. 一体化温度变送器的参数调整

1、套管插入深度（well_insert_length）

完全参考双金属温度计参数调整的逻辑。

2、套管材质（well_material）

完全参考双金属温度计参数调整的逻辑。

3、套管相关的其他参数

完全参考双金属温度计参数调整的逻辑。

4、分度号（mark_graduation）

如果操作温度（assembly_temp）大于 600，或者仪表用途（service）包含字符串「泵出口」、「风机出口」。那么：分度号（mark_graduation）更改为：K。

04. 液位计选型逻辑汇总

4.1 液位计类型匹配逻辑

就地液位计最终匹配出来的仪表类型汇总：磁性液位计、玻璃板液位计。

集中液位计最终匹配出来的仪表类型汇总：液位开关、差压变送器、雷达液位计、伺服液位计、超声波液位计、电浮筒液位计、磁致伸缩液位计。

备注：液位范围，是公用逻辑中处理后得到的字段。

1.1 就地液位计类型匹配

如果功能代码（function）是 LG，说明此仪表为就地液位计。

仪表名称（name）默认设为：磁性液位计。

如果同时满足下面 2 个条件的话，更改为：玻璃板液位计。1）如果备注（assembly_comment）包含字符串「玻璃板」。2）液位范围小于等于 2000。

1.2 集中液位计类型匹配

如果功能代码（function）不是 LG，说明此仪表为远传液位计。

首先看功能代码（function）里是否含有字符串「I」，如果包含，那么仪表名称（name）默认设为：磁性液位计。否则，仪表名称（name）设为：液位开关。

满足下面任何一个条件的，仪表名称（name）更改为：差压变送器。

条件 1：备注（assembly_comment）包含字符串「压差液位计」或「差压液位计」。

条件 2：最大操作温度大于 250。

条件 3：功能代码（function）中包含字符串「C」且液位范围大于 1000 小于 10000。

条件 4：备注（assembly_comment）包含字符串「高粘度」、「易结晶」。

条件 5：备注（assembly_comment）包含字符串「易结冻」且设备高度小于等于 4500。

条件 6：设备高度大于 4500 且小于等于 10000。

满足下面任何一个条件的，仪表名称（name）更改为：雷达液位计。

条件 1：备注（assembly_comment）包含字符串「雷达」或「顶插」。

条件 2：测量控制点名称（assembly_name）包含字符串「水池液位」、「计量罐」、「反应釜液位」。

条件 3：设备高度大于 10000。

满足下面任何一个条件的，仪表名称（name）更改为：电浮筒液位计。

条件 1：备注（assembly_comment）包含字符串「电浮筒液位计」。

条件 2：设备高度小于 1000。

条件 3：备注（assembly_comment）包含字符串「易汽化」或「宜汽化」。

满足下面任何一个条件的，仪表名称（name）更改为：磁致伸缩液位计。

条件 1：备注（assembly_comment）包含字符串「磁致伸缩」。

条件 2：功能代码（function）中包含字符串「C」且液位范围小于等于 1000。

逻辑修正（2023-08-14）：@常恃豪

磁致伸缩液位计也是一种磁性液位计。修改的地方 2 处：1）上面仪表名称（name）更改为：磁性液位计。2）该液位计的参数调整那边，备注（remarks）更改为：磁致伸缩。

4.2 填充仪表数据表初版数据

步骤一：填充工艺相关的数据。根据第一部分的逻辑「01. 所有类型仪表共用逻辑汇总 => 1.2 成品数据表内工艺相关数据填充」。

步骤二：填充数据表内其他的仪表参数。匹配到仪表类型后，根据仪表类型查表 ks_measure_types，获得其他字段填充到仪表数据表内。

4.3 匹配到仪表类型之后部分参数的修正

备注：过程连接规格 = 尺寸 - 压力等级和连接面形式。

压力等级和连接面形式先默认为 16RF，以后会通过其他输入字段来匹配，写逻辑时考虑此扩展性。举例：尺寸为 80 时，过程连接规格为：80-16RF。

01. 磁性液位计的参数调整

1、过程连接规格（process_size）

如果测量范围大于 3000，那么更改为：80-16RF。

2、指示器触液材质（level_guage_material）

如果测量介质为腐蚀性介质，那么更改为：钢衬四氟。

符合如下任何一个条件的即为腐蚀性介质：1）备注（assembly_comment）包含字符串「腐蚀」。2）仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

02. 液位开关的参数调整

1、探头材质（probe_material）

如果测量介质为腐蚀性介质，那么更改为：钢衬四氟。

符合如下任何一个条件的即为腐蚀性介质：1）备注（assembly_comment）包含字符串「腐蚀」。2）仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

03. 雷达液位计的参数调整

1、过程连接规格（process_size）

如果操作压力（assembly_pressure）为：常压，那么更改为：100-16RF。

2、指示器触液材质（level_guage_material）

如果测量介质为腐蚀性介质，那么更改为：PTFE。

符合如下任何一个条件的即为腐蚀性介质：1）备注（assembly_comment）包含字符串「腐蚀」。2）仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

04. 差压变送器的参数调整

1、安装方式（mounting_type）

更改为：

毛细管：LP:3mxHP:1m

2、附件（accessories）

更改为：配不锈钢支架。

05. 开关阀选型逻辑汇总

5.1 阀门类型匹配逻辑

最终匹配出来的阀门类型汇总：开关阀、电磁阀。

仪表名称（name）默认设为：开关阀。测量控制点名称（assembly_name）包含字符串「压缩空气开关阀」或「压缩空气管道开关阀」，那么仪表名称（name）更改为：电磁阀。

5.2 填充仪表数据表初版数据

步骤一：填充工艺相关的数据。根据第一部分的逻辑「01. 所有类型仪表共用逻辑汇总 => 1.2 成品数据表内工艺相关数据填充」。

步骤二：填充数据表内其他的仪表参数。匹配到仪表类型后，根据仪表类型查表 ks_measure_types，获得其他字段填充到仪表数据表内。

5.3 匹配到仪表类型之后部分参数的修正

备注：过程连接规格 = 尺寸 - 压力等级和连接面形式。

压力等级和连接面形式先默认为 16RF，以后会通过其他输入字段来匹配，写逻辑时考虑此扩展性。举例：尺寸为 80 时，过程连接规格为：80-16RF。

01. 开关阀的参数调整

1、过程连接规格（process_size）

开关阀所在管线或设备（pipe_num）肯定是管道，根据管道编号获取管径。比如上图中的 FN340603-65-2F1，获取管径为 65。那么过程连接规格更改为：65-16RF。

2、阀芯阀座材质（valve_seat_material）

最大操作温度（max_assembly_temp）大于 100 且小于等于 180，那么更改为：304/RPTFE。

3、阀体填料材质（valve_seal_material）

满足下面任意一个条件的话，那么更改为：柔性石墨。

1）最大操作温度（max_assembly_temp）大于 200。

2）最小操作温度（min_assembly_temp）小于 - 35。

3）组分及名称（assembly_substance）内包含字符串「蒸汽」或「导热油」。

4）管道等级号的首个数字大于等于 4。管道等级号的获取逻辑：开关阀所在管线或设备（pipe_num）肯定是管道，根据管道编号结合工艺专业那边的自定义管道编号形式，获取管道等级号。比如管道号 FN340603-65-4J1，管道等级号为 4J1，管道等级号的首个数字为 4。

4、阀门失能位置（valverequestment）

直接取临时表里的阀门失能位置（valverequestment）。

5、阀体形式（valve_type）

逻辑待补充。如果 XXXX，那么更改为：双偏心蝶阀。

6、执行机构关闭时间（cylinder_close_time）

需查表，逻辑待补充。详见二次迭代的需求文档：20230112 仪表选型模块二次迭代汇总

7、电磁阀工作电压（solenoid_operate_voltage）2023-03-01 补充

如果功能代码（function）包含字母「Z」，那么修改为：24VDC (3.7W), 耐高温（H 级）绝缘线圈。

如果阀门失能位置（valverequestment）为：FL，那么修改为：二位五通 / 单电控 / 电开。

06. 调节阀选型逻辑汇总

6.1 阀门类型匹配逻辑

仪表名称（name）默认设为：调节阀。

6.2 填充仪表数据表初版数据

步骤一：填充工艺相关的数据。根据第一部分的逻辑「01. 所有类型仪表共用逻辑汇总 => 1.2 成品数据表内工艺相关数据填充」。

步骤二：填充数据表内其他的仪表参数。匹配到仪表类型后，根据仪表类型查表 ks_measure_types，获得其他字段填充到仪表数据表内。

6.3 匹配到仪表类型之后部分参数的修正

1、过程连接规格（process_size）

等同开关阀那边的逻辑。

2、阀体形式（valve_type）

备注：以下条件逻辑的优先级依次增高。

条件逻辑 1：符合下面任何一个条件的，那么更改为：波纹管密封单座。

1、仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

2、组分及名称（assembly_substance）内包含字符串「HF」或「氟化氢」。

3、组分及名称（assembly_substance）内包含字符串「NH3」或「氨气」或「H2S」或「硫化氢」或「导热油」。

4、操作压力（assembly_pressure）有值，且小于 0.1。

条件逻辑 2：所在管道为夹套管，那么更改为：偏心旋转阀。夹套管的获取逻辑：所在管道的编号形式与工艺专业的自定义管道编号里夹套管的编号形式相同。

3、阀体波纹管材质（valve_bellow_material）

备注 1：以下 if 条件逻辑的优先级依次增高。备注 2：此字段，默认为空，只有在阀体形式（valve_type）字段更改为「波纹管密封单座」才会走下面的逻辑赋值。

1、仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。此字段更改为：PTFE。

2、组分及名称（assembly_substance）内包含字符串「HF」或「氟化氢」。此字段更改为：S31603。

3、组分及名称（assembly_substance）内包含字符串「NH3」或「氨气」或「H2S」或「硫化氢」或「导热油」。此字段更改为：S30408。

4、阀体材质（valve_material）

备注：以下 if 条件逻辑的优先级依次增高。

1、仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。此字段更改为：WCB+F46。

2、组分及名称（assembly_substance）内包含字符串「HF」或「氟化氢」。此字段更改为：S31603。

5、阀芯阀座材质（valve_seat_material）

备注：以下 if 条件逻辑的优先级依次增高。

1、仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。此字段更改为：304+F46。

2、组分及名称（assembly_substance）内包含字符串「HF」或「氟化氢」。此字段更改为：S31603。

3、组分及名称（assembly_substance）内包含字符串「蒸汽」。此字段更改为：S304+ST。

4、阀前阀后压差大于 1.5。此字段更改为：S304+ST。阀前阀后压差的获取逻辑：仪表临时表里，valve_before_press 字段和 valve_after_press 字段的差值。

6、阀体填料材质（valve_seal_material）

满足下面任意一个条件的话，那么更改为：柔性石墨。

1）最大操作温度（max_assembly_temp）大于 200。

2）最小操作温度（min_assembly_temp）小于 - 35。

3）组分及名称（assembly_substance）内包含字符串「蒸汽」或「导热油」。

4）管道等级号的首个数字大于等于 4。管道等级号的获取逻辑：开关阀所在管线或设备（pipe_num）肯定是管道，根据管道编号结合工艺专业那边的自定义管道编号形式，获取管道等级号。比如管道号 FN340603-65-4J1，管道等级号为 4J1，管道等级号的首个数字为 4。

7、备注（remarks）

备注：以下 if 条件逻辑的优先级依次增高。

1、最小操作温度（min_assembly_temp）小于 -20。1）如果此字段为空值。此字段更改为：低温型。1）如果此字段有值，比如为：SIL 认证。那么此字段需要在原值后面拼接字符串「；低温型」，更改为：「SIL 认证；低温型」。

2、最大操作温度（max_assembly_temp）大于 220。1）如果此字段为空值。此字段更改为：高温型。1）如果此字段有值，比如为：SIL 认证。那么此字段需要在原值后面拼接字符串「；高温型」，更改为：「SIL 认证；高温型」。

备注：因为在前面的逻辑「01. 所有类型仪表共用逻辑汇总 > 1.2 成品数据表内工艺相关数据填充」会对备注字段进行处理，如果功能代码（function）包含字母「Z」，那么备注（remarks）填充：SIL 认证。所以备注字段此时可能有值，有值的话不能被覆盖掉，所以有值和空值的情况分开考虑。

07. 流量计选型逻辑汇总

7.1 流量计类型匹配逻辑

就地流量计最终匹配出来的仪表类型汇总：转子流量计、水表。

集中流量计最终匹配出来的仪表类型汇总：电磁流量计、转子流量计、质量流量计、涡街流量计、旋涡流量计、容积式流量计、差压流量计、超声波流量计。

1.1 就地流量计类型匹配

仪表类型（instrument_type）为：flow，且仪表类别（data_class）为：location，那么此仪表为就地流量计。

仪表名称（name）默认设为：转子流量计。

如果功能代码（function）为：FQ，那么更改为：水表。

1.2 集中流量计类型匹配

除就地流量计以外的流量计均为远传量计。

那么仪表名称（name）默认设为：电磁流量计。

满足下面任何一个条件的，仪表名称（name）更改为：质量流量计。

条件 1：备注（assembly_comment）包含字符串「质量流量计」。

条件 2：测量控制点名称（assembly_name）包含字符串「罐区流量计」。

条件 3：组分及名称（assembly_substance）内包含字符串「氢气」或「一氧化碳」。

满足下面任何一个条件的，仪表名称（name）更改为：涡街流量计。

条件 1：备注（assembly_comment）包含字符串「涡街流量计」。

条件 2：组分及名称（assembly_substance）内包含字符串「天然气」。

条件 3：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 250。3）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值大于等于 20，且工作压力（pressure）的值大于 0.1。

条件 4：1）组分及名称（assembly_substance）内包含字符串「蒸汽」2）同时，所在管道的管径小于等于 250。

条件 5：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 250。3）同时，状态（assembly_phase）为字符串「液态」或「液相」或「L」；4）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值大于等于 1，且工作压力（pressure）的值大于 0.1。5）同时，介质不导电。不导电的逻辑取反导电逻辑。介质导电的判断逻辑（电磁流量计有用到）：组分及名称（assembly_substance）内包含字符串「循环水」、「冷却水」、「自来水」。（2023-06-05）@常恃豪

满足下面任何一个条件的，仪表名称（name）更改为：差压式流量计。

条件 1：备注（assembly_comment）包含字符串「差压式流量计」。

条件 2：1）组分及名称（assembly_substance）内包含字符串「蒸汽」。2）同时，所在管道的管径大于 250。

满足下面任何一个条件的，仪表名称（name）更改为：容积式流量计。

条件 1：备注（assembly_comment）包含字符串「容积式流量计」。

条件 2：备注（assembly_comment）包含字符串「高粘度」同时量程比小于等于 10。量程比的获取逻辑：差压 / 流量 / 物（界）位 / 分析 / 重量 - 最大（max）和差压 / 流量 / 物（界）位 / 分析 / 重量 - 最小（min），这两个字段的比值。如果 max 和 min 这两个字段，有一个为空值，那么就不走此逻辑了。

满足下面任何一个条件的，仪表名称（name）更改为：超声波流量计。

条件 1：备注（assembly_comment）包含字符串「超声波流量计」。

条件 2：1）备注（assembly_comment）包含字符串「高粘度」。2）同时，量程比大于 10。量程比的获取逻辑：差压 / 流量 / 物（界）位 / 分析 / 重量 - 最大（max）和差压 / 流量 / 物（界）位 / 分析 / 重量 - 最小（min），这两个字段的比值。如果 max 和 min 这两个字段，有一个为空值，那么就不走此逻辑了。

条件 3：1）所在管道为非金属管道或耐腐蚀金属。2）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，量程比大于 10。

所在管道为非金属管道或耐腐蚀金属判断逻辑：仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯、哈氏合金、钛。

条件 4：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径大于等于 800。备注：管径信息的获取逻辑很多地方用到，参考前面的逻辑。

所在管道为碳钢 / 不锈钢的判断逻辑：仪表临时表中，材质（assembly_material）为下面任意一个的：20、S30408、S31603、碳钢、不锈钢。

满足下面任何一个条件的，仪表名称（name）更改为：转子流量计。

条件 1：备注（assembly_comment）包含字符串「转子流量计」。

条件 2：1）所在管道为非金属管道或耐腐蚀金属；2）同时，状态（assembly_phase）为字符串「液态」或「液相」或「L」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 1。

条件 3：1）所在管道为非金属管道或耐腐蚀金属；2）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，量程比小于 10。

条件 4：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 100。3）同时，状态（assembly_phase）为字符串「液态」或「液相」或「L」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 1 或者工作压力（pressure）的值小于 0.1。

条件 5：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 100。3）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 20，且工作压力（pressure）带有单位 kPa，值大于 10。

满足下面任何一个条件的，仪表名称（name）更改为：电磁流量计。

条件 1：备注（assembly_comment）包含字符串「电磁流量计」。

条件 2：所测量的介质导电。介质导电的判断逻辑：组分及名称（assembly_substance）内包含字符串「循环水」、「冷却水」、「自来水」。

条件 3：1）所在管道为非金属管道或耐腐蚀金属；2）同时，状态（assembly_phase）为字符串「液态」或「液相」或「L」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值大于等于 1；4）同时工作压力（pressure）的值大于 0.1。

7.2 填充仪表数据表初版数据

步骤一：填充工艺相关的数据。根据第一部分的逻辑「01. 所有类型仪表共用逻辑汇总 => 1.2 成品数据表内工艺相关数据填充」。

步骤二：填充数据表内其他的仪表参数。匹配到仪表类型后，根据仪表类型查表 ks_measure_types，获得其他字段填充到仪表数据表内。

7.3 匹配到仪表类型之后部分参数的修正

01. 质量流量计的参数调整

1、精度（accuracy）

如果组分及名称（assembly_substance）内包含字符串「氢气」或「一氧化碳」，那么更改为：1。

2、测量元件材质（element_material）

所在管道为非金属管道或耐腐蚀金属，那么更改为：哈氏合金 C。

02. 涡街流量计的参数调整

1、精度（accuracy）

如果组分及名称（assembly_substance）内包含字符串「天然气」，那么更改为：0.5% of reading。

2、备注（remarks）

备注：以下条件逻辑的优先级依次增高。

符合条件逻辑 1，那么更改为：一体化压力补偿。

条件逻辑 1：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 250。3）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值大于等于 20，且工作压力（pressure）的值大于 0.1。

符合条件逻辑 2，那么更改为：一体化温度压力补偿。

条件逻辑 2：1）组分及名称（assembly_substance）内包含字符串「蒸汽」2）同时，所在管道的管径小于等于 250。

3、过程连接规格（process_size）

根据所在管道编号获取管径，再缩小一档。比如 FN340603-65-2F1，获取管径为 65，缩小一档为 50。那么过程连接规格更改为：50-16RF。

备注：管径缩档的逻辑详见发酵模块那边匹配管径时写的逻辑。

03. 电磁流量计的参数调整

1、过程连接规格（process_size）

根据所在管道编号获取管径。比如 FN340603-65-2F1，获取管径为 65。那么过程连接规格更改为：65-16RF。

2、电极材质（flow_electrode_material）、接地环材质（flow_ground_ring_material）

备注：以下条件逻辑只要匹配到一个直接跳出。

符合条件逻辑 1 或条件逻辑 2，那么电极材质（flow_electrode_material）、接地环材质（flow_ground_ring_material）更改为：哈氏合金 C。

条件逻辑 1：所在管道为非金属材质。

管道为非金属材质的判断逻辑：仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

条件逻辑 2：1）所在管道为碳钢 / 不锈钢。2）同时，组分及名称（assembly_substance）内包含字符串「浓硫酸」。

符合条件逻辑 1，那么电极材质（flow_electrode_material）、接地环材质（flow_ground_ring_material）更改为：哈氏合金 C。

条件逻辑 1：所在管道为非金属材质。

管道为非金属材质的判断逻辑：仪表临时表中，材质（assembly_material）为下面任意一个的：钢衬四氟、搪玻璃、玻璃钢、聚丙烯、增强聚丙烯、聚乙烯、钢衬聚乙烯。

符合条件逻辑 2，那么电极材质（flow_electrode_material）更改为：铂铱合金，接地环材质（flow_ground_ring_material）更改为：虚拟接地。

条件逻辑 2：1）所在管道为碳钢 / 不锈钢。2）同时，组分及名称（assembly_substance）内包含字符串「浓硫酸」或者「发烟硫酸」。

符合条件逻辑 3，那么电极材质（flow_electrode_material）、接地环材质（flow_ground_ring_material）更改为：Ta。

条件逻辑 3：1）所在管道为碳钢 / 不锈钢。2）同时，组分及名称（assembly_substance）内包含字符串「浓硝酸」。

符合条件逻辑 4，那么电极材质（flow_electrode_material）更改为：哈氏合金 C。接地环材质（flow_ground_ring_material）更改为：N/A。

条件逻辑 4：1）所在管道为碳钢 / 不锈钢。2）同时，组分及名称（assembly_substance）内包含字符串「Cl-」、「NaCl」、「氯离子」、「氯化钠」。

04. 转子流量计的参数调整

1、附件（accessories）

备注：以下条件逻辑的优先级依次增高。

符合条件逻辑 1，那么更改为：气阻尼。

条件逻辑 1：1）所在管道为碳钢 / 不锈钢。2）同时，所在管道的管径小于 800。3）同时，状态（assembly_phase）为字符串「气态」或「气相」或「G」；3）同时，差压 / 流量 / 物（界）位 / 分析 / 重量 - 正常（nomal）字段的值小于 20，且工作压力（pressure）带有单位 kPa，值大于 10。

05. 差压式流量计的参数调整

1、备注（remarks）

备注：以下条件逻辑的优先级依次增高。

符合条件逻辑 1，那么更改为：一体化温度压力补偿。

条件逻辑 1：1）组分及名称（assembly_substance）内包含字符串「蒸汽」。2）同时，所在管道的管径大于 250。